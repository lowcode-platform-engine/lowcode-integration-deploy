import{a as o,n as u}from"./index-D2t72-yQ.js";import{R as E,S as A,a as J,b as R,N as B,c as T,d as w,M as z,B as L,C as M,D as X,T as W,g as q,A as G,e as H,O as Q,i as U}from"./index-Ca2soC8S.js";import{i as Y}from"./index.browser-DChRJmk7.js";import{F as N,e as Z,f as $,h as C}from"./index-CJyGQGl4.js";const K={SetterForm:J,StringSetter:R,NumberSetter:B,RadioSetter:T,SingleSelectSetter:w,MultipleSelectSetter:z,BooleanSetter:L,ColorSetter:M,DateSetter:X,TimeSetter:W,DateTimeSetter:q,ArraySetter:G,ArrayObjectSetter:H,ObjectSetter:Q},me=()=>{const[v,ee]=o.useState(!0),[m]=N.useForm(),{run:x}=Z(t=>{console.log("form values",t)},{wait:100});N.useWatch(t=>{x(t)},{form:m,preserve:!0});const[p,te]=o.useState("123"),[S,ae]=o.useState({titleConfig:{text:"标题",fontSize:"40",fontColor:"#000"},subTitleConfig:{text:"标题",fontSize:"16",fontColor:"#959ba6"},columns:"4",list:[{title:"标题",description:"标题",fontSize:"16",fontColor:"#000",width:"325",icon:"https://tianshu.alicdn.com/9652b6f7-8bc9-4527-9854-06c59f2b0bc8.png"}],onClick:"function(){}"}),[P,I]=o.useState({}),c=o.useRef(),d=o.useRef(),b=o.useMemo(()=>{const t=$({componentName:"Component",fileName:"test",props:{},children:[{componentName:"SetterForm",props:{formProps:{form:m,layout:"vertical"},initialValues:S,onValuesChange:(e,r)=>{I(r)},onFieldsChange:(e,r)=>{}},children:[{componentName:"ObjectSetter",props:{description:"标题内容格式配置",formItemProps:{label:"标题",name:"titleConfig"},items:[{componentName:"StringSetter",props:{maxLength:"24",formItemProps:{label:"标题",name:"text"},setter:"StringSetter"}},{componentName:"NumberSetter",props:{min:"12",max:"56",formItemProps:{label:"字体大小",name:"fontSize"},setter:"NumberSetter"}},{componentName:"ColorSetter",props:{formItemProps:{label:"字体颜色",name:"fontColor"},setter:"ColorSetter"}}],setter:"ObjectSetter"},id:"TxsRk6kyF9xXQ0jb79m_e",key:"TxsRk6kyF9xXQ0jb79m_e"},{componentName:"ObjectSetter",props:{description:"副标题内容格式配置",formItemProps:{label:"标题配置",name:"subTitleConfig"},items:[{componentName:"StringSetter",props:{maxLength:"24",formItemProps:{label:"标题",name:"text"},setter:"StringSetter"}},{componentName:"NumberSetter",props:{min:"12",max:"56",formItemProps:{label:"字体大小",name:"fontSize"},setter:"NumberSetter"}},{componentName:"ColorSetter",props:{formItemProps:{label:"字体颜色",name:"fontColor"},setter:"ColorSetter"}}],setter:"ObjectSetter"},id:"n1R8N5sDuviEDjxLzJyUn",key:"n1R8N5sDuviEDjxLzJyUn"},{componentName:"NumberSetter",props:{min:"3",max:"6",formItemProps:{label:"每行个数",name:"columns"},setter:"NumberSetter"},id:"POctoc6kTItdAjPonl1eu",key:"POctoc6kTItdAjPonl1eu"},{componentName:"ArrayObjectSetter",props:{minItems:"1",maxItems:"4",formItemProps:{label:"内容配置",name:"list"},item:{componentName:"ObjectSetter",props:{formItemProps:{name:"list.{{$i}}"},items:[{componentName:"StringSetter",props:{maxLength:"10",formItemProps:{label:"标题",name:"title"},setter:"StringSetter"}},{componentName:"StringSetter",props:{maxLength:"60",formItemProps:{label:"描述",name:"description"},setter:"StringSetter"}},{componentName:"NumberSetter",props:{min:"12",max:"24",formItemProps:{label:"标题字体大小",name:"fontSize"},setter:"NumberSetter"}},{componentName:"ColorSetter",props:{formItemProps:{label:"标题字体颜色",name:"fontColor"},setter:"ColorSetter"}},{componentName:"NumberSetter",props:{min:"300",max:"600",formItemProps:{label:"宽度",name:"width"},setter:"NumberSetter"}},{componentName:"ImageSetter",props:{action:"/file-server/v1.0/upload",formItemProps:{label:"主题图片",name:"icon"},setter:"ImageSetter"}}],setter:"ObjectSetter"}},setter:"ArrayObjectSetter"},id:"Jc5d8cD_MffyBN3GNBfJV",key:"Jc5d8cD_MffyBN3GNBfJV"},{componentName:"EventSetter",props:{formItemProps:{label:"点击函数",name:"onClick"},setter:"EventSetter"},id:"jj3sHXoDZqa7oNWm82Y_t",key:"jj3sHXoDZqa7oNWm82Y_t"}]}]});return console.log("schema",t),t},[p,S]),n=o.useRef(),j=(t,e,r)=>{var l,g,h;const i=m.getFieldsValue();console.log(t,i),c.current=r,d.current=e;const{type:s,value:a}=e||{};if(s&&a){if(a==="JSExpression")return void((l=n==null?void 0:n.current)==null?void 0:l.open(s,a));(g=n==null?void 0:n.current)==null||g.open(s,a)}else(h=n==null?void 0:n.current)==null||h.open("JSExpression","")},f=(t,e,r)=>{const{key:i,...s}=e,a=!!(e!=null&&e.formProps&&!(e!=null&&e.formItemProps));return e.__createElement=f,u.jsx(U,{...s,form:m,isFormContainer:a,initialValues:S,onBind:j,children:u.jsx(t,{...s,__createElement:f,form:m,children:r})})},y=o.useMemo(()=>({schema:b,components:K,customCreateElement:f,designMode:"live"}),[b,p]),V=o.useMemo(()=>u.jsx(E,{...y}),[p]),F=o.useMemo(()=>u.jsx("div",{style:{},children:V}),[p]),k=async t=>t==="JSExpression"?[{name:"name",value:"this.state.name",sourceCode:"this.state.name",path:"this.state.name",children:[]},{name:"age",value:"this.state.age",sourceCode:"this.state.age",path:"this.state.age",children:[]},{name:"age1",value:"this.state.age1",sourceCode:"this.state.age1",path:"this.state.age1",children:[]},{name:"age2",value:"this.state.age2",sourceCode:"this.state.age2",path:"this.state.age2",children:[]},{name:"age3",value:"this.state.age3",sourceCode:"this.state.age3",path:"this.state.age3",children:[]},{name:"age4",value:"this.state.age4",sourceCode:"this.state.age4",path:"this.state.age4",children:[]},{name:"age35",value:"this.state.age5",sourceCode:"this.state.age5",path:"this.state.age5",children:[]},{name:"age6",value:"this.state.age6",sourceCode:"this.state.age6",path:"this.state.age6",children:[]},{name:"age355",value:"this.state.age55",sourceCode:"this.state.age55",path:"this.state.age55",children:[]},{name:"age63",value:"this.state.age63",sourceCode:"this.state.age63",path:"this.state.age63",children:[]},{name:"age3553",value:"this.state.age553",sourceCode:"this.state.age553",path:"this.state.age553",children:[]},{name:"age633",value:"this.state.age634",sourceCode:"this.state.age634",path:"this.state.age634",children:[]},{name:"age35533",value:"this.state.age5353",sourceCode:"this.state.age5353",path:"this.state.age5353",children:[]},{name:"age6633",value:"this.state.a6ge634",sourceCode:"this.state.a6ge634",path:"this.state.a6ge634",children:[]}]:t==="JSFunction"?[{name:"getName",value:"getName()",sourceCode:"getName()",path:"getName()",children:[]},{name:"getAge",value:"getAge()",sourceCode:"getAge()",path:"getAge()",children:[]}]:[],O=(t,e)=>new Promise(r=>{var a,l;const i=e.value,s=(l=(a=c==null?void 0:c.current)==null?void 0:a.formItemProps)==null?void 0:l.name;if(s&&i){const g=m.getFieldsValue(),h=C(g,s),D={type:t,value:i,mock:h||d.current};m.setFieldValue(s,D)}r(!0)}),_=()=>new Promise(t=>{var r,i;const e=(i=(r=c==null?void 0:c.current)==null?void 0:r.formItemProps)==null?void 0:i.name;if(e){const a=C(P,e)||d.current,l=Y(a)?a.mock:a;m.setFieldValue(e,l)}t(!0)});return v?u.jsxs("div",{style:{width:400,padding:24,borderRight:"1px solid #eceef2"},children:[F,u.jsx(A,{title:"绑定",ref:n,getVariableList:k,onBoundSuccess:O,onBoundRemove:_})]}):null};export{me as RenderPage,me as default};

var li=Object.defineProperty;var ui=(e,t,n)=>t in e?li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var B=(e,t,n)=>ui(e,typeof t!="symbol"?t+"":t,n);import{g as di,r as fi,u as Jo,a as d,C as hi,c as Y,b as mi,d as vi,e as _i,_ as yo,f as gi,h as pi,i as yi,j as xi,k as Ci,l as Kn,D as bi,m as xo,n as a,S as an,R as Xe,o as wi,p as Si,q as Co,s as Ei}from"./index-D2t72-yQ.js";import{r as bo,S as ji,e as D,c as Pi,j as ki,f as Lt,a as gt,b as Ko,d as Ni,g as wo,h as Ti,D as Qo}from"./DecorateContextV3-CphvitVs.js";import{p as Di,R as zi,a as Mi,b as Oi,c as Li,d as Ri,I as Qn,u as er,_ as eo,i as Fi,T as De,s as U,M as Ie,F as pe,e as Ii,f as Ke,E as We,g as So,h as $i,j as Ai,k as Fe,S as tr,l as It,m as to,n as Bi,o as tt,C as nr,q as or,D as no,r as Dn,t as zn,v as Mn,w as Vi,B as Oe,P as Gi,x as Yi,y as Hi}from"./index-CJyGQGl4.js";import{g as cn,m as Xi,c as Wi,a as Ui,R as qi,t as xt,n as oo,L as Zi}from"./index.browser-DChRJmk7.js";import{R as Ji,r as Ki}from"./index-BNbIbgjI.js";import{i as Qi,u as Ct,s as es,D as ro,L as rr,a as ts,b as ns,c as Rt,T as os,g as ir,F as On,P as rs}from"./storage-C2-tuK8u.js";import{R as sr,S as ar,a as cr,b as lr,N as ur,c as dr,d as fr,M as hr,B as mr,C as vr,D as _r,T as gr,A as pr,e as yr,O as xr,f as Cr,E as br,g as wr,h as Sr,I as Er,F as jr,i as Pr,j as Eo,k as kr}from"./index-Ca2soC8S.js";const qt=(e,t,n,o,r)=>({background:e,border:`${Jo(o.lineWidth)} ${o.lineType} ${t}`,[`${r}-icon`]:{color:n}}),is=e=>{const{componentCls:t,motionDurationSlow:n,marginXS:o,marginSM:r,fontSize:i,fontSizeLG:s,lineHeight:c,borderRadiusLG:l,motionEaseInOutCirc:u,withDescriptionIconSize:f,colorText:m,colorTextHeading:h,withDescriptionPadding:v,defaultPadding:_}=e;return{[t]:Object.assign(Object.assign({},fi(e)),{position:"relative",display:"flex",alignItems:"center",padding:_,wordWrap:"break-word",borderRadius:l,[`&${t}-rtl`]:{direction:"rtl"},[`${t}-content`]:{flex:1,minWidth:0},[`${t}-icon`]:{marginInlineEnd:o,lineHeight:0},"&-description":{display:"none",fontSize:i,lineHeight:c},"&-message":{color:h},[`&${t}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${n} ${u}, opacity ${n} ${u},
        padding-top ${n} ${u}, padding-bottom ${n} ${u},
        margin-bottom ${n} ${u}`},[`&${t}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${t}-with-description`]:{alignItems:"flex-start",padding:v,[`${t}-icon`]:{marginInlineEnd:r,fontSize:f,lineHeight:0},[`${t}-message`]:{display:"block",marginBottom:o,color:h,fontSize:s},[`${t}-description`]:{display:"block",color:m}},[`${t}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},ss=e=>{const{componentCls:t,colorSuccess:n,colorSuccessBorder:o,colorSuccessBg:r,colorWarning:i,colorWarningBorder:s,colorWarningBg:c,colorError:l,colorErrorBorder:u,colorErrorBg:f,colorInfo:m,colorInfoBorder:h,colorInfoBg:v}=e;return{[t]:{"&-success":qt(r,o,n,e,t),"&-info":qt(v,h,m,e,t),"&-warning":qt(c,s,i,e,t),"&-error":Object.assign(Object.assign({},qt(f,u,l,e,t)),{[`${t}-description > pre`]:{margin:0,padding:0}})}}},as=e=>{const{componentCls:t,iconCls:n,motionDurationMid:o,marginXS:r,fontSizeIcon:i,colorIcon:s,colorIconHover:c}=e;return{[t]:{"&-action":{marginInlineStart:r},[`${t}-close-icon`]:{marginInlineStart:r,padding:0,overflow:"hidden",fontSize:i,lineHeight:Jo(i),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${n}-close`]:{color:s,transition:`color ${o}`,"&:hover":{color:c}}},"&-close-text":{color:s,transition:`color ${o}`,"&:hover":{color:c}}}}},cs=e=>({withDescriptionIconSize:e.fontSizeHeading3,defaultPadding:`${e.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`}),ls=di("Alert",e=>[is(e),ss(e),as(e)],cs);var jo=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n};const us={success:Mi,info:Oi,error:Li,warning:Ri},ds=e=>{const{icon:t,prefixCls:n,type:o}=e,r=us[o]||null;return t?_i(t,d.createElement("span",{className:`${n}-icon`},t),()=>({className:Y(`${n}-icon`,{[t.props.className]:t.props.className})})):d.createElement(r,{className:`${n}-icon`})},fs=e=>{const{isClosable:t,prefixCls:n,closeIcon:o,handleClose:r,ariaProps:i}=e,s=o===!0||o===void 0?d.createElement(zi,null):o;return t?d.createElement("button",Object.assign({type:"button",onClick:r,className:`${n}-close-icon`,tabIndex:0},i),s):null},Nr=d.forwardRef((e,t)=>{const{description:n,prefixCls:o,message:r,banner:i,className:s,rootClassName:c,style:l,onMouseEnter:u,onMouseLeave:f,onClick:m,afterClose:h,showIcon:v,closable:_,closeText:x,closeIcon:g,action:y,id:k}=e,C=jo(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action","id"]),[N,j]=d.useState(!1),P=d.useRef(null);d.useImperativeHandle(t,()=>({nativeElement:P.current}));const{getPrefixCls:p,direction:b,alert:S}=d.useContext(hi),E=p("alert",o),[H,M,W]=ls(E),ee=A=>{var J;j(!0),(J=e.onClose)===null||J===void 0||J.call(e,A)},te=d.useMemo(()=>e.type!==void 0?e.type:i?"warning":"info",[e.type,i]),F=d.useMemo(()=>typeof _=="object"&&_.closeIcon||x?!0:typeof _=="boolean"?_:g!==!1&&g!==null&&g!==void 0?!0:!!(S!=null&&S.closable),[x,g,_,S==null?void 0:S.closable]),$=i&&v===void 0?!0:v,L=Y(E,`${E}-${te}`,{[`${E}-with-description`]:!!n,[`${E}-no-icon`]:!$,[`${E}-banner`]:!!i,[`${E}-rtl`]:b==="rtl"},S==null?void 0:S.className,s,c,W,M),X=Di(C,{aria:!0,data:!0}),T=d.useMemo(()=>{var A,J;return typeof _=="object"&&_.closeIcon?_.closeIcon:x||(g!==void 0?g:typeof(S==null?void 0:S.closable)=="object"&&(!((A=S==null?void 0:S.closable)===null||A===void 0)&&A.closeIcon)?(J=S==null?void 0:S.closable)===null||J===void 0?void 0:J.closeIcon:S==null?void 0:S.closeIcon)},[g,_,x,S==null?void 0:S.closeIcon]),V=d.useMemo(()=>{const A=_??(S==null?void 0:S.closable);return typeof A=="object"?jo(A,["closeIcon"]):{}},[_,S==null?void 0:S.closable]);return H(d.createElement(mi,{visible:!N,motionName:`${E}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:A=>({maxHeight:A.offsetHeight}),onLeaveEnd:h},(A,J)=>{let{className:Q,style:re}=A;return d.createElement("div",Object.assign({id:k,ref:vi(P,J),"data-show":!N,className:Y(L,Q),style:Object.assign(Object.assign(Object.assign({},S==null?void 0:S.style),l),re),onMouseEnter:u,onMouseLeave:f,onClick:m,role:"alert"},X),$?d.createElement(ds,{description:n,icon:e.icon,prefixCls:E,type:te}):null,d.createElement("div",{className:`${E}-content`},r?d.createElement("div",{className:`${E}-message`},r):null,n?d.createElement("div",{className:`${E}-description`},n):null),y?d.createElement("div",{className:`${E}-action`},y):null,d.createElement(fs,{isClosable:F,prefixCls:E,closeIcon:T,handleClose:ee,ariaProps:V}))}))});function hs(e,t,n){return t=yo(t),gi(e,pi()?Reflect.construct(t,n||[],yo(e).constructor):t.apply(e,n))}let ms=function(e){function t(){var n;return Ci(this,t),n=hs(this,t,arguments),n.state={error:void 0,info:{componentStack:""}},n}return yi(t,e),xi(t,[{key:"componentDidCatch",value:function(o,r){this.setState({error:o,info:r})}},{key:"render",value:function(){const{message:o,description:r,id:i,children:s}=this.props,{error:c,info:l}=this.state,u=(l==null?void 0:l.componentStack)||null,f=typeof o>"u"?(c||"").toString():o,m=typeof r>"u"?u:r;return c?d.createElement(Nr,{id:i,type:"error",message:f,description:d.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},m)}):s}}])}(d.Component);const Tr=Nr;Tr.ErrorBoundary=ms;var vs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},_s=function(t,n){return d.createElement(Qn,Kn({},t,{ref:n,icon:vs}))},io=d.forwardRef(_s),gs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 736c0-111.6-65.4-208-160-252.9V317.3c0-15.1-5.3-29.7-15.1-41.2L536.5 95.4C530.1 87.8 521 84 512 84s-18.1 3.8-24.5 11.4L335.1 276.1a63.97 63.97 0 00-15.1 41.2v165.8C225.4 528 160 624.4 160 736h156.5c-2.3 7.2-3.5 15-3.5 23.8 0 22.1 7.6 43.7 21.4 60.8a97.2 97.2 0 0043.1 30.6c23.1 54 75.6 88.8 134.5 88.8 29.1 0 57.3-8.6 81.4-24.8 23.6-15.8 41.9-37.9 53-64a97 97 0 0043.1-30.5 97.52 97.52 0 0021.4-60.8c0-8.4-1.1-16.4-3.1-23.8H864zM762.3 621.4c9.4 14.6 17 30.3 22.5 46.6H700V558.7a211.6 211.6 0 0162.3 62.7zM388 483.1V318.8l124-147 124 147V668H388V483.1zM239.2 668c5.5-16.3 13.1-32 22.5-46.6 16.3-25.2 37.5-46.5 62.3-62.7V668h-84.8zm388.9 116.2c-5.2 3-11.2 4.2-17.1 3.4l-19.5-2.4-2.8 19.4c-5.4 37.9-38.4 66.5-76.7 66.5-38.3 0-71.3-28.6-76.7-66.5l-2.8-19.5-19.5 2.5a27.7 27.7 0 01-17.1-3.5c-8.7-5-14.1-14.3-14.1-24.4 0-10.6 5.9-19.4 14.6-23.8h231.3c8.8 4.5 14.6 13.3 14.6 23.8-.1 10.2-5.5 19.6-14.2 24.5zM464 400a48 48 0 1096 0 48 48 0 10-96 0z"}}]},name:"rocket",theme:"outlined"},ps=function(t,n){return d.createElement(Qn,Kn({},t,{ref:n,icon:gs}))},Dr=d.forwardRef(ps),ys={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M881.7 187.4l-45.1-45.1a8.03 8.03 0 00-11.3 0L667.8 299.9l-54.7-54.7a7.94 7.94 0 00-13.5 4.7L576.1 439c-.6 5.2 3.7 9.5 8.9 8.9l189.2-23.5c6.6-.8 9.3-8.8 4.7-13.5l-54.7-54.7 157.6-157.6c3-3 3-8.1-.1-11.2zM439 576.1l-189.2 23.5c-6.6.8-9.3 8.9-4.7 13.5l54.7 54.7-157.5 157.5a8.03 8.03 0 000 11.3l45.1 45.1c3.1 3.1 8.2 3.1 11.3 0l157.6-157.6 54.7 54.7a7.94 7.94 0 0013.5-4.7L447.9 585a7.9 7.9 0 00-8.9-8.9z"}}]},name:"shrink",theme:"outlined"},xs=function(t,n){return d.createElement(Qn,Kn({},t,{ref:n,icon:ys}))},$t=d.forwardRef(xs);class Cs{async getBizList(t){try{let n;return bi||(n=await bo({url:`${xo}/lowcode-center-server/v1.0/biz/list`,method:"post",params:{},data:{...t||{}}})),n}catch(n){return console.log(n),{success:!1,data:{count:0,data:[]}}}}async getBizListV2(t){var n;try{return((n=(await bo({url:`${xo}/lowcode-center-server/v1.0/dictionary/infos`,method:"post",params:{},data:{...t||{codes:["COMPONENT-BIZ-CODE"]}}})).data)==null?void 0:n["COMPONENT-BIZ-CODE"])||[]}catch(o){return console.log(o),[]}}}const bs=new Cs,tn=e=>a.jsx(an,{style:{flex:1,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}});function ws(e,t){let n,o,r;return function(){const i=this,s=arguments;n?(clearTimeout(o),o=setTimeout(function(){Date.now()-r>=t&&(e.apply(i,s),r=Date.now())},t-(Date.now()-r))):(e.apply(i,s),r=Date.now(),n=!0)}}class Ss{constructor(t,n){B(this,"isDragging",!1);B(this,"container");B(this,"options");B(this,"boundMousedown");B(this,"boundMousemove");B(this,"boundMouseup");B(this,"boundMouseLeave");B(this,"boundMouseOver");B(this,"boundWheel");B(this,"boundResize");B(this,"originX",0);B(this,"originY",0);B(this,"beginX",0);B(this,"beginY",0);B(this,"moveX",0);B(this,"moveY",0);B(this,"resizeObserver");this.container=t,this.options=n,this.boundMousedown=this.mousedown.bind(this),this.boundMousemove=this.mousemove.bind(this),this.boundMouseup=this.mouseup.bind(this),this.boundMouseLeave=this.mouseLeave.bind(this),this.boundMouseOver=this.mouseOver.bind(this),this.boundWheel=this.wheel.bind(this),this.boundResize=ws(this.resize,500),this.resizeObserver=new ResizeObserver(o=>{this.boundResize(o)}),this.init()}mousedown(t){var n,o;t.stopPropagation(),t.preventDefault(),this.isDragging=!0,this.beginX=t.clientX,this.beginY=t.clientY,this.moveX=0,this.moveY=0,(o=(n=this.options)==null?void 0:n.mousedown)==null||o.call(n,t)}mousemove(t){var n,o;this.isDragging&&(t.stopPropagation(),t.preventDefault(),this.moveX=Math.floor(t.clientX-this.beginX+this.originX),this.moveY=Math.floor(t.clientY-this.beginY+this.originY),(o=(n=this.options)==null?void 0:n.mousemove)==null||o.call(n,t,this.moveX,this.moveY))}mouseup(t){var n,o;t.stopPropagation(),t.preventDefault(),this.isDragging&&(this.moveX!==0&&this.moveY!==0&&(this.originX=this.moveX,this.originY=this.moveY),this.isDragging=!1,(o=(n=this.options)==null?void 0:n.mouseup)==null||o.call(n,t))}mouseLeave(t){var n,o;t.stopPropagation(),t.preventDefault(),this.isDragging&&(this.moveX!==0&&this.moveY!==0&&(this.originX=this.moveX,this.originY=this.moveY),this.isDragging=!1,(o=(n=this.options)==null?void 0:n.mouseLeave)==null||o.call(n,t))}mouseOver(t){}resize(t){var n,o;(o=(n=this.options)==null?void 0:n.resize)==null||o.call(n,t)}wheel(t){var r,i;t.stopPropagation(),t.preventDefault();const n=-t.deltaY,o=-t.deltaX;this.moveY=this.originY,this.moveX=this.originX,this.moveY+=n,this.moveX+=o,this.originX=this.moveX,this.originY=this.moveY,(i=(r=this.options)==null?void 0:r.wheel)==null||i.call(r,t,this.moveX,this.moveY)}init(){this.container.addEventListener("mousedown",this.boundMousedown,!1),this.container.addEventListener("mousemove",this.boundMousemove,!1),this.container.addEventListener("mouseup",this.boundMouseup,!1),this.container.addEventListener("mouseleave",this.boundMouseLeave,!1),this.container.addEventListener("mouseover",this.boundMouseOver,!1),this.container.addEventListener("wheel",this.boundWheel,!1),this.resizeObserver.observe(this.container)}dispose(){this.container.removeEventListener("mousedown",this.boundMousedown,!0),this.container.removeEventListener("mousemove",this.boundMousemove,!1),this.container.removeEventListener("mouseup",this.boundMouseup,!1),this.container.removeEventListener("mouseleave",this.boundMouseLeave,!1),this.container.removeEventListener("mouseover",this.boundMouseOver,!1),this.container.removeEventListener("wheel",this.boundWheel,!1),this.resizeObserver.unobserve(this.container),this.resizeObserver.disconnect()}updatePosition(t,n){this.originX=t,this.originY=n}}class mt{static setContainerNoSelectCopy(t){t.style.setProperty("-moz-user-select","-moz-none"),t.style.setProperty("-moz-user-select","none"),t.style.setProperty("-o-user-select","none"),t.style.setProperty("-khtml-user-select","none"),t.style.setProperty("-webkit-user-select","none"),t.style.setProperty("-ms-user-select","none")}static setOuterContainerStyle(t,n){const o=document.createElement("style");return o.textContent=`
    #${n} {
      will-change: auto;
      width: 100%;
      height: 100%;
      position: relative;
      overflow: hidden;
      box-sizing: border-box;
      top: 0;
      left: 0;
      background: #f0f2f5;
      z-index: 1002;
    }
`,t.appendChild(o),o}static setContainerCursor(t){t.style.setProperty("cursor","pointer")}static removeContainerCursor(t,n){n?t.style.setProperty("cursor",n):t.style.removeProperty("cursor")}static hiddenScrollbar(t,n){const o=document.createElement("style");return o.textContent=`
    ${n}::-webkit-scrollbar { width: 0 !important }
    ${n} { -ms-overflow-style: none; }
    ${n} { overflow: -moz-scrollbars-none; }
`,t.appendChild(o),o}}function Es(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.map(function(o){return o.split(" ").map(function(r){return r?""+e+r:""}).join(" ")}).join(" ")}function js(e,t){return t.replace(/([^}{]*){/gm,function(n,o){return o.replace(/\.([^{,\s\d.]+)/g,"."+e+"$1")+"{"})}function Qe(e,t){return function(n){n&&(e[t]=n)}}function Ps(e,t,n){return function(o){o&&(e[t][n]=o)}}function Po(e,t){return function(n){var o=n.prototype;e.forEach(function(r){t(o,r)})}}var ks="function",Ns="object",Ts="string",Ds="number",zr="undefined",zs=typeof document!==zr&&document,Ms=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],mn=1e-7,Zt={cm:function(e){return e*96/2.54},mm:function(e){return e*96/254},in:function(e){return e*96},pt:function(e){return e*96/72},pc:function(e){return e*96/6},"%":function(e,t){return e*t/100},vw:function(e,t){return t===void 0&&(t=window.innerWidth),e/100*t},vh:function(e,t){return t===void 0&&(t=window.innerHeight),e/100*t},vmax:function(e,t){return t===void 0&&(t=Math.max(window.innerWidth,window.innerHeight)),e/100*t},vmin:function(e,t){return t===void 0&&(t=Math.min(window.innerWidth,window.innerHeight)),e/100*t}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Os(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),r=0,t=0;t<n;t++)for(var i=arguments[t],s=0,c=i.length;s<c;s++,r++)o[r]=i[s];return o}function Ls(e){return typeof e===zr}function Ae(e){return e&&typeof e===Ns}function Mr(e){return Array.isArray(e)}function ct(e){return typeof e===Ts}function Rs(e){return typeof e===Ds}function Or(e){return typeof e===ks}function Fs(e,t){var n=e===""||e==" ",o=t===""||t==" ";return o&&n||e===t}function Lr(e,t,n,o,r){var i=so(e,t,n);return i?n:Is(e,t,n+1,o,r)}function so(e,t,n){if(!e.ignore)return null;var o=t.slice(Math.max(n-3,0),n+3).join("");return new RegExp(e.ignore).exec(o)}function Is(e,t,n,o,r){for(var i=function(u){var f=t[u].trim();if(f===e.close&&!so(e,t,u))return{value:u};var m=u,h=nn(r,function(v){var _=v.open;return _===f});if(h&&(m=Lr(h,t,u,o,r)),m===-1)return s=u,"break";u=m,s=u},s,c=n;c<o;++c){var l=i(c);if(c=s,typeof l=="object")return l.value;if(l==="break")break}return-1}function ao(e,t){var n=ct(t)?{separator:t}:t,o=n.separator,r=o===void 0?",":o,i=n.isSeparateFirst,s=n.isSeparateOnlyOpenClose,c=n.isSeparateOpenClose,l=c===void 0?s:c,u=n.openCloseCharacters,f=u===void 0?Ms:u,m=f.map(function(p){var b=p.open,S=p.close;return b===S?b:b+"|"+S}).join("|"),h="(\\s*"+r+"\\s*|"+m+"|\\s+)",v=new RegExp(h,"g"),_=e.split(v).filter(function(p){return p&&p!=="undefined"}),x=_.length,g=[],y=[];function k(){return y.length?(g.push(y.join("")),y=[],!0):!1}for(var C=function(p){var b=_[p].trim(),S=p,E=nn(f,function(W){var ee=W.open;return ee===b}),H=nn(f,function(W){var ee=W.close;return ee===b});if(E){if(S=Lr(E,_,p,x,f),S!==-1&&l)return k()&&i||(g.push(_.slice(p,S+1).join("")),p=S,i)?(N=p,"break"):(N=p,"continue")}else if(H&&!so(H,_,p)){var M=Os(f);return M.splice(f.indexOf(H),1),{value:ao(e,{separator:r,isSeparateFirst:i,isSeparateOnlyOpenClose:s,isSeparateOpenClose:l,openCloseCharacters:M})}}else if(Fs(b,r)&&!s)return k(),i?(N=p,"break"):(N=p,"continue");S===-1&&(S=x-1),y.push(_.slice(p,S+1).join("")),p=S,N=p},N,j=0;j<x;++j){var P=C(j);if(j=N,typeof P=="object")return P.value;if(P==="break")break}return y.length&&g.push(y.join("")),g}function $s(e){return ao(e,"")}function Nt(e){return ao(e,",")}function As(e){var t=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(e);return!t||t.length<4?{}:{prefix:t[1],value:t[2],suffix:t[3]}}function Rr(e){var t=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(e);if(!t)return{prefix:"",unit:"",value:NaN};var n=t[1],o=t[2],r=t[3];return{prefix:n,unit:r,value:parseFloat(o)}}function Bs(e){return e.replace(/[\s-_]+([^\s-_])/g,function(t,n){return n.toUpperCase()})}function vn(e,t){return e.replace(/([a-z])([A-Z])/g,function(n,o,r){return""+o+t+r.toLowerCase()})}function Ln(){return Date.now?Date.now():new Date().getTime()}function ln(e,t,n){n===void 0&&(n=-1);for(var o=e.length,r=0;r<o;++r)if(t(e[r],r,e))return r;return n}function Vs(e,t,n){n===void 0&&(n=-1);for(var o=e.length,r=o-1;r>=0;--r)if(t(e[r],r,e))return r;return n}function Gs(e,t,n){var o=Vs(e,t);return o>-1?e[o]:n}function nn(e,t,n){var o=ln(e,t);return o>-1?e[o]:n}function Rn(e){return Object.keys(e)}function Ys(e){var t=Rn(e);return t.map(function(n){return e[n]})}function Tt(e,t){var n=Rr(e),o=n.value,r=n.unit;if(Ae(t)){var i=t[r];if(i){if(Or(i))return i(o);if(Zt[r])return Zt[r](o,i)}}else if(r==="%")return o*t/100;return Zt[r]?Zt[r](o):o}function _n(e,t){var n=1/t;return Math.round(e/t)/n}function Hs(e){return e.reduce(function(t,n){return t.concat(n)},[])}function Xs(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function Ws(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function Us(e,t){if(e.classList)e.classList.remove(t);else{var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}}function ge(e,t,n,o){e.addEventListener(t,n,o)}function me(e,t,n,o){e.removeEventListener(t,n,o)}function co(e){return(e==null?void 0:e.ownerDocument)||zs}function gn(e){var t;return((t=e==null?void 0:e.ownerDocument)===null||t===void 0?void 0:t.defaultView)||window}function qs(e){return e&&"postMessage"in e&&"blur"in e&&"self"in e}function lo(e){return Ae(e)&&e.nodeName&&e.nodeType&&"ownerDocument"in e}var Zs=function(){function e(){this.keys=[],this.values=[]}var t=e.prototype;return t.get=function(n){return this.values[this.keys.indexOf(n)]},t.set=function(n,o){var r=this.keys,i=this.values,s=r.indexOf(n),c=s===-1?r.length:s;r[c]=n,i[c]=o},e}(),Js=function(){function e(){this.object={}}var t=e.prototype;return t.get=function(n){return this.object[n]},t.set=function(n,o){this.object[n]=o},e}(),Ks=typeof Map=="function",Qs=function(){function e(){}var t=e.prototype;return t.connect=function(n,o){this.prev=n,this.next=o,n&&(n.next=this),o&&(o.prev=this)},t.disconnect=function(){var n=this.prev,o=this.next;n&&(n.next=o),o&&(o.prev=n)},t.getIndex=function(){for(var n=this,o=-1;n;)n=n.prev,++o;return o},e}();function ea(e,t){var n=[],o=[];return e.forEach(function(r){var i=r[0],s=r[1],c=new Qs;n[i]=c,o[s]=c}),n.forEach(function(r,i){r.connect(n[i-1])}),e.filter(function(r,i){return!t[i]}).map(function(r,i){var s=r[0],c=r[1];if(s===c)return[0,0];var l=n[s],u=o[c-1],f=l.getIndex();l.disconnect(),u?l.connect(u,u.next):l.connect(void 0,n[0]);var m=l.getIndex();return[f,m]})}var ta=function(){function e(n,o,r,i,s,c,l,u){this.prevList=n,this.list=o,this.added=r,this.removed=i,this.changed=s,this.maintained=c,this.changedBeforeAdded=l,this.fixed=u}var t=e.prototype;return Object.defineProperty(t,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),t.caculateOrdered=function(){var n=ea(this.changedBeforeAdded,this.fixed),o=this.changed,r=[];this.cacheOrdered=n.filter(function(i,s){var c=i[0],l=i[1],u=o[s],f=u[0],m=u[1];if(c!==l)return r.push([f,m]),!0}),this.cachePureChanged=r},e}();function Fr(e,t,n){var o=Ks?Map:n?Js:Zs,r=n||function(k){return k},i=[],s=[],c=[],l=e.map(r),u=t.map(r),f=new o,m=new o,h=[],v=[],_={},x=[],g=0,y=0;return l.forEach(function(k,C){f.set(k,C)}),u.forEach(function(k,C){m.set(k,C)}),l.forEach(function(k,C){var N=m.get(k);typeof N>"u"?(++y,s.push(C)):_[N]=y}),u.forEach(function(k,C){var N=f.get(k);typeof N>"u"?(i.push(C),++g):(c.push([N,C]),y=_[C]||0,h.push([N-y,C-g]),v.push(C===N),N!==C&&x.push([N,C]))}),s.reverse(),new ta(e,t,i,s,x,c,h,v)}var Fn=function(e,t){return Fn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(n[r]=o[r])},Fn(e,t)};function At(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Fn(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var $e=function(){return $e=Object.assign||function(t){for(var n,o=1,r=arguments.length;o<r;o++){n=arguments[o];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},$e.apply(this,arguments)};function Ir(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}function ko(e,t,n){for(var o=0,r=t.length,i;o<r;o++)(i||!(o in t))&&(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}function No(e){var t=0;return e.map(function(n){return n==null?"$compat".concat(++t):"".concat(n)})}function $r(e){var t=[];return e.forEach(function(n){t=t.concat(Mr(n)?$r(n):n)}),t}function pn(e,t){if(!t)return e;for(var n in t)Ls(e[n])&&(e[n]=t[n]);return e}function on(e,t){if(e===t)return!1;for(var n in e)if(!(n in t))return!0;for(var n in t)if(e[n]!==t[n])return!0;return!1}function To(e){var t=e.className,n=Ir(e,["className"]);return t!=null&&(n.class=t),delete n.style,delete n.children,n}function Do(e){var t={},n={};for(var o in e)o.indexOf("on")===0?n[o]=e[o]:t[o]=e[o];return[t,n]}function un(e){if(!e)return null;var t=e.b;return lo(t)?t:un(e.c)}function Ar(e){var t=e.parentNode;t&&t.removeChild(e)}function Br(e){e.forEach(function(t){t()})}function na(){return this.constructor(this.props,this.context)}var uo=0,dn=function(){function e(n,o,r,i,s,c,l){l===void 0&&(l={}),this.t=n,this.d=o,this.k=r,this.i=i,this.c=s,this.ref=c,this.ps=l,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var t=e.prototype;return t.s=function(){return!0},t.u=function(n,o,r,i,s){var c=this,l=c.d,u=Ys(o).filter(function(_){return _.$_req}),f=$r(u.map(function(_){return _.$_subs})),m=nn(f,function(_){return _.d===l});if(c.b&&!ct(r)&&!s&&!c.s(r.props,i)&&!m){var h=f.reduce(function(_,x){var g=x.d;return _[0]?_[0].d===g&&_.push(x):g>l&&_.push(x),_},[]);return h.forEach(function(_){Bt(_,_._ps,[_.o],n,o,!0)}),!1}c.o=r,c.ss(i);var v=c.ps;return ct(r)||(c.ps=r.props,c.ref=r.ref),fo(this),c.r(n,o,c.b?v:{},i),!0},t.md=function(){this.rr()},t.ss=function(){},t.ud=function(){this.rr()},t.rr=function(){var n=this,o=n.ref,r=n.fr;o&&o(r?r.current:n.b)},e}();function Vr(){return Object.__CROACT_CURRENT_INSTNACE__}function oa(){return uo}function ra(e){uo=e}function fo(e){return Object.__CROACT_CURRENT_INSTNACE__=e,uo=0,e}var ho=function(){function e(n,o){n===void 0&&(n={}),this.props=n,this.context=o,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var t=e.prototype;return t.render=function(){return null},t.shouldComponentUpdate=function(n,o){return this.props!==n||this.state!==o},t.setState=function(n,o,r){var i=this;i.$_timer||(i.$_state={}),clearTimeout(i.$_timer),i.$_timer=0,i.$_state=$e($e({},i.$_state),n),r?i.$_setState(o,r):i.$_timer=window.setTimeout(function(){i.$_timer=0,i.$_setState(o,r)})},t.forceUpdate=function(n){this.setState({},n,!0)},t.componentDidMount=function(){},t.componentDidUpdate=function(n,o){},t.componentWillUnmount=function(){},t.$_setState=function(n,o){var r=[],i=this.$_p,s=Bt(i.c,[i],[i.o],r,i._cs,$e($e({},this.state),this.$_state),o);s&&(n&&r.push(n),Br(r),fo(null))},e}(),Gr=function(e){At(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}var n=t.prototype;return n.shouldComponentUpdate=function(o,r){return on(this.props,o)||on(this.state,r)},t}(ho);function mo(e){var t=function(n){t.current=n};return t.current=e,t}function ia(e){return e._fr=!0,e}function sa(e,t,n,o){var r,i;return!((r=e==null?void 0:e.prototype)===null||r===void 0)&&r.render?i=new e(t,n):(i=new ho(t,n),i.constructor=e,e._fr?(o.fr=mo(),i.render=function(){return this.constructor(this.props,o.fr)}):i.render=na),i.$_p=o,i}var aa=function(e){At(t,e);function t(o,r,i,s,c,l,u){u===void 0&&(u={});var f=e.call(this,o,r,i,s,c,l,pn(u,o.defaultProps))||this;return f.typ="comp",f._usefs=[],f._uefs=[],f._defs=[],f}var n=t.prototype;return n.s=function(o,r){var i=this.b;return i.shouldComponentUpdate(pn(o,this.t.defaultProps),r||i.state)!==!1},n.r=function(o,r,i){var s,c,l=this,u=l.t;l.ps=pn(l.ps,l.t.defaultProps);var f=l.ps,m=!l.b,h=u.contextType,v=l.b,_=h==null?void 0:h.get(l);l._cs=r,m?(v=sa(u,f,_,l),l.b=v):(v.props=f,v.context=_);var x=v.state;l._usefs=[],l._uefs=[];var g=v.render();((c=(s=g==null?void 0:g.props)===null||s===void 0?void 0:s.children)===null||c===void 0?void 0:c.length)===0&&(g.props.children=l.ps.children);var y=$e($e({},r),v.$_cs);Bt(l,l._ps,g?[g]:[],o,y),m?l._uefs.push(function(){h==null||h.register(l),v.componentDidMount()}):l._uefs.push(function(){v.componentDidUpdate(i,x)}),o.push(function(){l._usefs.forEach(function(k){k()}),m?l.md():l.ud(),l._defs=l._uefs.map(function(k){return k()})})},n.ss=function(o){var r=this.b;!r||!o||(r.state=o)},n.un=function(){var o,r=this;r._ps.forEach(function(s){s.un()});var i=r.t;(o=i.contextType)===null||o===void 0||o.unregister(r),clearTimeout(r.b.$_timer),r._defs.forEach(function(s){s&&s()}),r.b.componentWillUnmount()},t}(dn);function ca(e,t,n){var o=vo(To(e),To(t)),r=o.added,i=o.removed,s=o.changed;for(var c in r)n.setAttribute(c,r[c]);for(var l in s)n.setAttribute(l,s[l][1]);for(var u in i)n.removeAttribute(u)}function la(e,t,n){var o=vo(e,t),r=o.added,i=o.removed;for(var s in i)n.e(s,!0);for(var c in r)n.e(c)}function vo(e,t){var n=Rn(e),o=Rn(t),r=Fr(n,o,function(l){return l}),i={},s={},c={};return r.added.forEach(function(l){var u=o[l];i[u]=t[u]}),r.removed.forEach(function(l){var u=n[l];s[u]=e[u]}),r.maintained.forEach(function(l){var u=l[0],f=n[u],m=[e[f],t[f]];e[f]!==t[f]&&(c[f]=m)}),{added:i,removed:s,changed:c}}function ua(e,t,n){var o=n.style,r=vo(e,t),i=r.added,s=r.removed,c=r.changed;for(var l in i){var u=vn(l,"-");o.setProperty(u,i[l])}for(var l in c){var f=vn(l,"-");o.setProperty(f,c[l][1])}for(var l in s){var m=vn(l,"-");o.removeProperty(m)}}function da(e){return e.replace(/^on/g,"").toLowerCase()}var fa=function(e){At(t,e);function t(){var o=e!==null&&e.apply(this,arguments)||this;return o.typ="elem",o._es={},o._svg=!1,o}var n=t.prototype;return n.e=function(o,r){var i=this,s=i._es,c=i.b,l=da(o);r?(me(c,l,s[o]),delete s[o]):(s[o]=function(u){var f,m;(m=(f=i.ps)[o])===null||m===void 0||m.call(f,u)},ge(c,l,s[o]))},n.s=function(o){return on(this.ps,o)},n.r=function(o,r,i){var s,c=this,l=!c.b,u=c.ps;if(l){var f=un(c.c),m=!1;c._svg||c.t==="svg"?m=!0:m=f&&f.ownerSVGElement,c._svg=m;var h=(s=c._hyd)===null||s===void 0?void 0:s.splice(0,1)[0],v=c.t;if(h)c._hyd=[].slice.call(h.children||[]);else{var _=co(f);m?h=_.createElementNS("http://www.w3.org/2000/svg",v):h=_.createElement(v)}c.b=h}Bt(c,c._ps,u.children,o,r);var x=c.b,g=Do(i),y=g[0],k=g[1],C=Do(u),N=C[0],j=C[1];return ca(y,N,x),la(k,j,c),ua(i.style||{},u.style||{},x),o.push(function(){l?c.md():c.ud()}),!0},n.un=function(){var o=this,r=o._es,i=o.b;for(var s in r)me(i,s,r[s]);o._ps.forEach(function(c){c.un()}),o._es={},o._sel||Ar(i)},t}(dn);function Ft(e){if(!e||lo(e))return e;var t=e.$_p._ps;return t.length?Ft(t[0].b):null}function Yr(e){if(e){if(e.b&&lo(e.b))return e;var t=e._ps;return t.length?Yr(t[0]):null}}function Me(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var r=t||{},i=r.key,s=r.ref,c=Ir(r,["key","ref"]);return{type:e,key:i,ref:s,props:$e($e({},c),{children:Hs(n).filter(function(l){return l!=null&&l!==!1})})}}var Hr=function(e){At(t,e);function t(o,r){r===void 0&&(r=0);var i=e.call(this,"container",r,"container",0,null)||this;return i.typ="container",i.b=o,i}var n=t.prototype;return n.r=function(){return!0},n.un=function(){},t}(dn),ha=function(e){At(t,e);function t(){var o=e!==null&&e.apply(this,arguments)||this;return o.typ="text",o}var n=t.prototype;return n.r=function(o){var r,i=this,s=!i.b;if(s){var c=un(i.c),l=(r=i._hyd)===null||r===void 0?void 0:r.splice(0,1)[0];i.b=l||co(c).createTextNode(i.t.replace("text_",""))}return o.push(function(){s?i.md():i.ud()}),!0},n.un=function(){Ar(this.b)},t}(dn);function ma(e,t,n){var o=n.map(function(l){return ct(l)?null:l.key}),r=No(t.map(function(l){return l.k})),i=No(o),s=Fr(r,i,function(l){return l});s.removed.forEach(function(l){t.splice(l,1)[0].un()}),s.ordered.forEach(function(l){var u=l[0],f=l[1],m=t.splice(u,1)[0];t.splice(f,0,m);var h=Ft(m.b),v=Ft(t[f+1]&&t[f+1].b);h&&h.parentNode.insertBefore(h,v)}),s.added.forEach(function(l){t.splice(l,0,zo(n[l],o[l],l,e))});var c=s.maintained.filter(function(l){l[0];var u=l[1],f=n[u],m=t[u],h=ct(f)?"text_".concat(f):f.type;return h!==m.t?(m.un(),t.splice(u,1,zo(f,o[u],u,e)),!0):(m.i=u,!1)});return ko(ko([],s.added,!0),c.map(function(l){l[0];var u=l[1];return u}))}function va(e,t){for(var n=e._ps,o=n.length,r=t.i+1;r<o;++r){var i=Ft(n[r].b);if(i)return i}return null}function zo(e,t,n,o){var r=o.d+1;if(ct(e)||Rs(e))return new ha("text_".concat(e),r,t,n,o,null,{});var i=e.type,s=typeof i=="string"?fa:aa;return new s(i,r,t,n,o,e.ref,e.props)}function Bt(e,t,n,o,r,i,s){var c=ma(e,t,n),l=e._hyd,u=t.filter(function(m,h){return m._hyd=l,m.u(o,r,n[h],i,s)});e.typ==="container"&&e._sel&&t.forEach(function(m){var h=Yr(m);h&&(h._sel=!0)}),e._hyd=null;var f=un(e);return f&&c.reverse().forEach(function(m){var h=t[m],v=Ft(h.b);if(v&&f!==v&&!v.parentNode){var _=va(e,h);f.insertBefore(v,_)}}),u.length>0}function _a(e,t,n,o){n===void 0&&(n=t.__CROACT__),o===void 0&&(o={});var r=!!n;n||(n=new Hr(t));var i=[];return Bt(n,n._ps,e?[e]:[],i,o,void 0,void 0),Br(i),fo(null),r||(t.__CROACT__=n),n}function Mo(e,t,n){return!n&&e&&(n=new Hr(t.parentElement),n._hyd=[t],n._sel=!0),_a(e,t,n),n}function Xr(e){var t=Vr(),n=t._hs||(t._hs=[]),o=oa(),r=n[o];if(ra(o+1),r){if(!on(r.deps,e.deps))return r.updated=!1,r;n[o]=e}else n.push(e);return e.value=e.func(),e.updated=!0,e}function ga(e,t){var n=Xr({func:e,deps:t});return n.value}function pa(e){return ga(function(){return mo(e)},[])}function Wr(e,t,n){var o=Vr(),r=Xr({func:function(){return e},deps:t}),i=n?o._usefs:o._uefs;r.updated?i.push(function(){return r.effect&&r.effect(),r.effect=e(),r.effect}):i.push(function(){return r.effect})}function ya(e,t,n){Wr(function(){e==null||e(t())},n,!0)}var In=function(e,t){return In=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(n[r]=o[r])},In(e,t)};function xa(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");In(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Ca=function(e){xa(t,e);function t(){var o=e!==null&&e.apply(this,arguments)||this;return o.state={scrollPos:0},o.width=0,o.height=0,o._zoom=0,o._rulerScale=0,o._observer=null,o._checkResize=function(){o.resize()},o}var n=t.prototype;return n.render=function(){var o=this.props;return this._zoom=o.zoom,Me("canvas",{ref:Qe(this,"canvasElement"),style:this.props.style})},n.componentDidMount=function(){var o=this.props;this.state.scrollPos=o.defaultScrollPos||0;var r=this.canvasElement,i=r.getContext("2d",{alpha:!0});this.canvasContext=i,o.useResizeObserver?(this._observer=new ResizeObserver(this._checkResize),this._observer.observe(r,{box:"border-box"})):this.resize()},n.componentDidUpdate=function(){this.resize()},n.componentWillUnmount=function(){var o;this.state.scrollPos=0,(o=this._observer)===null||o===void 0||o.disconnect()},n.getScrollPos=function(){return this.state.scrollPos},n.scroll=function(o,r){this.draw({scrollPos:o,zoom:r})},n.resize=function(o){var r=this.canvasElement,i=this.props,s=i.width,c=i.height,l=i.scrollPos,u=this._getRulerScale();this.width=s||r.offsetWidth,this.height=c||r.offsetHeight,r.width=this.width*u,r.height=this.height*u,this.draw({scrollPos:l,zoom:o})},n.draw=function(o){o===void 0&&(o={});var r=this.props,i=o.zoom,s=i===void 0?this._zoom:i,c=o.scrollPos,l=c===void 0?this.state.scrollPos:c,u=o.marks,f=u===void 0?r.marks:u,m=o.selectedRanges,h=m===void 0?r.selectedRanges:m,v=o.segment,_=v===void 0?r.segment||10:v,x=o.unit,g=x===void 0?r.unit:x;this._zoom=s;var y=r,k=y.type,C=y.backgroundColor,N=y.lineColor,j=y.textColor,P=y.textBackgroundColor,p=y.direction,b=y.negativeRuler,S=b===void 0?!0:b,E=y.textFormat,H=y.range,M=H===void 0?[-1/0,1/0]:H,W=y.rangeBackgroundColor,ee=y.selectedBackgroundColor,te=y.lineWidth,F=te===void 0?1:te,$=y.selectedRangesText,L=y.selectedRangesTextColor,X=L===void 0?"#44aaff":L,T=y.selectedRangesTextOffset,V=T===void 0?[0,0]:T,A=y.markColor,J=A===void 0?"#ff5":A,Q=this._getRulerScale(),re=this.width,le=this.height,bt=this.state;bt.scrollPos=l;var I=this.canvasContext,ve=k==="horizontal",G=S!==!1,R=r.font||"10px sans-serif",K=r.textAlign||"left",ie=r.textOffset||[0,0],ne=ve?le:re,oe=Tt("".concat(r.mainLineSize||"100%"),ne),se=Tt("".concat(r.longLineSize||10),ne),_e=Tt("".concat(r.shortLineSize||7),ne),ae=r.lineOffset||[0,0];switch(C==="transparent"?I.clearRect(0,0,re*Q,le*Q):(I.rect(0,0,re*Q,le*Q),I.fillStyle=C,I.fill()),I.save(),I.scale(Q,Q),I.strokeStyle=N,I.lineWidth=F,I.font=R,I.fillStyle=j,I.textAlign=K,p){case"start":I.textBaseline="top";break;case"center":I.textBaseline="middle";break;case"end":I.textBaseline="bottom";break}I.translate(.5,0),I.beginPath();for(var Pe=ve?re:le,Be=s*g,Ve=Math.floor(l*s/Be),nt=Math.ceil((l*s+Pe)/Be),Vt=nt-Ve,Gt=Math.max(["left","center","right"].indexOf(K)-1,-1),Le=ve?le:re,ot=[],Ge=0;Ge<=Vt;++Ge){var Ue=(Ge+Ve)*g,wt="".concat(Ue);E&&(wt=E(Ue));var fn=I.measureText(wt).width;ot.push({color:j,offset:ie,backgroundColor:P,value:Ue,text:wt,textSize:fn})}if(ee!=="transparent"&&(h!=null&&h.length)&&h.forEach(function(Z){var he=Math.max(Z[0],M[0],S?-1/0:0),ue=Math.min(Z[1],M[1]),Ce=(he-l)*s,Ne=(ue-he)*s;$&&Z.forEach(function(je){var Re="".concat(je);E&&(Re=E(je));var Ye=I.measureText(Re).width,Ze=je*s,Ut=Ze+Ye;Gs(ot,function(ht,Et){var it=ht.value,ai=ht.textSize,po=it*s,ci=po+ai;po<=Ut&&Ze<=ci&&ot.splice(Et,1)}),ot.push({value:je,color:X,offset:V,text:Re,textSize:Ye})}),!(Ne<=0)&&(I.save(),I.fillStyle=ee,ve?I.fillRect(Ce,0,Ne,Le):I.fillRect(0,Ce,Le,Ne),I.restore())}),W!=="transparent"&&M[0]!==-1/0&&M[1]!==1/0){var Yt=(M[0]-l)*s,Ht=(M[1]-M[0])*s;I.save(),I.fillStyle=W,ve?I.fillRect(Yt,0,Ht,Le):I.fillRect(0,Yt,Le,Ht),I.restore()}for(var Ge=0;Ge<=Vt;++Ge){var Ue=Ge+Ve;if(!(!G&&Ue<0))for(var Xt=Ue*g,hn=(Xt-l)*s,qe=0;qe<_;++qe){var ke=hn+qe/_*Be,Wt=Xt+qe/_*g;if(!(ke<0||ke>=Pe||Wt<M[0]||Wt>M[1])){var dt=qe===0?oe:qe%2===0?se:_e,rt=0;switch(p){case"start":rt=0;break;case"center":rt=Le/2-dt/2;break;case"end":rt=Le-dt;break}var St=ve?[ke+ae[0],rt+ae[1]]:[rt+ae[0],ke+ae[1]],ft=St[0],w=St[1],z=ve?[ft,w+dt]:[ft+dt,w],O=z[0],ce=z[1];I.moveTo(ft+ae[0],w+ae[1]),I.lineTo(O+ae[0],ce+ae[1])}}}I.stroke(),I.beginPath(),I.strokeStyle=J,I.lineWidth=1,(f||[]).forEach(function(Z){var he=(-l+Z)*s;if(!(he<0||he>=Pe||Z<M[0]||Z>M[1])){var ue=ve?[he+ae[0],ae[1]]:[ae[0],he+ae[1]],Ce=ue[0],Ne=ue[1],je=ve?[Ce,Ne+ne]:[Ce+ne,Ne],Re=je[0],Ye=je[1];I.moveTo(Ce+ae[0],Ne+ae[1]),I.lineTo(Re+ae[0],Ye+ae[1])}}),I.stroke(),ot.forEach(function(Z){var he=Z.value,ue=Z.offset,Ce=Z.backgroundColor,Ne=Z.color,je=Z.text,Re=Z.textSize;if(!(!G&&he<0)){var Ye=(he-l)*s;if(!(Ye<-Be||Ye>=Pe+g*s||he<M[0]||he>M[1])){var Ze=0;switch(p){case"start":Ze=17;break;case"center":Ze=Le/2;break;case"end":Ze=Le-17;break}var Ut=ve?[Ye+Gt*-3,Ze]:[Ze,Ye+Gt*3],ht=Ut[0],Et=Ut[1];if(Ce){var it=0;switch(K){case"left":it=0;break;case"center":it=-Re/2;break;case"right":it=-Re;break}I.save(),I.fillStyle=Ce,ve?I.fillRect(ht+ue[0]+it,0,Re,oe):(I.translate(0,Et+ue[1]),I.rotate(-Math.PI/2),I.fillRect(it,0,Re,oe)),I.restore()}I.save(),I.fillStyle=Ne,ve?I.fillText(je,ht+ue[0],Et+ue[1]):(I.translate(ht+ue[0],Et+ue[1]),I.rotate(-Math.PI/2),I.fillText(je,0,0)),I.restore()}}}),I.restore()},n._getRulerScale=function(){var o=this.props.defaultPixelScale||2;if(!this._rulerScale){var r=window.devicePixelRatio>1;if(!r&&window.matchMedia){var i=window.matchMedia("only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)");r=i&&i.matches}this._rulerScale=r?3:o}return this._rulerScale},t.defaultProps={type:"horizontal",zoom:1,width:0,height:0,unit:50,negativeRuler:!0,mainLineSize:"100%",longLineSize:10,shortLineSize:7,segment:10,direction:"end",style:{width:"100%",height:"100%"},backgroundColor:"#333333",font:"10px sans-serif",textColor:"#ffffff",textBackgroundColor:"transparent",lineColor:"#777777",range:[-1/0,1/0],rangeBackgroundColor:"transparent",lineWidth:1,selectedBackgroundColor:"#555555",defaultScrollPos:0,markColor:"#f55",marks:[]},t}(Gr),Ur=["type","width","height","unit","zoom","direction","textAlign","font","segment","mainLineSize","longLineSize","shortLineSize","lineOffset","textOffset","negativeRuler","range","scrollPos","defaultScrollPos","style","backgroundColor","rangeBackgroundColor","lineColor","textColor","textBackgroundColor","textFormat","warpSelf","selectedBackgroundColor","selectedRanges","defaultPixelScale","useResizeObserver","selectedRangesText","selectedRangesTextColor","selectedRangesTextOffset","marks","markColor"];/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var $n=function(){return $n=Object.assign||function(t){for(var n,o=1,r=arguments.length;o<r;o++){n=arguments[o];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},$n.apply(this,arguments)};function ba(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),r=0,t=0;t<n;t++)for(var i=arguments[t],s=0,c=i.length;s<c;s++,r++)o[r]=i[s];return o}var wa=function(){function e(){this._events={}}var t=e.prototype;return t.on=function(n,o){if(Ae(n))for(var r in n)this.on(r,n[r]);else this._addEvent(n,o,{});return this},t.off=function(n,o){if(!n)this._events={};else if(Ae(n))for(var r in n)this.off(r);else if(!o)this._events[n]=[];else{var i=this._events[n];if(i){var s=ln(i,function(c){return c.listener===o});s>-1&&i.splice(s,1)}}return this},t.once=function(n,o){var r=this;return o&&this._addEvent(n,o,{once:!0}),new Promise(function(i){r._addEvent(n,i,{once:!0})})},t.emit=function(n,o){var r=this;o===void 0&&(o={});var i=this._events[n];if(!n||!i)return!0;var s=!1;return o.eventType=n,o.stop=function(){s=!0},o.currentTarget=this,ba(i).forEach(function(c){c.listener(o),c.once&&r.off(n,c.listener)}),!s},t.trigger=function(n,o){return o===void 0&&(o={}),this.emit(n,o)},t._addEvent=function(n,o,r){var i=this._events;i[n]=i[n]||[];var s=i[n];s.push($n({listener:o},r))},e}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var An=function(e,t){return An=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])},An(e,t)};function Sa(e,t){An(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var fe=function(){return fe=Object.assign||function(t){for(var n,o=1,r=arguments.length;o<r;o++){n=arguments[o];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},fe.apply(this,arguments)};function Ea(e,t){var n=t[0]-e[0],o=t[1]-e[1],r=Math.atan2(o,n);return r>=0?r:r+Math.PI*2}function yn(e){return Ea([e[0].clientX,e[0].clientY],[e[1].clientX,e[1].clientY])/Math.PI*180}function ja(e){return e.touches&&e.touches.length>=2}function Jt(e){return e?e.touches?ka(e.touches):[qr(e)]:[]}function Pa(e){return e&&(e.type.indexOf("mouse")>-1||"button"in e)}function Oo(e,t,n){var o=n.length,r=Dt(e,o),i=r.clientX,s=r.clientY,c=r.originalClientX,l=r.originalClientY,u=Dt(t,o),f=u.clientX,m=u.clientY,h=Dt(n,o),v=h.clientX,_=h.clientY,x=i-f,g=s-m,y=i-v,k=s-_;return{clientX:c,clientY:l,deltaX:x,deltaY:g,distX:y,distY:k}}function xn(e){return Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2))}function ka(e){for(var t=Math.min(e.length,2),n=[],o=0;o<t;++o)n.push(qr(e[o]));return n}function qr(e){return{clientX:e.clientX,clientY:e.clientY}}function Dt(e,t){t===void 0&&(t=e.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},o=Math.min(e.length,t),r=0;r<o;++r){var i=e[r];n.originalClientX+="originalClientX"in i?i.originalClientX:i.clientX,n.originalClientY+="originalClientY"in i?i.originalClientY:i.clientY,n.clientX+=i.clientX,n.clientY+=i.clientY}return t?{clientX:n.clientX/t,clientY:n.clientY/t,originalClientX:n.originalClientX/t,originalClientY:n.originalClientY/t}:n}var Cn=function(){function e(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}return e.prototype.getAngle=function(t){return t===void 0&&(t=this.prevClients),yn(t)},e.prototype.getRotation=function(t){return t===void 0&&(t=this.prevClients),yn(t)-yn(this.startClients)},e.prototype.getPosition=function(t,n){t===void 0&&(t=this.prevClients);var o=Oo(t||this.prevClients,this.prevClients,this.startClients),r=o.deltaX,i=o.deltaY;return this.movement+=Math.sqrt(r*r+i*i),this.prevClients=t,o},e.prototype.getPositions=function(t){t===void 0&&(t=this.prevClients);for(var n=this.prevClients,o=this.startClients,r=Math.min(this.length,n.length),i=[],s=0;s<r;++s)i[s]=Oo([t[s]],[n[s]],[o[s]]);return i},e.prototype.getMovement=function(t){var n=this.movement;if(!t)return n;var o=Dt(t,this.length),r=Dt(this.prevClients,this.length),i=o.clientX-r.clientX,s=o.clientY-r.clientY;return Math.sqrt(i*i+s*s)+n},e.prototype.getDistance=function(t){return t===void 0&&(t=this.prevClients),xn(t)},e.prototype.getScale=function(t){return t===void 0&&(t=this.prevClients),xn(t)/xn(this.startClients)},e.prototype.move=function(t,n){this.startClients.forEach(function(o){o.clientX-=t,o.clientY-=n}),this.prevClients.forEach(function(o){o.clientX-=t,o.clientY-=n})},e}(),Lo=["textarea","input"],Na=function(e){Sa(t,e);function t(n,o){o===void 0&&(o={});var r=e.call(this)||this;r.options={},r.flag=!1,r.pinchFlag=!1,r.data={},r.isDrag=!1,r.isPinch=!1,r.clientStores=[],r.targets=[],r.prevTime=0,r.doubleFlag=!1,r._useMouse=!1,r._useTouch=!1,r._useDrag=!1,r._dragFlag=!1,r._isTrusted=!1,r._isMouseEvent=!1,r._isSecondaryButton=!1,r._preventMouseEvent=!1,r._prevInputEvent=null,r._isDragAPI=!1,r._isIdle=!0,r._preventMouseEventId=0,r._window=window,r.onDragStart=function(h,v){if(v===void 0&&(v=!0),!(!r.flag&&h.cancelable===!1)){var _=h.type.indexOf("drag")>=-1;if(!(r.flag&&_)){r._isDragAPI=!0;var x=r.options,g=x.container,y=x.pinchOutside,k=x.preventWheelClick,C=x.preventRightClick,N=x.preventDefault,j=x.checkInput,P=x.dragFocusedInput,p=x.preventClickEventOnDragStart,b=x.preventClickEventOnDrag,S=x.preventClickEventByCondition,E=r._useTouch,H=!r.flag;if(r._isSecondaryButton=h.which===3||h.button===2,k&&(h.which===2||h.button===1)||C&&(h.which===3||h.button===2))return r.stop(),!1;if(H){var M=r._window.document.activeElement,W=h.target;if(W){var ee=W.tagName.toLowerCase(),te=Lo.indexOf(ee)>-1,F=W.isContentEditable;if(te||F){if(j||!P&&M===W)return!1;if(M&&(M===W||F&&M.isContentEditable&&M.contains(W)))if(P)W.blur();else return!1}else if((N||h.type==="touchstart")&&M){var $=M.tagName.toLowerCase();(M.isContentEditable||Lo.indexOf($)>-1)&&M.blur()}(p||b||S)&&ge(r._window,"click",r._onClick,!0)}r.clientStores=[new Cn(Jt(h))],r._isIdle=!1,r.flag=!0,r.isDrag=!1,r._isTrusted=v,r._dragFlag=!0,r._prevInputEvent=h,r.data={},r.doubleFlag=Ln()-r.prevTime<200,r._isMouseEvent=Pa(h),!r._isMouseEvent&&r._preventMouseEvent&&r._allowMouseEvent();var L=r._preventMouseEvent||r.emit("dragStart",fe(fe({data:r.data,datas:r.data,inputEvent:h,isMouseEvent:r._isMouseEvent,isSecondaryButton:r._isSecondaryButton,isTrusted:v,isDouble:r.doubleFlag},r.getCurrentStore().getPosition()),{preventDefault:function(){h.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));L===!1&&r.stop(),r._isMouseEvent&&r.flag&&N&&h.preventDefault()}if(!r.flag)return!1;var X=0;if(H?(r._attchDragEvent(),E&&y&&(X=setTimeout(function(){ge(g,"touchstart",r.onDragStart,{passive:!1})}))):E&&y&&me(g,"touchstart",r.onDragStart),r.flag&&ja(h)){if(clearTimeout(X),H&&h.touches.length!==h.changedTouches.length)return;r.pinchFlag||r.onPinchStart(h)}}}},r.onDrag=function(h,v){if(r.flag){var _=r.options.preventDefault;!r._isMouseEvent&&_&&h.preventDefault(),r._prevInputEvent=h;var x=Jt(h),g=r.moveClients(x,h,!1);if(r._dragFlag){if(r.pinchFlag||g.deltaX||g.deltaY){var y=r._preventMouseEvent||r.emit("drag",fe(fe({},g),{isScroll:!!v,inputEvent:h}));if(y===!1){r.stop();return}}r.pinchFlag&&r.onPinch(h,x)}r.getCurrentStore().getPosition(x,!0)}},r.onDragEnd=function(h){if(r.flag){var v=r.options,_=v.pinchOutside,x=v.container,g=v.preventClickEventOnDrag,y=v.preventClickEventOnDragStart,k=v.preventClickEventByCondition,C=r.isDrag;(g||y||k)&&requestAnimationFrame(function(){r._allowClickEvent()}),!k&&!y&&g&&!C&&r._allowClickEvent(),r._useTouch&&_&&me(x,"touchstart",r.onDragStart),r.pinchFlag&&r.onPinchEnd(h);var N=h!=null&&h.touches?Jt(h):[],j=N.length;j===0||!r.options.keepDragging?r.flag=!1:r._addStore(new Cn(N));var P=r._getPosition(),p=Ln(),b=!C&&r.doubleFlag;r._prevInputEvent=null,r.prevTime=C||b?0:p,r.flag||(r._dettachDragEvent(),r._preventMouseEvent||r.emit("dragEnd",fe({data:r.data,datas:r.data,isDouble:b,isDrag:C,isClick:!C,isMouseEvent:r._isMouseEvent,isSecondaryButton:r._isSecondaryButton,inputEvent:h,isTrusted:r._isTrusted},P)),r.clientStores=[],r._isMouseEvent||(r._preventMouseEvent=!0,clearTimeout(r._preventMouseEventId),r._preventMouseEventId=setTimeout(function(){r._preventMouseEvent=!1},200)),r._isIdle=!0)}},r.onBlur=function(){r.onDragEnd()},r._allowClickEvent=function(){me(r._window,"click",r._onClick,!0)},r._onClick=function(h){r._allowClickEvent(),r._allowMouseEvent();var v=r.options.preventClickEventByCondition;v!=null&&v(h)||(h.stopPropagation(),h.preventDefault())},r._onContextMenu=function(h){var v=r.options;v.preventRightClick?r.onDragEnd(h):h.preventDefault()},r._passCallback=function(){};var i=[].concat(n),s=i[0];r._window=qs(s)?s:gn(s),r.options=fe({checkInput:!1,container:s&&!("document"in s)?gn(s):s,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},o);var c=r.options,l=c.container,u=c.events,f=c.checkWindowBlur;if(r._useDrag=u.indexOf("drag")>-1,r._useTouch=u.indexOf("touch")>-1,r._useMouse=u.indexOf("mouse")>-1,r.targets=i,r._useDrag&&i.forEach(function(h){ge(h,"dragstart",r.onDragStart)}),r._useMouse&&(i.forEach(function(h){ge(h,"mousedown",r.onDragStart),ge(h,"mousemove",r._passCallback)}),ge(l,"contextmenu",r._onContextMenu)),f&&ge(gn(),"blur",r.onBlur),r._useTouch){var m={passive:!1};i.forEach(function(h){ge(h,"touchstart",r.onDragStart,m),ge(h,"touchmove",r._passCallback,m)})}return r}return t.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},t.prototype.getMovement=function(n){return this.getCurrentStore().getMovement(n)+this.clientStores.slice(1).reduce(function(o,r){return o+r.movement},0)},t.prototype.isDragging=function(){return this.isDrag},t.prototype.isIdle=function(){return this._isIdle},t.prototype.isFlag=function(){return this.flag},t.prototype.isPinchFlag=function(){return this.pinchFlag},t.prototype.isDoubleFlag=function(){return this.doubleFlag},t.prototype.isPinching=function(){return this.isPinch},t.prototype.scrollBy=function(n,o,r,i){i===void 0&&(i=!0),this.flag&&(this.clientStores[0].move(n,o),i&&this.onDrag(r,!0))},t.prototype.move=function(n,o){var r=n[0],i=n[1],s=this.getCurrentStore(),c=s.prevClients;return this.moveClients(c.map(function(l){var u=l.clientX,f=l.clientY;return{clientX:u+r,clientY:f+i,originalClientX:u,originalClientY:f}}),o,!0)},t.prototype.triggerDragStart=function(n){this.onDragStart(n,!1)},t.prototype.setEventData=function(n){var o=this.data;for(var r in n)o[r]=n[r];return this},t.prototype.setEventDatas=function(n){return this.setEventData(n)},t.prototype.getCurrentEvent=function(n){return n===void 0&&(n=this._prevInputEvent),fe(fe({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:n})},t.prototype.getEventData=function(){return this.data},t.prototype.getEventDatas=function(){return this.data},t.prototype.unset=function(){var n=this,o=this.targets,r=this.options.container;this.off(),me(this._window,"blur",this.onBlur),this._useDrag&&o.forEach(function(i){me(i,"dragstart",n.onDragStart)}),this._useMouse&&(o.forEach(function(i){me(i,"mousedown",n.onDragStart)}),me(r,"contextmenu",this._onContextMenu)),this._useTouch&&(o.forEach(function(i){me(i,"touchstart",n.onDragStart)}),me(r,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},t.prototype.onPinchStart=function(n){var o=this,r=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>r)){var i=new Cn(Jt(n));this.pinchFlag=!0,this._addStore(i);var s=this.emit("pinchStart",fe(fe({data:this.data,datas:this.data,angle:i.getAngle(),touches:this.getCurrentStore().getPositions()},i.getPosition()),{inputEvent:n,isTrusted:this._isTrusted,preventDefault:function(){n.preventDefault()},preventDrag:function(){o._dragFlag=!1}}));s===!1&&(this.pinchFlag=!1)}},t.prototype.onPinch=function(n,o){if(!(!this.flag||!this.pinchFlag||o.length<2)){var r=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",fe(fe({data:this.data,datas:this.data,movement:this.getMovement(o),angle:r.getAngle(o),rotation:r.getRotation(o),touches:r.getPositions(o),scale:r.getScale(o),distance:r.getDistance(o)},r.getPosition(o)),{inputEvent:n,isTrusted:this._isTrusted}))}},t.prototype.onPinchEnd=function(n){if(this.pinchFlag){var o=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var r=this.getCurrentStore();this.emit("pinchEnd",fe(fe({data:this.data,datas:this.data,isPinch:o,touches:r.getPositions()},r.getPosition()),{inputEvent:n}))}},t.prototype.getCurrentStore=function(){return this.clientStores[0]},t.prototype.moveClients=function(n,o,r){var i=this._getPosition(n,r),s=this.isDrag;(i.deltaX||i.deltaY)&&(this.isDrag=!0);var c=!1;return!s&&this.isDrag&&(c=!0),fe(fe({data:this.data,datas:this.data},i),{movement:this.getMovement(n),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:o,isTrusted:this._isTrusted,isFirstDrag:c})},t.prototype._addStore=function(n){this.clientStores.splice(0,0,n)},t.prototype._getPosition=function(n,o){var r=this.getCurrentStore(),i=r.getPosition(n,o),s=this.clientStores.slice(1).reduce(function(u,f){var m=f.getPosition();return u.distX+=m.distX,u.distY+=m.distY,u},i),c=s.distX,l=s.distY;return fe(fe({},i),{distX:c,distY:l})},t.prototype._attchDragEvent=function(){var n=this._window,o=this.options.container,r={passive:!1};this._isDragAPI&&(ge(o,"dragover",this.onDrag,r),ge(n,"dragend",this.onDragEnd)),this._useMouse&&(ge(o,"mousemove",this.onDrag),ge(n,"mouseup",this.onDragEnd)),this._useTouch&&(ge(o,"touchmove",this.onDrag,r),ge(n,"touchend",this.onDragEnd,r),ge(n,"touchcancel",this.onDragEnd,r))},t.prototype._dettachDragEvent=function(){var n=this._window,o=this.options.container;this._isDragAPI&&(me(o,"dragover",this.onDrag),me(n,"dragend",this.onDragEnd)),this._useMouse&&(me(o,"mousemove",this.onDrag),me(n,"mouseup",this.onDragEnd)),this._useTouch&&(me(o,"touchstart",this.onDragStart),me(o,"touchmove",this.onDrag),me(n,"touchend",this.onDragEnd),me(n,"touchcancel",this.onDragEnd))},t.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},t}(wa);function Ta(e){for(var t=5381,n=e.length;n;)t=t*33^e.charCodeAt(--n);return t>>>0}var Da=Ta;function za(e){return Da(e).toString(36)}function Ma(e){if(e&&e.getRootNode){var t=e.getRootNode();if(t.nodeType===11)return t}}function Oa(e,t,n){return n.original?t:t.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(o,r){var i=r.trim();return(i?Nt(i):[""]).map(function(s){var c=s.trim();return c.indexOf("@")===0?c:c.indexOf(":global")>-1?c.replace(/\:global/g,""):c.indexOf(":host")>-1?"".concat(c.replace(/\:host/g,".".concat(e))):c?".".concat(e," ").concat(c):".".concat(e)}).join(", ")+" {"})}function La(e,t,n,o,r){var i=co(o),s=i.createElement("style");return s.setAttribute("type","text/css"),s.setAttribute("data-styled-id",e),s.setAttribute("data-styled-count","1"),n.nonce&&s.setAttribute("nonce",n.nonce),s.innerHTML=Oa(e,t,n),(r||i.head||i.body).appendChild(s),s}function Ra(e){var t="rCS"+za(e);return{className:t,inject:function(n,o){o===void 0&&(o={});var r=Ma(n),i=(r||n.ownerDocument||document).querySelector('style[data-styled-id="'.concat(t,'"]'));if(!i)i=La(t,e,o,n,r);else{var s=parseFloat(i.getAttribute("data-styled-count"))||0;i.setAttribute("data-styled-count","".concat(s+1))}return{destroy:function(){var c,l=parseFloat(i.getAttribute("data-styled-count"))||0;l<=1?(i.remove?i.remove():(c=i.parentNode)===null||c===void 0||c.removeChild(i),i=null):i.setAttribute("data-styled-count","".concat(l-1))}}}}}var Bn=function(){return Bn=Object.assign||function(t){for(var n,o=1,r=arguments.length;o<r;o++){n=arguments[o];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Bn.apply(this,arguments)};function Fa(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}function Ia(e,t){var n=Ra(t),o=n.className;return ia(function(r,i){var s=r.className,c=s===void 0?"":s;r.cspNonce;var l=Fa(r,["className","cspNonce"]),u=pa();return ya(i,function(){return u.current},[]),Wr(function(){var f=n.inject(u.current,{nonce:r.cspNonce});return function(){f.destroy()}},[]),Me(e,Bn({ref:u,"data-styled-id":o,className:"".concat(c," ").concat(o)},l))})}function $a(e,t,n,o,r,i){for(var s=0;s<r;++s){var c=n+s*r,l=o+s*r;e[c]+=e[l]*i,t[c]+=t[l]*i}}function Aa(e,t,n,o,r){for(var i=0;i<r;++i){var s=n+i*r,c=o+i*r,l=e[s],u=t[s];e[s]=e[c],e[c]=l,t[s]=t[c],t[c]=u}}function Ba(e,t,n,o,r){for(var i=0;i<o;++i){var s=n+i*o;e[s]/=r,t[s]/=r}}function Va(e,t){for(var n=e.slice(),o=Zr(t),r=0;r<t;++r){var i=t*r+r;if(!_n(n[i],mn)){for(var s=r+1;s<t;++s)if(n[t*r+s]){Aa(n,o,r,s,t);break}}if(!_n(n[i],mn))return[];Ba(n,o,r,t,n[i]);for(var s=0;s<t;++s){var c=s,l=s+r*t,u=n[l];!_n(u,mn)||r===s||$a(n,o,c,r,t,-u)}}return o}function lt(e,t,n){n===void 0&&(n=Math.sqrt(e.length));var o=[],r=e.length/n,i=t.length/r;if(r){if(!i)return e}else return t;for(var s=0;s<n;++s)for(var c=0;c<i;++c){o[c*n+s]=0;for(var l=0;l<r;++l)o[c*n+s]+=e[l*n+s]*t[c*r+l]}return o}function Ga(e,t,n){var o=lt(e,t,n),r=o[n-1];return o.map(function(i){return i/r})}function Ya(e,t){return lt(e,[1,0,0,0,0,Math.cos(t),Math.sin(t),0,0,-Math.sin(t),Math.cos(t),0,0,0,0,1],4)}function Ha(e,t){return lt(e,[Math.cos(t),0,-Math.sin(t),0,0,1,0,0,Math.sin(t),0,Math.cos(t),0,0,0,0,1],4)}function Xa(e,t){return lt(e,Wa(t,4))}function Kt(e,t){var n=t[0],o=n===void 0?1:n,r=t[1],i=r===void 0?1:r,s=t[2],c=s===void 0?1:s;return lt(e,[o,0,0,0,0,i,0,0,0,0,c,0,0,0,0,1],4)}function bn(e,t){var n=t[0],o=n===void 0?0:n,r=t[1],i=r===void 0?0:r,s=t[2],c=s===void 0?0:s;return lt(e,[1,0,0,0,0,1,0,0,0,0,1,0,o,i,c,1],4)}function Vn(e,t){return lt(e,t,4)}function Wa(e,t){var n=Math.cos(e),o=Math.sin(e),r=Zr(t);return r[0]=n,r[1]=o,r[t]=-o,r[t+1]=n,r}function Zr(e){for(var t=e*e,n=[],o=0;o<t;++o)n[o]=o%(e+1)?0:1;return n}var zt=function(){return zt=Object.assign||function(t){for(var n,o=1,r=arguments.length;o<r;o++){n=arguments[o];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},zt.apply(this,arguments)};function Jr(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Ua(e,t){return t===void 0&&(t=0),Za(Ja(e,t))}function Ro(e,t){var n=Ga(e,[t[0],t[1]||0,t[2]||0,1],4),o=n[3]||1;return[n[0]/o,n[1]/o,n[2]/o]}function qa(e,t){t===void 0&&(t=document.body);for(var n=e,o=Jr();n;){var r=getComputedStyle(n).transform;if(o=Vn(Ua(r),o),n===t)break;n=n.parentElement}return o=Va(o,4),o[12]=0,o[13]=0,o[14]=0,o}function Za(e){var t=Jr();return e.forEach(function(n){var o=n.matrixFunction,r=n.functionValue;o&&(t=o(t,r))}),t}function Ja(e,t){t===void 0&&(t=0);var n=Mr(e)?e:$s(e);return n.map(function(o){var r=As(o),i=r.prefix,s=r.value,c=null,l=i,u="";if(i==="translate"||i==="translateX"||i==="translate3d"){var f=Ae(t)?zt(zt({},t),{"o%":t["%"]}):{"%":t,"o%":t},m=Nt(s).map(function(W,ee){return ee===0&&"x%"in f?f["%"]=t["x%"]:ee===1&&"y%"in f?f["%"]=t["y%"]:f["%"]=t["o%"],Tt(W,f)}),h=m[0],v=m[1],_=v===void 0?0:v,x=m[2],g=x===void 0?0:x;c=bn,u=[h,_,g]}else if(i==="translateY"){var y=Ae(t)?zt({"%":t["y%"]},t):{"%":t},_=Tt(s,y);c=bn,u=[0,_,0]}else if(i==="translateZ"){var g=parseFloat(s);c=bn,u=[0,0,g]}else if(i==="scale"||i==="scale3d"){var k=Nt(s).map(function(W){return parseFloat(W)}),C=k[0],N=k[1],j=N===void 0?C:N,P=k[2],p=P===void 0?1:P;c=Kt,u=[C,j,p]}else if(i==="scaleX"){var C=parseFloat(s);c=Kt,u=[C,1,1]}else if(i==="scaleY"){var j=parseFloat(s);c=Kt,u=[1,j,1]}else if(i==="scaleZ"){var p=parseFloat(s);c=Kt,u=[1,1,p]}else if(i==="rotate"||i==="rotateZ"||i==="rotateX"||i==="rotateY"){var b=Rr(s),S=b.unit,E=b.value,H=S==="rad"?E:E*Math.PI/180;i==="rotate"||i==="rotateZ"?(l="rotateZ",c=Xa):i==="rotateX"?c=Ya:i==="rotateY"&&(c=Ha),u=H}else if(i==="matrix3d")c=Vn,u=Nt(s).map(function(W){return parseFloat(W)});else if(i==="matrix"){var M=Nt(s).map(function(W){return parseFloat(W)});c=Vn,u=[M[0],M[1],0,0,M[2],M[3],0,0,0,0,1,0,M[4],M[5],0,1]}else l="";return{name:i,functionName:l,value:s,matrixFunction:c,functionValue:u}})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Gn=function(){return Gn=Object.assign||function(t){for(var n,o=1,r=arguments.length;o<r;o++){n=arguments[o];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Gn.apply(this,arguments)};function Ka(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),r=0,t=0;t<n;t++)for(var i=arguments[t],s=0,c=i.length;s<c;s++,r++)o[r]=i[s];return o}var Qa=function(){function e(){this._events={}}var t=e.prototype;return t.on=function(n,o){if(Ae(n))for(var r in n)this.on(r,n[r]);else this._addEvent(n,o,{});return this},t.off=function(n,o){if(!n)this._events={};else if(Ae(n))for(var r in n)this.off(r);else if(!o)this._events[n]=[];else{var i=this._events[n];if(i){var s=ln(i,function(c){return c.listener===o});s>-1&&i.splice(s,1)}}return this},t.once=function(n,o){var r=this;return o&&this._addEvent(n,o,{once:!0}),new Promise(function(i){r._addEvent(n,i,{once:!0})})},t.emit=function(n,o){var r=this;o===void 0&&(o={});var i=this._events[n];if(!n||!i)return!0;var s=!1;return o.eventType=n,o.stop=function(){s=!0},o.currentTarget=this,Ka(i).forEach(function(c){c.listener(o),c.once&&r.off(n,c.listener)}),!s},t.trigger=function(n,o){return o===void 0&&(o={}),this.emit(n,o)},t._addEvent=function(n,o,r){var i=this._events;i[n]=i[n]||[];var s=i[n];s.push(Gn({listener:o},r))},e}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Yn=function(e,t){return Yn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])},Yn(e,t)};function ec(e,t){Yn(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var yt=function(){return yt=Object.assign||function(t){for(var n,o=1,r=arguments.length;o<r;o++){n=arguments[o];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},yt.apply(this,arguments)};function tc(e){var t=e.container;return t===document.body?[t.scrollLeft||document.documentElement.scrollLeft,t.scrollTop||document.documentElement.scrollTop]:[t.scrollLeft,t.scrollTop]}function wn(e){if(e){if(ct(e))return document.querySelector(e)}else return null;if(Or(e))return e();if(e instanceof Element)return e;if("current"in e)return e.current;if("value"in e)return e.value}var nc=function(e){ec(t,e);function t(){var o=e!==null&&e.apply(this,arguments)||this;return o._startRect=null,o._startPos=[],o._prevTime=0,o._timer=0,o._prevScrollPos=[0,0],o._isWait=!1,o._flag=!1,o}var n=t.prototype;return n.dragStart=function(o,r){var i=wn(r.container);if(!i){this._flag=!1;return}var s=0,c=0,l=0,u=0;if(i===document.body)l=window.innerWidth,u=window.innerHeight;else{var f=i.getBoundingClientRect();s=f.top,c=f.left,l=f.width,u=f.height}this._flag=!0,this._startPos=[o.clientX,o.clientY],this._startRect={top:s,left:c,width:l,height:u},this._prevScrollPos=this._getScrollPosition([0,0],r)},n.drag=function(o,r){if(clearTimeout(this._timer),!!this._flag){var i=o.clientX,s=o.clientY,c=r.threshold,l=c===void 0?0:c,u=this,f=u._startRect,m=u._startPos,h=[0,0];return f.top>s-l?(m[1]>f.top||s<m[1])&&(h[1]=-1):f.top+f.height<s+l&&(m[1]<f.top+f.height||s>m[1])&&(h[1]=1),f.left>i-l?(m[0]>f.left||i<m[0])&&(h[0]=-1):f.left+f.width<i+l&&(m[0]<f.left+f.width||i>m[0])&&(h[0]=1),!h[0]&&!h[1]?!1:this._continueDrag(yt(yt({},r),{direction:h,inputEvent:o,isDrag:!0}))}},n.checkScroll=function(o){var r=this;if(this._isWait)return!1;var i=o.prevScrollPos,s=i===void 0?this._prevScrollPos:i,c=o.direction,l=o.throttleTime,u=l===void 0?0:l,f=o.inputEvent,m=o.isDrag,h=this._getScrollPosition(c||[0,0],o),v=h[0]-s[0],_=h[1]-s[1],x=c||[v?Math.abs(v)/v:0,_?Math.abs(_)/_:0];return this._prevScrollPos=h,!v&&!_?!1:(this.trigger("move",{offsetX:x[0]?v:0,offsetY:x[1]?_:0,inputEvent:f}),u&&m&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){r._continueDrag(o)},u)),!0)},n.dragEnd=function(){this._flag=!1,clearTimeout(this._timer)},n._getScrollPosition=function(o,r){var i=r.container,s=r.getScrollPosition,c=s===void 0?tc:s;return c({container:wn(i),direction:o})},n._continueDrag=function(o){var r=this,i,s,c=o.container,l=o.direction,u=o.throttleTime,f=o.useScroll,m=o.isDrag,h=o.inputEvent;if(!(!this._flag||m&&this._isWait)){var v=Ln(),_=Math.max(u+this._prevTime-v,0);if(_>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){r._continueDrag(o)},_),!1;this._prevTime=v;var x=this._getScrollPosition(l,o);this._prevScrollPos=x,m&&(this._isWait=!0);var g={container:wn(c),direction:l,inputEvent:h};return(s=(i=o).requestScroll)===null||s===void 0||s.call(i,g),this.trigger("scroll",g),this._isWait=!1,f||this.checkScroll(yt(yt({},o),{prevScrollPos:x,direction:l,inputEvent:h}))}},t}(Qa),Hn=function(e,t){return Hn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(n[r]=o[r])},Hn(e,t)};function oc(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Hn(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Te=function(){return Te=Object.assign||function(t){for(var n,o=1,r=arguments.length;o<r;o++){n=arguments[o];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Te.apply(this,arguments)};function Mt(e,t,n){if(n||arguments.length===2)for(var o=0,r=t.length,i;o<r;o++)(i||!(o in t))&&(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}function He(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Es.apply(void 0,Mt(["scena-guides-"],e,!1))}var rc=He("guide","adder"),ic=He("guides"),sc=He("guide"),Fo=He("dragging"),ac=He("display-drag"),cc=js("scena-guides-",`
{
    position: relative;
    width: 100%;
    height: 100%;
}
canvas {
    position: relative;
}
.guide-origin {
    position: absolute;
    width: 1px;
    height: 1px;
    top: 0;
    left: 0;
    opacity: 0;
}
.guides {
    position: absolute;
    bottom: 0;
    right: 0;
    will-change: transform;
    z-index: 2000;
}
.guide-pos {
    position: absolute;
    font-weight: bold;
    font-size: 12px;
    color: #f33;
}
.horizontal .guide-pos {
    bottom: 100%;
    left: 50%;
    transform: translate(-50%);
}
.vertical .guide-pos {
    left: calc(100% + 2px);
    top: 50%;
    transform: translateY(-50%);
}
.display-drag {
    position: absolute;
    will-change: transform;
    z-index: 2000;
    font-weight: bold;
    font-size: 12px;
    display: none;
    left: 20px;
    top: -20px;
    color: #f33;
}
:host.horizontal .guides {
    width: 100%;
    height: 0;
}
:host.vertical .guides {
    height: 100%;
    width: 0;
}
:host.horizontal canvas {
    cursor: ns-resize;
}
:host.vertical canvas {
    cursor: ew-resize;
}
.guide {
    position: absolute;
    background: #f33;
    z-index: 2;
}
.guide.dragging:before {
    position: absolute;
    content: "";
    width: 100%;
    height: 100%;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}
:host.horizontal .guide {
    width: 100%;
    height: 1px;
    cursor: row-resize;
}
:host.vertical .guide {
    width: 1px;
    height: 100%;
    cursor: col-resize;
}
.mobile :host.horizontal .guide {
    transform: scale(1, 2);
}
.mobile :host.vertical .guide {
    transform: scale(2, 1);
}
:host.horizontal .guide:before {
    height: 20px;
}
:host.vertical .guide:before {
    width: 20px;
}
.adder {
    display: none;
}
.adder.dragging {
    display: block;
}
`),lc=Mt(["className","rulerStyle","snapThreshold","snaps","displayDragPos","cspNonce","dragPosFormat","defaultGuides","showGuides","scrollOptions","guideStyle","guidesOffset","digit","defaultGuidesPos","dragGuideStyle","displayGuidePos","guidePosFormat","guidePosStyle","lockGuides","guidesZoom"],Ur,!0),uc=["getGuides","loadGuides","scroll","scrollGuides","resize","getElement","getRulerElement","forceUpdate","getRulerScrollPos","getGuideScrollPos","zoomTo","drawRuler"],dc=["changeGuides","requestScroll","dragStart","drag","dragEnd","clickRuler"],fc=Ia("div",cc),hc=function(e){oc(t,e);function t(o){var r=e.call(this,o)||this;return r.state={guides:[]},r.scrollPos=0,r.managerRef=mo(),r.guideElements=[],r._isFirstMove=!1,r._zoom=1,r._guidesZoom=1,r._observer=null,r.onDragStart=function(i){var s=i.datas,c=i.inputEvent;r._isFirstMove=!0,r.movePos(i),r.props.onDragStart(Te(Te({},i),{dragElement:s.target})),r.gesto.isFlag()&&(c.stopPropagation(),c.preventDefault(),r._startDragScroll(i))},r._onDrag=function(i){r._isFirstMove&&(r._isFirstMove=!1,Ws(i.datas.target,Fo));var s=r.movePos(i);if(r.props.onDrag(Te(Te({},i),{dragElement:i.datas.target})),!r.gesto.isFlag()){r._endDragScroll(i);return}return r._dragScroll(i),s},r.onDragEnd=function(i){var s=i.datas,c=i.isDouble,l=i.distX,u=i.distY,f=r.movePos(i),m=r.state.guides,h=r.props,v=h.onChangeGuides,_=h.displayDragPos,x=h.digit,g=h.lockGuides,y=h.guidesOffset,k=r._guidesZoom,C=parseFloat((f/k).toFixed(x||0)),N=r.scrollPos-(y||0);if(_&&(r.displayElement.style.cssText+="display: none;"),Us(s.target,Fo),r.props.onDragEnd(Te(Te({},i),{dragElement:s.target})),r._endDragScroll(i),s.fromRuler)r._isFirstMove&&r.props.onClickRuler(Te(Te({},i),{pos:0})),C>=N&&m.indexOf(C)<0&&r.setState({guides:Mt(Mt([],m,!0),[C],!1)},function(){v({guides:r.state.guides,distX:l,distY:u,index:m.length,isAdd:!0,isRemove:!1,isChange:!1})});else{var j=parseFloat(s.target.getAttribute("data-index")),P=!1,p=!1;m=Mt([],m,!0);var b=m.indexOf(C);if(c||C<N||b>-1&&b!==j){if(g&&(g===!0||g.indexOf("remove")>-1))return;m.splice(j,1),P=!0}else{if(b>-1)return;if(g&&(g===!0||g.indexOf("change")>-1))return;m[j]=C,p=!0}r.setState({guides:m},function(){var S=r.state.guides;v({distX:l,distY:u,guides:S,isAdd:!1,index:j,isChange:p,isRemove:P})})}},r._onCheck=function(){r.resize()},r.state.guides=o.defaultGuides||[],r.scrollPos=o.defaultGuidesPos||0,r}var n=t.prototype;return n.render=function(){var o=this.props,r=o.className,i=o.type,s=o.zoom,c=o.guidesZoom,l=o.style,u=o.rulerStyle,f=o.displayDragPos,m=o.cspNonce,h=o.dragGuideStyle,v=o.guidePosStyle,_=v===void 0?{}:v,x=this.props,g=this.getTranslateName(),y={};return Ur.forEach(function(k){k==="style"||k==="warpSelf"||k==="useResizeObserver"||(y[k]=x[k])}),this._zoom=s,this._guidesZoom=c||s,Me(fc,{ref:this.managerRef,cspNonce:m,className:"".concat(He("manager",i)," ").concat(r),style:l},Me("div",{className:He("guide-origin"),ref:Qe(this,"originElement")}),Me(Ca,Te({ref:Qe(this,"ruler"),style:u},y)),Me("div",{className:ic,ref:Qe(this,"guidesElement"),style:{transform:"".concat(g,"(").concat(-this.scrollPos*this._guidesZoom,"px)")}},f&&Me("div",{className:ac,ref:Qe(this,"displayElement"),style:_||{}}),Me("div",{className:rc,ref:Qe(this,"adderElement"),style:h}),this.renderGuides()))},n.drawRuler=function(o){this.ruler.draw(o)},n.renderGuides=function(){var o=this,r=this.props,i=r,s=i.type,c=i.showGuides,l=i.guideStyle,u=i.displayGuidePos,f=i.guidePosStyle,m=f===void 0?{}:f,h=i.guidesOffset,v=this._guidesZoom,_=this.getTranslateName(),x=this.state.guides,g=r.guidePosFormat||r.dragPosFormat||function(y){return y};if(this.guideElements=[],c)return x.map(function(y,k){var C=y+(h||0);return Me("div",{className:He("guide",s),ref:Ps(o,"guideElements",k),key:k,"data-index":k,"data-pos":y,style:Te(Te({},l),{transform:"".concat(_,"(").concat(C*v,"px) translateZ(0px)")})},u&&Me("div",{className:He("guide-pos"),style:m||{}},g(y)))})},n.componentDidMount=function(){var o=this;this.gesto=new Na(this.managerRef.current,{container:document.body}).on("dragStart",function(r){var i=o.props,s=i.type,c=i.lockGuides,l=o._guidesZoom;if(c===!0){r.stop();return}var u=r.inputEvent,f=u.target,m=r.datas,h=o.ruler.canvasElement,v=o.guidesElement,_=s==="horizontal",x=o.originElement.getBoundingClientRect(),g=qa(o.managerRef.current),y=Ro(g,[r.clientX-x.left,r.clientY-x.top]);y[0]-=v.offsetLeft,y[1]-=v.offsetTop,y[_?1:0]+=o.scrollPos*l,m.offsetPos=y,m.matrix=g;var k=c&&c.indexOf("add")>-1,C=c&&c.indexOf("remove")>-1,N=c&&c.indexOf("change")>-1;if(f===h){if(k){r.stop();return}m.fromRuler=!0,m.target=o.adderElement}else if(Xs(f,sc)){if(C&&N){r.stop();return}m.target=f}else return r.stop(),!1;o.onDragStart(r)}).on("drag",this._onDrag).on("dragEnd",this.onDragEnd),this.props.useResizeObserver?(this._observer=new ResizeObserver(this._onCheck),this._observer.observe(this.guidesElement,{box:"border-box"}),this._observer.observe(this.getRulerElement(),{box:"border-box"})):this._onCheck()},n.componentWillUnmount=function(){var o;this.gesto.unset(),(o=this._observer)===null||o===void 0||o.disconnect()},n.componentDidUpdate=function(o){var r=this.props.defaultGuides;o.defaultGuides!==r&&this.setState({guides:r||[]})},n.loadGuides=function(o){this.setState({guides:o})},n.getGuides=function(){return this.state.guides},n.scrollGuides=function(o,r){r===void 0&&(r=this._guidesZoom),this._setZoom({guidesZoom:r});var i=this.getTranslateName(),s=this.guidesElement;this.scrollPos=o,s.style.transform="".concat(i,"(").concat(-o*r,"px)");var c=this.state.guides,l=this.props.guidesOffset||0;this.guideElements.forEach(function(u,f){if(u){var m=c[f]+(l||0);u.style.transform="".concat(i,"(").concat(m*r,"px) translateZ(0px)"),u.style.display=-o+m<0?"none":"block"}})},n.zoomTo=function(o,r){r===void 0&&(r=o),this.scroll(this.getRulerScrollPos(),o),this.scrollGuides(this.getGuideScrollPos(),r)},n.getElement=function(){return this.managerRef.current},n.getRulerElement=function(){return this.ruler.canvasElement},n.getGuideScrollPos=function(){return this.scrollPos},n.getRulerScrollPos=function(){return this.ruler.getScrollPos()},n.scroll=function(o,r){r===void 0&&(r=this._zoom),this._setZoom({zoom:r}),this.ruler.scroll(o,r)},n.resize=function(o){o===void 0&&(o=this._zoom),this._setZoom({zoom:o}),this.ruler.resize(o)},n.movePos=function(o){var r=o.datas,i=o.distX,s=o.distY,c=this.props,l=c.type,u=c.snaps,f=c.snapThreshold,m=c.displayDragPos,h=c.digit,v=c.guidesOffset||0,_=this._guidesZoom,x=c.dragPosFormat||function(H){return H},g=l==="horizontal",y=Ro(r.matrix,[i,s]),k=r.offsetPos,C=y[0]+k[0],N=y[1]+k[1],j=v*_,P=Math.round(g?N:C)-v,p=parseFloat((P/_).toFixed(h||0)),b=u.slice().sort(function(H,M){return Math.abs(p-H)-Math.abs(p-M)});if(b.length&&Math.abs(b[0]*_-P)<f&&(p=b[0],P=p*_),!r.fromRuler||!this._isFirstMove){if(m){var S=l==="horizontal"?[C,P+j]:[P+j,N];this.displayElement.style.cssText+="display: block;transform: translate(-50%, -50%) "+"translate(".concat(S.map(function(H){return"".concat(H,"px")}).join(", "),")"),this.displayElement.innerHTML="".concat(x(p))}var E=r.target;E.setAttribute("data-pos",p),E.style.transform="".concat(this.getTranslateName(),"(").concat(P+v*_,"px)")}return P},n.getTranslateName=function(){return this.props.type==="horizontal"?"translateY":"translateX"},n._startDragScroll=function(o){var r=this,i=this.props.scrollOptions;if(i){var s=o.datas,c=new nc;s.dragScroll=c,c.on("scroll",function(l){var u,f,m=l.container,h=l.direction;(f=(u=r.props).onRequestScroll)===null||f===void 0||f.call(u,{container:m,direction:h})}).on("move",function(l){var u=l.offsetX,f=l.offsetY,m=l.inputEvent;r.gesto.scrollBy(u,f,m.inputEvent,!0)}),c.dragStart(o,{container:i.container})}},n._dragScroll=function(o){var r=this.props.scrollOptions;if(r){var i=o.datas.dragScroll;i.drag(o,r)}},n._endDragScroll=function(o){var r;(r=o.datas.dragScroll)===null||r===void 0||r.dragEnd(),o.datas.dragScroll=null},n._setZoom=function(o){var r=o.zoom,i=o.guidesZoom;this.props.zoom;var s=!!this.props.guidesZoom;s?i&&(this._guidesZoom=i):(i&&(this._zoom=i,this._guidesZoom=i),r&&(this._guidesZoom=r)),r&&(this._zoom=r)},t.defaultProps={className:"",type:"horizontal",zoom:1,guidesZoom:0,style:{},snapThreshold:5,snaps:[],digit:0,onClickRuler:function(){},onChangeGuides:function(){},onRequestScroll:function(){},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},displayDragPos:!1,dragPosFormat:function(o){return o},defaultGuides:[],lockGuides:!1,showGuides:!0,guideStyle:{},dragGuideStyle:{},guidePosStyle:{},defaultGuidesPos:0},t}(Gr),Xn=function(e,t){return Xn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(n[r]=o[r])},Xn(e,t)};function _o(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Xn(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var rn=function(){return rn=Object.assign||function(t){for(var n,o=1,r=arguments.length;o<r;o++){n=arguments[o];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},rn.apply(this,arguments)};function mc(e,t,n,o){var r=arguments.length,i=r<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,n):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(s=e[c])&&(i=(r<3?s(i):r>3?s(t,n,i):s(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i}var vc=lc,_c=uc,gc=dc,pc=function(e){_o(t,e);function t(o){var r=e.call(this,o)||this;return r.state={},r.state=r.props,r}var n=t.prototype;return n.render=function(){return Me(hc,rn({ref:Qe(this,"guides")},this.state))},t}(ho);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Wn=function(){return Wn=Object.assign||function(t){for(var n,o=1,r=arguments.length;o<r;o++){n=arguments[o];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Wn.apply(this,arguments)};function yc(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),r=0,t=0;t<n;t++)for(var i=arguments[t],s=0,c=i.length;s<c;s++,r++)o[r]=i[s];return o}var xc=function(){function e(){this._events={}}var t=e.prototype;return t.on=function(n,o){if(Ae(n))for(var r in n)this.on(r,n[r]);else this._addEvent(n,o,{});return this},t.off=function(n,o){if(!n)this._events={};else if(Ae(n))for(var r in n)this.off(r);else if(!o)this._events[n]=[];else{var i=this._events[n];if(i){var s=ln(i,function(c){return c.listener===o});s>-1&&i.splice(s,1)}}return this},t.once=function(n,o){var r=this;return o&&this._addEvent(n,o,{once:!0}),new Promise(function(i){r._addEvent(n,i,{once:!0})})},t.emit=function(n,o){var r=this;o===void 0&&(o={});var i=this._events[n];if(!n||!i)return!0;var s=!1;return o.eventType=n,o.stop=function(){s=!0},o.currentTarget=this,yc(i).forEach(function(c){c.listener(o),c.once&&r.off(n,c.listener)}),!s},t.trigger=function(n,o){return o===void 0&&(o={}),this.emit(n,o)},t._addEvent=function(n,o,r){var i=this._events;i[n]=i[n]||[];var s=i[n];s.push(Wn({listener:o},r))},e}(),Cc=function(e){_o(t,e);function t(o,r){r===void 0&&(r={});var i=e.call(this)||this;i.containerProvider=null,i.selfElement=null,i._warp=!1;var s={};gc.forEach(function(l){s[Bs("on ".concat(l))]=function(u){return i.trigger(l,u)}});var c;return r.warpSelf?(delete r.warpSelf,i._warp=!0,c=o):(c=document.createElement("div"),o.appendChild(c)),i.containerProvider=Mo(Me(pc,rn({ref:Qe(i,"innerGuides")},s,r)),c),i}var n=t.prototype;return n.setState=function(o,r){this.innerGuides.setState(o,r)},n.forceUpdate=function(o){this.innerGuides.forceUpdate(o)},n.destroy=function(){var o,r=this.selfElement;Mo(null,r,this.containerProvider),this._warp||(o=r==null?void 0:r.parentElement)===null||o===void 0||o.removeChild(r),this.selfElement=null,this.innerGuides=null},n.getInnerGuides=function(){return this.innerGuides.guides},t=mc([Po(_c,function(o,r){o[r]||(o[r]=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var c=this.getInnerGuides();if(!(!c||!c[r]))return c[r].apply(c,i)})}),Po(vc,function(o,r){Object.defineProperty(o,r,{get:function(){return this.getInnerGuides().props[r]},set:function(i){var s;this.innerGuides.setState((s={},s[r]=i,s))},enumerable:!0,configurable:!0})})],t),t}(xc),Io=function(e){_o(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Cc);const Kr=30;class bc{constructor(t,n){B(this,"container");B(this,"box");B(this,"horizontalDomContainer");B(this,"verticalDomContainer");B(this,"styleBox");B(this,"options");B(this,"horizontalGuides");B(this,"verticalGuides");B(this,"prefixId","canvasLayoutRule");B(this,"horizontalGuidesLine",[]);B(this,"verticalGuidesLine",[]);this.container=t,this.options=n,this.initDomStructure(),this.init()}initDomStructure(){const{width:t=Kr,backgroundColor:n="#ffffff",lineColor:o="#777"}=this.options.horizontal,r=document.createElement("div");r.setAttribute("id",`${this.prefixId}Style`);const i=document.createElement("div");i.setAttribute("id",`${this.prefixId}Box`);const s=document.createElement("style");s.textContent=`
     #${this.prefixId}Box:before, #${this.prefixId}Box:after {
        position: absolute;
        content: "";
        background: ${o};
    }
    #${this.prefixId}Box {
       // position: relative;
       position: absolute;
       top: 0;
       left: 0;
       width: ${t}px;
       height: ${t}px;
       background: ${n};
       box-sizing: border-box;
       z-index: 21;
    }
    #${this.prefixId}Box:before {
        width: 1px;
        height: 100%;
        left: 100%;
    }
    #${this.prefixId}Box:after {
        height: 1px;
        width: 100%;
        top: 100%;
    }
    `,r.appendChild(s);const c=document.createElement("div");c.setAttribute("id",`${this.prefixId}Horizontal`),c.classList.add("ruler"),c.classList.add("horizontal"),this.horizontalDomContainer=c;const l=document.createElement("style");l.textContent=`
     #${this.prefixId}Horizontal {
        position: absolute;
        top: 0;
        left: 0;
      }
     #${this.prefixId}Horizontal.horizontal {
        left: 0px;
        width: 100%;
        height: ${t}px;
      }
    `,r.appendChild(l);const u=document.createElement("div");u.setAttribute("id",`${this.prefixId}Vertical`),u.classList.add("ruler"),u.classList.add("vertical");const f=document.createElement("style");this.verticalDomContainer=u,f.textContent=`
     #${this.prefixId}Vertical {
        position: absolute;
        top: 0;
        left: 0;
      }
     #${this.prefixId}Vertical.vertical {
        top: 0px;
        width: ${t}px;
        height: 100%;
      }
    `,r.appendChild(f),this.container.appendChild(i),this.container.appendChild(r),this.container.appendChild(u),this.container.appendChild(c),this.box=i,this.styleBox=r}init(){const t=this.options;this.horizontalGuides=new Io(this.horizontalDomContainer,{type:"horizontal",...t.horizontal}),this.verticalGuides=new Io(this.verticalDomContainer,{type:"vertical",...t.vertical})}dispose(){var t,n,o,r,i,s,c,l;this.horizontalGuides.destroy(),this.verticalGuides.destroy(),(n=(t=this.verticalDomContainer)==null?void 0:t.remove)==null||n.call(t),(r=(o=this.horizontalDomContainer)==null?void 0:o.remove)==null||r.call(o),(s=(i=this.styleBox)==null?void 0:i.remove)==null||s.call(i),(l=(c=this.box)==null?void 0:c.remove)==null||l.call(c)}clearRulesMask(){this.verticalGuides.loadGuides([]),this.horizontalGuides.loadGuides([])}scrollHorizontalRuler(t){this.horizontalGuides.scroll(t)}scrollHorizontalGuides(t){this.horizontalGuides.scrollGuides(t)}scrollVerticalRuler(t){this.verticalGuides.scroll(t)}scrollVerticalGuides(t){this.horizontalGuides.scrollGuides(t)}clearGuidesLine(){var t,n,o,r,i,s,c,l;this.horizontalGuidesLine=((n=(t=this.horizontalGuides)==null?void 0:t.getGuides)==null?void 0:n.call(t))||[],this.verticalGuidesLine=((r=(o=this.verticalGuides)==null?void 0:o.getGuides)==null?void 0:r.call(o))||[],(s=(i=this.horizontalGuides)==null?void 0:i.loadGuides)==null||s.call(i,[]),(l=(c=this.verticalGuides)==null?void 0:c.loadGuides)==null||l.call(c,[])}loadGuidesLine(t,n){var o,r,i,s;(r=(o=this.horizontalGuides)==null?void 0:o.loadGuides)==null||r.call(o,t||this.horizontalGuidesLine||[]),(s=(i=this.verticalGuides)==null?void 0:i.loadGuides)==null||s.call(i,n||this.verticalGuidesLine||[])}}const $o={horizontal:{backgroundColor:"#ffffff",textColor:"#505663",lineColor:"#838b99",displayDragPos:!0,rulerStyle:{left:"30px",width:"calc(100% - 30px)",height:"100%"},useResizeObserver:!0},vertical:{backgroundColor:"#ffffff",textColor:"#505663",lineColor:"#838b99",displayDragPos:!0,rulerStyle:{top:"30px",height:"calc(100% - 30px)",width:"100%"},useResizeObserver:!0}},wc={background:"#cdcdcd"},Sc={background:"#ffffff"},Ec={width:1920,height:800},Qt=52;class jc{constructor(t,n={}){B(this,"_showRuler");B(this,"_showGuidesLines");B(this,"canvasElement");B(this,"outerContainer");B(this,"innerContainer");B(this,"_content");B(this,"ruleConfig");B(this,"mouseScrollEvent");B(this,"layoutContainerStyle",wc);B(this,"layoutCanvasStyle",Sc);B(this,"lifecycle");B(this,"rule");B(this,"deviceType","pc");B(this,"prefixId","canvasLayout");B(this,"id",`${this.prefixId}OuterContainer`);B(this,"contentTop");B(this,"_scale",1);B(this,"onMounted",!1);B(this,"_size");B(this,"translateX",0);B(this,"translateY",0);B(this,"originTranslate",{translateX:0,translateY:0});B(this,"canvasOptions",{});var o,r,i,s;try{n.canvasZoomSwitch===void 0&&(n.canvasZoomSwitch=!0);const{zIndex:c=200,scale:l=1,size:u,showRuler:f,canvasElement:m,lifecycle:h,contentTop:v=0,ruleConfig:_=$o,canvasZoomSwitch:x}=n;this.canvasOptions={zIndex:200,scale:1,contentTop:0,ruleConfig:$o,...n},this.layoutContainerStyle=Object.assign(this.layoutContainerStyle,n.layoutContainerStyle||{}),this.layoutCanvasStyle=Object.assign(this.layoutCanvasStyle,n.layoutCanvasStyle||{}),this.ruleConfig=_,this.showRuler=f===void 0?!1:f,this.lifecycle=h,this.canvasElement=m,this.contentTop=v,this.scale=l,this.size=u||Ec,this.outerContainer=document.createElement("div"),this.outerContainer.setAttribute("id",this.id),this.outerContainer.style.width="100%",this.outerContainer.style.zIndex=String(c),this.outerContainer.style.height="100%",this.outerContainer.style.overflow="hidden",this.outerContainer.style.position="relative",this.outerContainer.style.background=this.layoutContainerStyle.background;const g=document.createElement("div"),y=document.createElement("div");this.innerContainer=y,y.style.display="block",y.style.width="calc(100% - 30px)",y.style.height="calc(100% - 30px)",y.style.position="relative",y.style.marginTop="30px",y.style.marginLeft="30px",y.setAttribute("id",`${this.prefixId}InnerContent`),this.content=g,g.setAttribute("id",`${this.prefixId}Content`),g.style.display="block",x?(g.style.transform=`translate(${this.translate.translateX}px, ${this.translate.translateY}px) scale(${this.scale})`,g.style.transition="transform 0s",g.style.transformOrigin="left top",g.style.width=`${this.size.width}px`,g.style.minHeight=`${this.size.height}px`,g.style.background=this.layoutCanvasStyle.background):(g.style.transition="transform 0s",g.style.width="100%",g.style.height="100%",g.style.background=this.layoutCanvasStyle.background),y.appendChild(g),this.outerContainer.appendChild(y),t.appendChild(this.outerContainer),mt.setContainerNoSelectCopy(this.outerContainer),mt.setOuterContainerStyle(this.outerContainer,this.id);let k,C=!1;x&&(this.mouseScrollEvent=new Ss(this.outerContainer,{content:this.content,mousemove:(N,j,P)=>{const p=window.requestAnimationFrame(()=>{var b,S;(S=(b=this.lifecycle)==null?void 0:b.onDrag)==null||S.call(b,this),C||(k=this.outerContainer.style.cursor,mt.setContainerCursor(this.outerContainer),C=!0),this.translate={translateX:this.originTranslate.translateX+j,translateY:this.originTranslate.translateY+P},this.updateCanvasContentTransform(),this.updateRulersPosition(this.translate.translateX,this.translate.translateY),window.cancelAnimationFrame(p)})},wheel:(N,j,P)=>{const p=window.requestAnimationFrame(()=>{var b,S;this.translate={translateX:this.originTranslate.translateX+j,translateY:this.originTranslate.translateY+P},this.updateCanvasContentTransform(),this.updateRulersPosition(this.translate.translateX,this.translate.translateY),(S=(b=this.lifecycle)==null?void 0:b.onDrag)==null||S.call(b,this),window.cancelAnimationFrame(p)})},mousedown:()=>{},resize:N=>{var j,P;this.onMounted&&(this.setSize(this.size.width,this.size.height),(P=(j=this.lifecycle)==null?void 0:j.resize)==null||P.call(j,N))},mouseup:()=>{C=!1,mt.removeContainerCursor(this.outerContainer,k)},mouseLeave:()=>{C=!1,mt.removeContainerCursor(this.outerContainer,k)}})),mt.hiddenScrollbar(this.outerContainer,`#${this.id}`),this.rule=this.initMaskRuler({horizontal:_.horizontal,vertical:_==null?void 0:_.vertical}),this.initContainer(),this.onMounted=!0,(r=(o=this.lifecycle)==null?void 0:o.onInitSuccess)==null||r.call(o,this)}catch(c){(s=(i=this.lifecycle)==null?void 0:i.onFailure)==null||s.call(i,c)}}get content(){return this._content}set content(t){this._content=t}get size(){return this._size}set size(t){var o,r;const n={...this._size};if(this._size={...t},(r=(o=this.lifecycle)==null?void 0:o.onSizeChange)==null||r.call(o,t,n),this.onMounted){const i=window.requestAnimationFrame(()=>{this.updateContentSize(t),window.cancelAnimationFrame(i)})}}get scale(){return this._scale}set scale(t){var n,o,r,i;if(this.canvasOptions.canvasZoomSwitch){const s=this._scale;if(this._scale=t,(o=(n=this.lifecycle)==null?void 0:n.onScaleChange)==null||o.call(n,t,s),this.onMounted){const c=window.requestAnimationFrame(()=>{this.updateContentScale(t),window.cancelAnimationFrame(c)})}}else{this._scale=1;const s=this._scale;(i=(r=this.lifecycle)==null?void 0:r.onScaleChange)==null||i.call(r,1,s)}}get showRuler(){return this._showRuler}set showRuler(t){var n,o;this._showRuler=t,this._showRuler?this.rule=this.initMaskRuler({horizontal:this.ruleConfig.horizontal,vertical:this.ruleConfig.vertical}):(o=(n=this.rule)==null?void 0:n.dispose)==null||o.call(n)}get showGuidesLines(){return this._showGuidesLines}set showGuidesLines(t){var n,o,r,i;this._showGuidesLines=t,t?(i=(r=this.rule)==null?void 0:r.loadGuidesLine)==null||i.call(r):(o=(n=this.rule)==null?void 0:n.clearGuidesLine)==null||o.call(n)}get translate(){return this.canvasOptions.canvasZoomSwitch?{translateX:this.translateX,translateY:this.translateY}:this.deviceType!=="pc"?{translateX:this.translateX,translateY:this.translateY}:{translateX:0,translateY:0}}set translate(t){this.canvasOptions.canvasZoomSwitch?(this.translateX=t.translateX,this.translateY=t.translateY):this.deviceType!=="pc"?(this.translateX=t.translateX,this.translateY=t.translateY):(this.translateX=0,this.translateY=0)}calculateScalingFactor(t,n,o,r,i=Qt){const s=o/r,c=t/n,l=t-2*i,u=n-2*i;let f=1;return s<c?f=u/r:f=l/o,f}updateRulersPosition(t,n){const o=-t,r=-n;this.rule.scrollHorizontalRuler(o),this.rule.scrollVerticalRuler(r)}updateCanvasContentTransform(){this.canvasOptions.canvasZoomSwitch&&(this.content.style.transform=`translate(${this.translate.translateX}px, ${this.translate.translateY}px) scale(${this.scale})`)}initContainer(){const{width:t,height:n}=this.size,o=this.innerContainer.clientWidth,r=Qt,i=this.innerContainer.clientHeight,s=this.calculateScalingFactor(o,i,t,n,r);this._scale=s;const c=t*s,l=o/2-c/2;this.translate={translateX:l,translateY:r},this.originTranslate={translateX:l,translateY:r},this.updateCanvasContentTransform(),this.updateRulersPosition(this.translate.translateX,this.translate.translateY)}setScale(t){this.scale=t}setDeviceType(t){if(this.deviceType=t,!this.canvasOptions.canvasZoomSwitch)if(t==="phone"){this.content.style.width=`${this.size.width}px`,this.content.style.margin="0 auto";const n=window.getComputedStyle(this.content),o=parseFloat(n.marginLeft);this.translate={translateX:o,translateY:0}}else this.content.style.width="100%"}setSize(t,n,o=!1){this.size={width:t,height:n}}toggleRuler(t){t===void 0?this.showRuler=!this.showRuler:this.showRuler=t}toggleRuleGuidesLine(t){t===void 0?this.showGuidesLines=!this.showGuidesLines:this.showGuidesLines=t}reset(){var f,m;const{width:t,height:n}=this.size,o=this.innerContainer.clientWidth,r=Qt,i=this.innerContainer.clientHeight,s=this.calculateScalingFactor(o,i,t,n,r),c=this.scale;this._scale=s,(m=(f=this.lifecycle)==null?void 0:f.onScaleChange)==null||m.call(f,s,c);const l=t*s,u=o/2-l/2;this.translate={translateX:u,translateY:r},this.originTranslate={translateX:u,translateY:r},this.updateCanvasContentTransform(),this.updateRulersPosition(this.translate.translateX,this.translate.translateY)}updateContentScale(t){const n=this.innerContainer.clientWidth,o=Qt,r=this.size.width*t,i=n/2-r/2;this.translate={translateX:i,translateY:o},this.originTranslate={translateX:i,translateY:o},this.updateCanvasContentTransform(),this.updateRulersPosition(this.translate.translateX,this.translate.translateY)}updateContentSize(t){this.canvasOptions.canvasZoomSwitch&&(this.content.style.width=t.width+"px",this.content.style.minHeight=t.height+"px",this.reset())}updateContentSizeVal(t){this.canvasOptions.canvasZoomSwitch&&(this.content.style.width=t.width+"px",this.content.style.minHeight=t.height+"px")}dispose(){var t,n,o,r;(n=(t=this.mouseScrollEvent)==null?void 0:t.dispose)==null||n.call(t),(r=(o=this.rule)==null?void 0:o.dispose)==null||r.call(o)}clearGuidesLine(){this.rule.clearGuidesLine()}render(t){return new Promise(async(n,o)=>{var r,i,s,c,l,u,f;try{const m=(r=document.getElementById(`${this.prefixId}Content`))==null?void 0:r.attachShadow({mode:"open"}),h=document.createElement("div"),v=document.createElement("style");v.textContent=`
                :host {
                    display: block;
                    height: 100%;
                }
                `,h.style.width="100%",h.style.height="100%",await t(h),(i=m==null?void 0:m.appendChild)==null||i.call(m,h),(s=m==null?void 0:m.appendChild)==null||s.call(m,v),(l=(c=this.lifecycle)==null?void 0:c.onCanvasRendered)==null||l.call(c,this),n(this)}catch(m){(f=(u=this.lifecycle)==null?void 0:u.onFailure)==null||f.call(u,m),o(m)}})}renderExtend(t){return new Promise(async(n,o)=>{var r,i;try{const s=document.createElement("div");await t(s),this.innerContainer.appendChild(s),n(this)}catch(s){(i=(r=this.lifecycle)==null?void 0:r.onFailure)==null||i.call(r,s),o(s)}})}initMaskRuler(t){return new bc(this.outerContainer,{width:Kr,horizontal:t.horizontal,vertical:t.vertical})}}class Pc{constructor(t,n,o={width:800,height:450},r={}){B(this,"canvasSdk");this.canvasSdk=new jc(t,{contentTop:120,size:o,lifecycle:n,ruleConfig:{horizontal:{backgroundColor:"#ffffff",textColor:"#505663",lineColor:"#838b99",displayDragPos:!0,rulerStyle:{left:"30px",width:"calc(100% - 30px)",height:"100%",zIndex:201},useResizeObserver:!0},vertical:{backgroundColor:"#ffffff",textColor:"#505663",lineColor:"#838b99",displayDragPos:!0,rulerStyle:{top:"30px",height:"calc(100% - 30px)",width:"100%",zIndex:201},useResizeObserver:!0}},...r})}}function Ao(e,t){if(e===t)return!0;for(var n=0;n<e.length;n++)if(!Object.is(e[n],t[n]))return!1;return!0}var Qr=!!(typeof window<"u"&&window.document&&window.document.createElement);function Un(e,t){if(Qr){if(!e)return t;var n;return Qi(e)?n=e():"current"in e?n=e.current:n=e,n}}var ei=function(e){var t=function(n,o,r){var i=d.useRef(!1),s=d.useRef([]),c=d.useRef([]),l=d.useRef();e(function(){var u,f=Array.isArray(r)?r:[r],m=f.map(function(h){return Un(h)});if(!i.current){i.current=!0,s.current=m,c.current=o,l.current=n();return}(m.length!==s.current.length||!Ao(s.current,m)||!Ao(c.current,o))&&((u=l.current)===null||u===void 0||u.call(l),s.current=m,c.current=o,l.current=n())}),er(function(){var u;(u=l.current)===null||u===void 0||u.call(l),i.current=!1})};return t},kc=ei(d.useEffect);function Nc(e){var t=d.useRef(0),n=eo(d.useState(e),2),o=n[0],r=n[1],i=d.useCallback(function(s){cancelAnimationFrame(t.current),t.current=requestAnimationFrame(function(){r(s)})},[]);return er(function(){cancelAnimationFrame(t.current)}),[o,i]}var Tc=ei(d.useLayoutEffect),Dc=Qr?Tc:kc;function zc(e){var t=eo(Nc(function(){var r=Un(e);return r?{width:r.clientWidth,height:r.clientHeight}:void 0}),2),n=t[0],o=t[1];return Dc(function(){var r=Un(e);if(r){var i=new Fi(function(s){s.forEach(function(c){var l=c.target,u=l.clientWidth,f=l.clientHeight;o({width:u,height:f})})});return i.observe(r),function(){i.disconnect()}}},[],e),n}function Mc(e,t){var n=eo(d.useState(e),2),o=n[0],r=n[1],i=Ct(function(){r(e)},t).run;return d.useEffect(function(){i()},[e]),o}const Oc="html::-webkit-scrollbar,body::-webkit-scrollbar{width:5px;height:5px}html::-webkit-scrollbar-track,body::-webkit-scrollbar-track{box-shadow:inset 0 0 #f0f0f080;border-radius:10px;background-color:#3232321a}html::-webkit-scrollbar-thumb,body::-webkit-scrollbar-thumb{bborder-radius:10px;box-shadow:inset 0 0 #f0f0f080;background-color:#3232324d}",Lc=`body,ol,ul,h1,h2,h3,h4,h5,h6,p,th,td,dl,dd,form,fieldset,legend,input,textarea,select{margin:0;padding:0} 
            body{font:12px"宋体","Arial Narrow",HELVETICA;background:#fff;-webkit-text-size-adjust:100%;} 
            a{color:#2d374b;text-decoration:none} 
            a:hover{color:#cd0200;text-decoration:underline} 
            em{font-style:normal} 
            li{list-style:none} 
            img{border:0;vertical-align:middle} 
            table{border-collapse:collapse;border-spacing:0} 
            p{word-wrap:break-word} 
            html, body { width: 100%; height: 100%; #testSandboxContainer {width: 100%; height: fit-content;}}`,Rc="var link = document.createElement('link');link.rel = 'stylesheet';link.type = 'text/css';link.href = 'https://at.alicdn.com/t/c/font_4440054_mrd2ueh02sj.css';var head = document.getElementsByTagName('head')[0];head.insertBefore(link, head.firstChild);";class Fc{constructor(t){B(this,"sandbox");var r,i;const{lifecycle:n,...o}=t;try{this.sandbox=new ji({callHost(...c){return console.log(...c),Promise.resolve(c)},callHostSync(...c){return console.log(...c),c}},{baseUrl:location.origin,allowedSenderOrigin:location.origin,...o}),this.sandbox.contentWindow.__building__=!0,this.sandbox.contentWindow.React=Xe,this.sandbox.contentWindow.ReactDOM=wi,D.initPreview(this.sandbox.contentWindow),this.sandbox.contentWindow.previewer=D.previewer;const s=new Ji;s.registerWindow(this.sandbox.contentWindow),this.sandbox.contentWindow.LogicflowRender={runner:s},this.sandbox.contentWindow.PageComponentDependency=D.previewer.componentDependencyLoader,(r=n.onInitSuccess)==null||r.call(n,this.sandbox),this.sandbox.injectStyle(Lc),this.sandbox.injectStyle(Pi),this.sandbox.injectStyle(Oc),this.sandbox.run(ki).then(()=>{this.sandbox.run(Rc).then(()=>{var c;(c=n.onCreatedPageFrame)==null||c.call(n,!0)})})}catch(s){console.log(s),(i=n==null?void 0:n.onFailure)==null||i.call(n,s)}}registerSandboxSyncApi(){this.sandbox.registerSandboxSyncServiceMethods({getSandboxLibStatus:function(t){return!!window[t]},createButton:function(){var o,r;const t=document.createElement("button");if(t.innerHTML="点击测试调用宿主机方法",t.addEventListener("click",async()=>{var s;console.log("点击了按钮");const i=await((s=window.Websandbox.connection)==null?void 0:s.remote.callHostSync("testMethod"));console.log(i)}),!document.querySelector("body")){const i=document.createElement("body");(o=document.querySelector("html"))==null||o.appendChild(i)}(r=document.querySelector("body"))==null||r.appendChild(t)}})}registerSandboxApi(){this.sandbox.registerSandboxServiceMethods({getUserInfo:function(t){return new Promise(n=>{setTimeout(()=>{n({name:"ssss",age:30,id:t})},2e3)})}})}}const Bo=cn({level:"info",bizName:"base-editor:useWebview"}),Ic=e=>{const t=d.useRef(),n=d.useRef(!1),o=d.useRef(),[r,i]=d.useState(!0);return d.useEffect(()=>{(async()=>n.current||(o.current=new Fc({lifecycle:{onFailure:s=>{console.log(s)},onInitSuccess:s=>{Bo.log("画布webview 加载成功",s),D.registerSandbox(s)},onCreatedPageFrame:s=>{var c;i(!1),Bo.log("画布webview 内部的画布加载完毕"),(c=e==null?void 0:e.onInitSuccess)==null||c.call(e),D.onCreatedPageFrameSuccess(o.current),i(!1)}},frameContainer:t.current}),n.current=!0))()},[]),{frameContainer:t,loading:r,lowcodeEditorSandbox:o}},$c="index-module__iframeContainerContent___qVeTo",Ac={iframeContainerContent:$c},Bc=e=>{const{frameContainer:t}=Ic(e);return a.jsx(a.Fragment,{children:a.jsx("div",{className:Ac.iframeContainerContent,ref:t,style:{width:"100%",height:"100%"}})})};D.editorStore;const Vc=d.createContext(D.editorStore);function Gc(){return d.useContext(Vc)}D.stackHistory;const Yc=d.createContext(D.stackHistory);function Hc(){return d.useContext(Yc)}const de=Gc,Xc=Hc;if(!d.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!Xi)throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");function Wc(e){e()}function Uc(e){e||(e=Wc),Wi({reactionScheduler:e})}function qc(e){return Ui(e)}var Zc=1e4,Jc=1e4,Kc=function(){function e(t){var n=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(o){o===void 0&&(o=Zc),clearTimeout(n.sweepTimeout),n.sweepTimeout=void 0;var r=Date.now();n.registrations.forEach(function(i,s){r-i.registeredAt>=o&&(n.finalize(i.value),n.registrations.delete(s))}),n.registrations.size>0&&n.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){n.sweep(0)}})}return Object.defineProperty(e.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(t,n,o){this.registrations.set(o,{value:n,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(e.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(t){this.registrations.delete(t)}}),Object.defineProperty(e.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.sweepTimeout===void 0&&(this.sweepTimeout=setTimeout(this.sweep,Jc))}}),e}(),Qc=typeof FinalizationRegistry<"u"?FinalizationRegistry:Kc,qn=new Qc(function(e){var t;(t=e.reaction)===null||t===void 0||t.dispose(),e.reaction=null});function Vo(e){e.reaction=new qi("observer".concat(e.name),function(){var t;e.stateVersion=Symbol(),(t=e.onStoreChange)===null||t===void 0||t.call(e)})}function el(e,t){t===void 0&&(t="observed");var n=Xe.useRef(null);if(!n.current){var o={reaction:null,onStoreChange:null,stateVersion:Symbol(),name:t,subscribe:function(c){return qn.unregister(o),o.onStoreChange=c,o.reaction||(Vo(o),o.stateVersion=Symbol()),function(){var l;o.onStoreChange=null,(l=o.reaction)===null||l===void 0||l.dispose(),o.reaction=null}},getSnapshot:function(){return o.stateVersion}};n.current=o}var r=n.current;r.reaction||(Vo(r),qn.register(n,r,r)),Xe.useDebugValue(r.reaction,qc),es.useSyncExternalStore(r.subscribe,r.getSnapshot,r.getSnapshot);var i,s;if(r.reaction.track(function(){try{i=e()}catch(c){s=c}}),s)throw s;return i}var Sn,En,ti=typeof Symbol=="function"&&Symbol.for,tl=(En=(Sn=Object.getOwnPropertyDescriptor(function(){},"name"))===null||Sn===void 0?void 0:Sn.configurable)!==null&&En!==void 0?En:!1,Go=ti?Symbol.for("react.forward_ref"):typeof d.forwardRef=="function"&&d.forwardRef(function(e){return null}).$$typeof,Yo=ti?Symbol.for("react.memo"):typeof d.memo=="function"&&d.memo(function(e){return null}).$$typeof;function ze(e,t){var n;if(Yo&&e.$$typeof===Yo)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");var o=(n=void 0)!==null&&n!==void 0?n:!1,r=e,i=e.displayName||e.name;if(Go&&e.$$typeof===Go&&(o=!0,r=e.render,typeof r!="function"))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var s=function(c,l){return el(function(){return r(c,l)},i)};return s.displayName=e.displayName,tl&&Object.defineProperty(s,"name",{value:e.name,writable:!0,configurable:!0}),e.contextTypes&&(s.contextTypes=e.contextTypes),o&&(s=d.forwardRef(s)),s=d.memo(s),ol(e,s),s}var nl={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};function ol(e,t){Object.keys(e).forEach(function(n){nl[n]||Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}var jn;Uc(Si.unstable_batchedUpdates);jn=qn.finalizeAllImmediately;const rl=e=>ze(e),ut=rl,il="index-module__tools___aNFFa",sl="index-module__name___mYRap",Ho={tools:il,name:sl},al=e=>{var t;return a.jsx("div",{style:e.style,className:Ho.tools,children:a.jsx("span",{className:Ho.name,children:(t=e.node)==null?void 0:t.alias})})},cl="index-module__tools___s2PuT",ll="index-module__name___0DM0q",Xo={tools:cl,name:ll},ul="index-module__canvas_borders_actions___xi7DX",dl="index-module__canvas_borders_action___4H7wk",fl="index-module__canvas_borders_actions_off___zE4Fi",Pn={canvas_borders_actions:ul,canvas_borders_action:dl,canvas_borders_actions_off:fl},hl=ze(e=>{const t=de(),{editorSchemaState:n,editorUIState:o}=t,{selectNodeCode:r,schema:i}=n,{adaptiveCanvasSize:s}=o,c=d.useMemo(()=>Lt((i==null?void 0:i.componentsTree)||[],r),[i,r]),l=[{icon:"icon-shoucang1",name:"收藏",show:()=>!0,callback:()=>{var u;console.log("收藏",c),(u=e.collect)==null||u.call(e)}},{icon:"icon-fuzhi",show:()=>!0,name:"复制",callback:async()=>{console.log("复制",c);try{await D.copyNode(c.id),U.success("复制成功")}catch(u){console.log(u),U.error("'复制失败")}}},{icon:"icon-shangyi1",name:"上移",show:()=>!1,callback:()=>{var u;console.log("上移",c),(u=e.up)==null||u.call(e)}},{icon:"icon-xiayi",name:"下移",show:()=>!1,callback:()=>{var u;console.log("下移",c),(u=e.down)==null||u.call(e)}},{icon:"icon-shanchu1",name:"删除",show:()=>!0,callback:()=>{var u;Ie.confirm({title:"温馨提示",content:"确认删除该组件吗？删除后您配置的该组件的数据将无法恢复",okText:"确认删除",cancelText:"取消",onOk:async()=>{try{await D.deleteNode(c.id),U.success("删除成功")}catch(f){console.log(f),U.error("删除失败")}},onCancel:()=>{U.error("删除取消")}}),(u=e.del)==null||u.call(e)}}];return a.jsx("div",{className:Y(Pn.canvas_borders_actions,{[Pn.canvas_borders_actions_off]:!s}),style:{opacity:c!=null&&c.componentType.includes("Page")?0:1},children:l.map((u,f)=>u.show()?a.jsx("div",{className:Pn.canvas_borders_action,onClick:u.callback,children:a.jsx(De,{title:a.jsx(a.Fragment,{children:u.name}),placement:s?"right":"top",children:a.jsx("i",{className:`iconfont ${u.icon}`})})},`${u.name}_${f}`):null)})}),ml=e=>{var t;return e.node?a.jsxs("div",{style:e.style,className:Xo.tools,children:[a.jsx("span",{className:Xo.name,children:(t=e.node)==null?void 0:t.alias}),a.jsx(hl,{})]}):null},vl=ze(e=>{const t=de(),{editorSchemaState:n}=t,{componentSelectedStyle:o,componentHoverStyle:r,selectNodeCode:i,hoverNodeCode:s,schema:c}=n,l=d.useMemo(()=>Lt((c==null?void 0:c.componentsTree)||[],i),[c,i]),u=d.useMemo(()=>Lt((c==null?void 0:c.componentsTree)||[],s),[c,s]);return a.jsxs(a.Fragment,{children:[a.jsx(al,{node:u,style:s&&s!==i?xt(r):{opacity:0}}),a.jsx(ml,{node:l,style:i?xt(o):{}})]})}),Wo=cn({level:"info",bizName:"base-editor:useCanvasInit"}),_l=e=>{const t=d.useRef(!1),n=d.useRef(),o=d.useRef(!1),r=d.useRef(),i=d.useRef(!1),s=de(),{setZoom:c,updateStageContainerRect:l,stageContainerRect:u,adaptiveCanvasSize:f}=s.editorUIState;return d.useEffect(()=>{(async()=>i.current||(n.current=new Pc(r.current,{onScaleChange:(m,h)=>{D.optimisticUpdateComponentPositionThrottled(),D.updateComponentToolsThrottled()},onDrag:m=>{D.updateComponentToolsThrottled(),D.optimisticUpdateComponentPositionThrottled()},onSizeChange:(m,h)=>{l({width:m.width,height:m.height}),D.updateComponentToolsThrottled(),D.optimisticUpdateComponentPositionThrottled()},onInitSuccess:m=>{D.registerCanvas(m),m.render(h=>new Promise((v,_)=>{t.current||(Wo.log("canvas 容器加载成功 开始注册画布内容, 加载webview"),Co(h).render(a.jsx(Bc,{onInitSuccess:e.onInitSuccess})),t.current=!0),v(!0)})).then(h=>{}),m.renderExtend(h=>new Promise((v,_)=>{o.current||(Co(h).render(a.jsx(vl,{})),o.current=!0),v(!0)})).then(h=>{})},onFailure:m=>{Wo.error("画布渲染出现错误",m)},onCanvasRendered:m=>{c((m==null?void 0:m.scale)*100)}},{width:u.width,height:u.height},{canvasZoomSwitch:f}),i.current=!0))()},[]),{canvasContainer:r}},gl=e=>{const{canvasContainer:t}=_l(e);return a.jsx("div",{style:{height:"100%",width:"100%"},children:a.jsx("div",{style:{height:"100%",width:"100%"},ref:t})})},pl="index-module__params_panel___hGl8C",yl="index-module__content_container___4UvYR",xl="index-module__params_control_container___493WR",Cl="index-module__header___oWczx",bl="index-module__configContent___FhxiH",wl="index-module__content_flow_container___hyb2v",jt={params_panel:pl,content_container:yl,params_control_container:xl,header:Cl,configContent:bl,content_flow_container:wl},Sl=()=>{const[e,t]=U.useMessage();return{success:i=>e.open({type:"success",content:i}),error:i=>{U.error(i)},warning:i=>e.open({type:"warning",content:i})}},El="index-module__empty_container___Ln5Lx",jl={empty_container:El},Pl="index-module__empty_container___GyUxv",kl="index-module__configContainer___vPZBK",Nl={empty_container:Pl,configContainer:kl},Tl={},ni=d.forwardRef((e,t)=>{const{showFlowConfig:n,graphData:o,maskClosable:r=!0}=e,i=d.useRef(),[s,c]=Ie.useModal(),{editorSchemaState:l}=de(),{schema:u,getRunTimeConstantsList:f,getVariableStateList:m,getVariableMethodsList:h}=l,[v,_]=d.useState(gt.pageLifeCycleNodes||[]),[x,g]=d.useState(gt.pageUtilsNodes||[]),[y,k]=d.useState(gt.conditionUtilsNodes||[]),[C,N]=d.useState(gt.stateNodes||[]);d.useImperativeHandle(t,()=>({getData:()=>{var S,E,H;const b=(E=(S=i.current)==null?void 0:S.getFlowCore())==null?void 0:E.lf;return(H=b==null?void 0:b.getGraphRawData)==null?void 0:H.call(b)},updatePageLifeCycleNodes:b=>(_(b),!0),updatePageUtilsNodes:b=>(g(b),!0),updateConditionUtilsNodes:b=>(k(b),!0),updateStateNodes:b=>(N(b),!0)}));const j=async()=>{var b;(b=e==null?void 0:e.closeDrawer)==null||b.call(e)},P=b=>{var S;console.log(b),(S=e==null?void 0:e.onLogicPanelInit)==null||S.call(e,b)},p=d.useMemo(()=>({pageLifeCycleNodes:v,pageUtilsNodes:x,conditionUtilsNodes:y,stateNodes:C,componentsTree:u.componentsTree||[],defaultConfig:gt.defaultConfig,variableProvideConfig:{pageStates:async()=>await m(),pageMethods:async()=>await h(),systemDevice:async()=>{const b=await(f==null?void 0:f());return(b==null?void 0:b.device)||[]},systemRouterParams:async()=>{const b=await(f==null?void 0:f());return(b==null?void 0:b.router)||[]}}}),[v]);return a.jsxs(ro,{mask:!0,destroyOnClose:!0,styles:{header:{display:"none"},body:{padding:8}},maskClosable:r,title:"Basic Drawer",className:Tl.drawer,onClose:j,push:{distance:0},width:"70%",open:n,children:[c,a.jsx(rr,{onInit:P,ref:i,graphData:o||{nodes:[],edges:[]},renderRefInstance:()=>{var b,S;return(S=(b=D)==null?void 0:b.previewer)==null?void 0:S.renderRef},config:p,viewAuth:{toolsControl:!0,nodeList:!0}})]})}),Dl={SetterForm:cr,StringSetter:lr,NumberSetter:ur,RadioSetter:dr,SingleSelectSetter:fr,MultipleSelectSetter:hr,BooleanSetter:mr,ColorSetter:vr,DateSetter:_r,TimeSetter:gr,ArraySetter:pr,ArrayObjectSetter:yr,ObjectSetter:xr,SlotSetter:Cr,EventSetter:br,DateTimeSetter:wr,CheckboxSetter:Sr,ImageSetter:Er,FileSetter:jr},zl=ze(d.forwardRef((e,t)=>{var ve;const n=de(),{editorSchemaState:o}=n,r=d.useRef(!0),i=()=>{var G;return Object.assign({},((G=e.selectNode)==null?void 0:G.props)||{})};d.useImperativeHandle(t,()=>({renderSchema:()=>Promise.resolve(),emptySchema:()=>Promise.resolve(),setFormValue:async(G,R)=>{var K;return r.current=!1,s.setFieldsValue((K=R.schema)==null?void 0:K.props),Promise.resolve(!0)}}));const[s]=pe.useForm(),{run:c}=Ii(G=>{console.log("last run updatePreviewerProps",G),e.onChange(G)},{wait:250}),[l,u]=d.useState(""),[f,m]=Ie.useModal(),[h,v]=d.useState(null),[_,x]=d.useState({}),g=d.useRef(),y=d.useRef(),{getVariableStateList:k,getVariableMethodsList:C}=o,[N,j]=d.useState({nodes:[],edges:[]}),P=d.useRef(),[p,b]=d.useState(!1),[S,E]=d.useState(!0),H=d.useMemo(()=>{var G,R;return!((G=e==null?void 0:e.schema)!=null&&G.schema)||(((R=e.schema)==null?void 0:R.schema)||[]).length===0},[e]),M=d.useMemo(()=>{var R;const G=(((R=e.schema)==null?void 0:R.schema)||[]).filter(K=>!["SlotSetter"].includes(K==null?void 0:K.componentName));return Ke({componentName:"Component",fileName:"test",props:{},children:[{componentName:"SetterForm",props:{formProps:{form:s,layout:"vertical",initialValues:h},initialValues:h,onValuesChange:(K,ie)=>{c(ie),x(ie)},onFieldsChange:(K,ie)=>{}},children:G.map(K=>(K.id||(K.id=oo(),K.key=K.id),K))}]})},[l,h,(ve=e.schema)==null?void 0:ve.schema,s]),W=d.useRef(),ee=(G,R,K)=>{var oe,se,_e;g.current=K,y.current=R;const{type:ie,value:ne}=R||{};if(ie&&ne){if(ne==="JSExpression")return void((oe=W==null?void 0:W.current)==null?void 0:oe.open(ie,ne,G));(se=W==null?void 0:W.current)==null||se.open(ie,ne,G)}else(_e=W==null?void 0:W.current)==null||_e.open("JSExpression","",G)},te=d.useRef(),F=d.useRef(),$=d.useRef(),L=async(G,R,K)=>{var ne;F.current=G;const ie=async()=>{E(!0),j({nodes:[],edges:[]}),b(!0),$.current=await D.flowService.createFlowId()};if((!R||typeof R=="string")&&(await ie(),te.current={type:"JSFunction",value:"",sourceCode:"",flowIdList:[]}),Eo(R))if(te.current={flowIdList:[],...R},!R.flowIdList||!((ne=R==null?void 0:R.flowIdList)!=null&&ne.length))await ie();else{$.current=R.flowIdList[0],E(!1),console.log($.current);const oe=await D.flowService.getFlowData($.current);console.log("nodeData",oe),oe?(j((oe==null?void 0:oe.data)||{nodes:[],edges:[]}),$.current=oe==null?void 0:oe.code,b(!0)):(U.warning("当前绑定的流程未查询到"),E(!0),j({nodes:[],edges:[]}),b(!0))}},X=async()=>{var R,K,ie,ne,oe,se,_e;const G=(K=(R=P==null?void 0:P.current)==null?void 0:R.getData)==null?void 0:K.call(R);if(console.log("data",G),console.log("currentEditFlowConfig.current",te.current),console.log("currentEditPath.current",F.current),console.log("editorSchemaState?.selectComp",o==null?void 0:o.selectComp),b(!1),$.current)if(S){if(await f.confirm({title:"温馨提示",okText:"确认",cancelText:"取消",content:a.jsx(a.Fragment,{children:"是否保存此次编排的流程？"})})){const Pe=$.current,Be=((ie=o==null?void 0:o.selectComp.schema)==null?void 0:ie.props)||{};te.current&&((ne=te.current.flowIdList)==null||ne.push(Pe),te.current.flowIdList=ts((oe=te.current)==null?void 0:oe.flowIdList));const Ve=await D.flowService.updateObjectFlowIdList(Be,F.current,te.current);await D.flowService.createFlow({code:Pe,name:((_e=(se=G==null?void 0:G.nodes[0])==null?void 0:se.properties)==null?void 0:_e.label)||"流程",data:G}),console.log(Ve),console.log("newProps");const nt=typeof F.current=="string"?[F.current]:F.current;console.log("fields",nt),s.setFieldValue(nt,te.current),c(s.getFieldsValue())}}else{const ae=await D.flowService.getFlowData($.current),{data:Pe}=ae||{};if((Pe&&G&&JSON.stringify(G)!==JSON.stringify(Pe)||G&&!Pe)&&await f.confirm({title:"温馨提示",okText:"确认",cancelText:"取消",content:a.jsx(a.Fragment,{children:"是否保存此次编排的流程？"})})){const Ve=ae.name;console.log("不是新增的"),await D.flowService.createFlow({code:$.current,name:Ve,data:G}),c(s.getFieldsValue())}}else console.warn("currentEditFlowId.current 为空")},T=async G=>{var R,K,ie,ne,oe;if((K=(R=P==null?void 0:P.current)==null?void 0:R.updatePageLifeCycleNodes)==null||K.call(R,[]),S){console.log("新创建",G);const se=gt.defaultConfig.component;if((ie=o.selectComp.schema)!=null&&ie.id){const _e={type:se.__config__.type,properties:{...se,__config__:{...se.__config__,correlationId:(oe=(ne=o==null?void 0:o.selectComp)==null?void 0:ne.schema)==null?void 0:oe.id},logo:se.logo},callback:()=>{console.log("insert successful")}};G.graph.addFlowNode(_e,{defaultSelectNode:!0,isFocusOn:!0}),console.log(_e)}}},V=(G,R,K)=>{const{key:ie,...ne}=R,oe=!!(R!=null&&R.formProps&&!(R!=null&&R.formItemProps));return R.__createElement=V,a.jsx(Pr,{...ne,form:s,isFormContainer:oe,initialValues:h,onBind:ee,onFlowBind:L,showCodeFormat:!0,children:a.jsx(G,{...ne,__createElement:V,form:s,children:Xe.Children.toArray(K).map(se=>Xe.isValidElement(se)?Xe.cloneElement(se,{}):se)})})},A=d.useMemo(()=>({schema:M,components:Dl,customCreateElement:V,designMode:"live"}),[M,l]),J=d.useMemo(()=>a.jsx(sr,{...A}),[l]),Q=d.useMemo(()=>a.jsx("div",{style:{},children:J}),[l]),re=async G=>G==="JSExpression"?await k()||[]:G==="JSFunction"?await C()||[]:[],le=G=>{const R=_[G]||y.current;return So(R)?(R==null?void 0:R.mock)||void 0:R},bt=(G,R)=>new Promise(K=>{var oe,se;const ie=R.value,ne=(se=(oe=g==null?void 0:g.current)==null?void 0:oe.formItemProps)==null?void 0:se.name;if(ne&&ie){const _e={type:G,value:ie,sourceCode:R.sourceCode,mock:le(ne)},ae=typeof ne=="string"?[ne]:ne;s.setFieldValue(ae,_e),c(s.getFieldsValue())}K(!0)}),I=G=>new Promise(R=>{var ie,ne;const K=((ne=(ie=g==null?void 0:g.current)==null?void 0:ie.formItemProps)==null?void 0:ne.name)||G;if(K){const oe=_[K]||y.current,se=So(oe)||Eo(oe)?oe.mock:oe,_e=typeof K=="string"?[K]:K;s.setFieldValue(_e,se),console.log("移除",_e,se,s.getFieldsValue()),c(s.getFieldsValue())}R(!0)});return d.useEffect(()=>{var G,R;(G=e==null?void 0:e.selectNode)!=null&&G.id?u((R=e==null?void 0:e.selectNode)==null?void 0:R.id):u("")},[e==null?void 0:e.selectNode]),d.useEffect(()=>{r.current=!1,s.setFieldsValue({}),s.resetFields(),l?setTimeout(()=>{r.current=!0;const G=i();console.log("init",G),v(G||{}),s.setFieldsValue(G||{})},0):v(null)},[l]),a.jsxs("div",{className:Nl.configContainer,children:[m,H?a.jsx(We,{}):Q,a.jsx(ar,{title:"绑定",ref:W,getVariableList:re,onBoundSuccess:bt,onBoundRemove:I}),a.jsx(ni,{maskClosable:!0,ref:P,isNewCreate:S,graphData:N,showFlowConfig:p,closeDrawer:X,onLogicPanelInit:T})]})})),Ml="index-module__empty_container___MOf3W",Ol="index-module__configContainer___P1OID",Uo={empty_container:Ml,configContainer:Ol},Ll={SetterForm:cr,StringSetter:lr,NumberSetter:ur,RadioSetter:dr,SingleSelectSetter:fr,MultipleSelectSetter:hr,BooleanSetter:mr,ColorSetter:vr,DateSetter:_r,TimeSetter:gr,ArraySetter:pr,ArrayObjectSetter:yr,ObjectSetter:xr,SlotSetter:Cr,EventSetter:br,DateTimeSetter:wr,CheckboxSetter:Sr,ImageSetter:Er,FileSetter:jr},Rl=ze(d.forwardRef((e,t)=>{var F,$;const n=de(),{editorSchemaState:o}=n,{getVariableStateList:r,getVariableMethodsList:i}=o,s=d.useRef(!0),c=d.useRef(!1),l=d.useRef(),[u]=pe.useForm();l.current||(l.current=u);const f=(l==null?void 0:l.current)||u,m=()=>{var V,A;const L=Object.assign({},((V=e.selectNode)==null?void 0:V.props)||{}),X=(((A=e.schema)==null?void 0:A.schema)||[]).filter(J=>["EventSetter"].includes(J==null?void 0:J.componentName)),T={};return X.forEach(J=>{const Q=J.props.formItemProps.name;T[Q]=L[Q]}),T};d.useImperativeHandle(t,()=>({renderSchema:()=>Promise.resolve(),emptySchema:()=>Promise.resolve(),setFormValue:async(L,X)=>{var T;return s.current=!1,f.setFieldsValue((T=X.schema)==null?void 0:T.props),Promise.resolve(!0)}}));const{run:h}=Ct(L=>{e.onChange(L)},{wait:250});pe.useWatch(L=>{c.current&&(s.current?h(L):s.current=!0)},{form:f});const[v,_]=d.useState(""),[x,g]=d.useState(null),[y,k]=d.useState({}),C=d.useRef(),N=d.useRef(),j=d.useMemo(()=>{var X;const L=(((X=e.schema)==null?void 0:X.schema)||[]).filter(T=>["EventSetter"].includes(T==null?void 0:T.componentName));return Ke({componentName:"Component",fileName:"test122",props:{},children:[{componentName:"SetterForm",props:{formProps:{form:f,layout:"vertical",initialValues:{...m()}},initialValues:{...m()},onValuesChange:(T,V)=>{k(V)},onFieldsChange:(T,V)=>{}},children:L.map(T=>(T.id||(T.id=oo(),T.key=T.id),T))}]})},[v,(F=e.schema)==null?void 0:F.schema]),P=d.useRef(),p=(L,X,T)=>{var J,Q,re;C.current=T,N.current=X;const{type:V,value:A}=X||{};if(V&&A){if(A==="JSExpression")return void((J=P==null?void 0:P.current)==null?void 0:J.open(V,A,[]));(Q=P==null?void 0:P.current)==null||Q.open(V,A,[])}else(re=P==null?void 0:P.current)==null||re.open("JSFunction","",[])},b=(L,X,T)=>{const{key:V,showCodeFormat:A,...J}=X,Q=!!(X!=null&&X.formProps&&!(X!=null&&X.formItemProps));return X.__createElement=b,a.jsx(Pr,{...J,form:f,isFormContainer:Q,initialValues:x,onBind:p,showCodeFormat:!1,children:a.jsx(L,{...J,__createElement:b,form:f,children:Xe.Children.toArray(T).map(re=>Xe.isValidElement(re)?Xe.cloneElement(re,{}):re)})})},S=d.useMemo(()=>({schema:j,components:Ll,customCreateElement:b,designMode:"live"}),[j,v]),E=d.useMemo(()=>a.jsx(sr,{...S}),[v]),H=d.useMemo(()=>a.jsx("div",{style:{},children:E}),[v]),M=async L=>L==="JSExpression"?await r()||[]:L==="JSFunction"?await i()||[]:[],W=(L,X)=>new Promise(T=>{var J,Q;const V=X.value,A=(Q=(J=C==null?void 0:C.current)==null?void 0:J.formItemProps)==null?void 0:Q.name;if(A&&V){const re={type:L,value:V,mock:null,name:X.name};f.setFieldValue(A,re)}T(!0)}),ee=()=>new Promise(L=>{var T,V;const X=(V=(T=C==null?void 0:C.current)==null?void 0:T.formItemProps)==null?void 0:V.name;X&&f.setFieldValue(X,void 0),L(!0)});return d.useEffect(()=>{var L,X;(L=e==null?void 0:e.selectNode)!=null&&L.id?_((X=e==null?void 0:e.selectNode)==null?void 0:X.id):_("")},[e==null?void 0:e.selectNode]),d.useEffect(()=>{if(c.current=!1,f.setFieldsValue({}),f.resetFields(),v){const L=m();g(L||{}),f.setFieldsValue(L||{})}else g(null);c.current=!0},[v]),d.useMemo(()=>{var X;return(((X=e.schema)==null?void 0:X.schema)||[]).filter(T=>["EventSetter"].includes(T==null?void 0:T.componentName)).length===0},[($=e.schema)==null?void 0:$.schema])?a.jsx("div",{className:Uo.empty_container,children:a.jsx(We,{description:!1})}):a.jsxs("div",{className:Uo.configContainer,children:[H,a.jsx(ar,{title:"绑定",variableTypeList:[{name:"自定义处理函数",value:"JSFunction"}],ref:P,getVariableList:M,onBoundSuccess:W,onBoundRemove:ee})]})})),kn=[{value:"BIZ_CONFIG",label:"扩展属性"},{value:"STYLE_CONFIG",label:"组件样式"}],Fl=ze(d.forwardRef((e,t)=>{const n=de(),{editorSchemaState:o}=n,{selectNodeCode:r,componentInfoResponse:i,schema:s,selectComp:c}=o,l=d.useMemo(()=>Lt((s==null?void 0:s.componentsTree)||[],r),[s,r]),{configRenderPanel:u}=c||{},{defaultType:f}=e,[m,h]=d.useState(f),v=d.useRef(),_=d.useRef(),x=d.useRef(),{error:g}=Sl();d.useImperativeHandle(t,()=>({setFormValue:async(P,p)=>{var b,S,E,H,M,W;try{(S=(b=v==null?void 0:v.current)==null?void 0:b.setFormValue)==null||S.call(b,P,p),(W=(E=x==null?void 0:x.current)==null?void 0:E.updateValue)==null||W.call(E,((M=(H=p.schema)==null?void 0:H.props)==null?void 0:M.style)||{})}catch(ee){console.log(ee)}return Promise.resolve(!0)}}));const y=async()=>{var P,p;if(!l)return g("系统错误");(p=(P=x==null?void 0:x.current)==null?void 0:P.updateValue)==null||p.call(P,(l==null?void 0:l.style)||{})};d.useEffect(()=>{r&&y().then(()=>{})},[r]);const{run:k}=Ct(P=>new Promise(async p=>{const b=await D.commitModal(P);p(b)}),{wait:40}),{run:C}=Ct(P=>new Promise(async p=>{const b=await D.commitStyle(P);p(b)}),{wait:40});d.useEffect(()=>{h(f)},[f]);const N=d.useMemo(()=>!r||!i.version,[r,i]),j=()=>{var P;switch(m){case"BIZ_CONFIG":return c.schema?a.jsx(zl,{schema:u==null?void 0:u.schema,selectNode:c.schema,ref:v,onChange:async p=>{k(p)}}):null;case"EVENT":return c.schema?a.jsx(Rl,{schema:u==null?void 0:u.schema,selectNode:c.schema,ref:_,onChange:async p=>{k(p)}}):null;case"STYLE_CONFIG":return a.jsx(kr,{onRef:p=>{x.current=p},isShowCssCode:!1,value:((P=l==null?void 0:l.props)==null?void 0:P.style)||{},onChange:async p=>{await C(p)},placeholder:""});default:return null}};return a.jsxs(a.Fragment,{children:[!N&&j(),N&&a.jsx("div",{className:jl.empty_container,children:a.jsx(We,{description:!1})})]})})),Il="index-module__flow_container_list___PvbOM",$l="index-module__flow_container_list_item___scs4i",Al="index-module__left___HMpxt",Bl="index-module__update___p72uI",Vl="index-module__name___uARY3",Gl="index-module__handler___FViMY",Yl="index-module__clear___ygxGt",Hl="index-module__empty_container___EqCXg",Xl={flow_container_list:Il,flow_container_list_item:$l,left:Al,update:Bl,name:Vl,handler:Gl,clear:Yl,empty_container:Hl},Nn=[{value:"STYLE_CONFIG",label:"页面样式"}],Wl=ze(d.forwardRef((e,t)=>{const{defaultType:n}=e,o=de(),{editorSchemaState:r}=o,{selectNodeCode:i,schema:s}=r,c=d.useMemo(()=>Lt((s==null?void 0:s.componentsTree)||[],i),[s,i]),[l,u]=d.useState(e.defaultType||"GLOBAL_CONFIG"),f=d.useRef(),m=d.useMemo(()=>!!c,[c]);d.useEffect(()=>{u(n)},[n]),d.useImperativeHandle(t,()=>({setFormValue:async(v,_)=>{var x,g;try{const y=$i(v,"componentsTree[0].props.style");(g=(x=f==null?void 0:f.current)==null?void 0:x.updateValue)==null||g.call(x,y||{})}catch(y){console.log(y)}return Promise.resolve(!0)}}));const h=()=>{switch(l){case"STYLE_CONFIG":return a.jsx(kr,{showModuleList:["background","layout"],onRef:v=>{f.current=v},isShowCssCode:!1,value:{},onChange:async v=>{var _;(_=e==null?void 0:e.pageUpdateCssText)==null||_.call(e,v)},placeholder:""});default:return null}};return a.jsxs(a.Fragment,{children:[!m&&h(),m&&a.jsx("div",{className:Xl.empty_container,children:a.jsx(We,{description:!1})})]})})),Ul=()=>a.jsx("div",{}),ql=ze(()=>{const e=de(),{editorSchemaState:t}=e,[n,o]=d.useState("100%"),[r,i]=d.useState("PAGE"),[s,c]=d.useState(kn[0].value),[l,u]=d.useState(Nn[0].value),f=d.useRef(null);d.useEffect(()=>{var N;((N=f==null?void 0:f.current)==null?void 0:N.getBoundingClientRect()).top&&o("100%")},[]);const m=d.useRef(),h=d.useRef(),v=async C=>new Promise(async N=>{try{const j=t.schema,P=Ke(j);ns(j,"componentsTree[0].props.style",C),D.updateSchema(j,{recordLog:!0,oldValue:P}),N(!0)}catch(j){console.log(j),N(!0)}}),_=C=>{i(C),C==="PAGE"&&u(Nn[0].value),C==="COMP"&&c(kn[0].value)},x=C=>{c(C)},g=C=>{u(C)};d.useEffect(()=>{const C=Ai.subscribe(N=>{i("COMP"),c("BIZ_CONFIG")});return()=>{C.unsubscribe()}},[]),d.useEffect(()=>{const C=async(j,P)=>{var p,b,S,E;return(b=(p=m==null?void 0:m.current)==null?void 0:p.setFormValue)==null||b.call(p,j,P),(E=(S=h==null?void 0:h.current)==null?void 0:S.setFormValue)==null||E.call(S,j,P),Promise.resolve(!0)},N=async(j,P)=>{var p,b,S,E;return(b=(p=m==null?void 0:m.current)==null?void 0:p.setFormValue)==null||b.call(p,j,P),(E=(S=h==null?void 0:h.current)==null?void 0:S.setFormValue)==null||E.call(S,j,P),Promise.resolve(!0)};return D.stackHistory.registerLifecycle({go:C,back:N}),()=>{D.stackHistory.unregisterLifecycle({go:C,back:N})}},[]);const y=()=>r==="COMP"?a.jsx(a.Fragment,{children:a.jsx(Fe.Group,{value:s,buttonStyle:"solid",onChange:C=>{x(C.target.value)},children:kn.map(C=>a.jsx(Fe.Button,{value:C.value,children:C.label},C.value))})}):r==="PAGE"?a.jsx(a.Fragment,{children:a.jsx(Fe.Group,{value:l,buttonStyle:"solid",onChange:C=>{g(C.target.value)},children:Nn.map(C=>a.jsx(Fe.Button,{value:C.value,children:C.label},C.value))})}):null,k=()=>r==="COMP"?a.jsx(a.Fragment,{children:a.jsx(Fl,{defaultType:s,ref:m})}):r==="PAGE"?a.jsx(Wl,{pageUpdateCssText:v,defaultType:l,ref:h}):null;return a.jsx(a.Fragment,{children:a.jsxs("div",{className:jt.params_panel,ref:f,style:{height:n},children:[a.jsx("div",{className:jt.header,children:a.jsxs(Fe.Group,{value:r,size:"small",style:{display:"flex",flexDirection:"column",border:"1px solid #d9d9d9"},buttonStyle:"solid",onChange:C=>{C.target.value==="COMP"&&c("STYLE_CONFIG"),_(C.target.value)},children:[a.jsx(Fe.Button,{style:{borderRadius:0,border:"none"},value:"PAGE",children:"页面设置"}),a.jsx(Fe.Button,{style:{borderRadius:0,border:"none"},value:"COMP",children:"组件设置"})]})}),a.jsx("div",{className:jt.params_control_container,children:y()}),a.jsx("div",{className:jt.content_container,children:k()}),r==="FLOW"&&a.jsx("div",{className:jt.content_flow_container,children:a.jsx(Ul,{})})]})})}),Zl="index-module__component_filter_panel___-6q98",Jl="index-module__schema_modal_container___afjd0",Kl="index-module__close_icon___2CrVo",Ql="index-module__position_icon___dJ6wQ",en={component_filter_panel:Zl,schema_modal_container:Jl,close_icon:Kl,position_icon:Ql},eu={theme:"vs-dark",readOnly:!0},tu={readOnly:!0,folding:!0,wordWrap:"off",formatOnPaste:!0,fontSize:13,tabSize:2,scrollBeyondLastLine:!1,fixedOverflowWidgets:!1,snippetSuggestions:"top",minimap:{enabled:!1},options:{readOnly:!0,folding:!0,lineNumbers:"off",fixedOverflowWidgets:!0,automaticLayout:!0,glyphMargin:!1,lineDecorationsWidth:0,lineNumbersMinChars:0,hover:{enabled:!1}},scrollbar:{horizontal:"auto"}},nu=e=>{const[t,n]=d.useState(!1),[o,r]=d.useState(),[i,s]=d.useState(!0),[c,l]=d.useState(!1),[u,f]=d.useState(620),m=()=>{var C;n(!1),(C=e.onClose)==null||C.call(e)},h=async()=>{s(!0);const C=await D.renderCurrentPageSchema();C?r(C||{}):U.error("渲染失败"),s(!1)},v=C=>{console.log(C)},_=()=>{},x=zc(document.querySelector("body")),g=d.useMemo(()=>x!=null&&x.height?x.height-48:"100%",[x]);d.useEffect(()=>{n(e.open)},[e.open]),d.useEffect(()=>{(async()=>t&&await h())()},[t]);const y=()=>{f("100%"),l(!0)},k=()=>{f(620),l(!1)};return a.jsx(a.Fragment,{children:a.jsx(ro,{title:"Schema 预览",closeIcon:null,placement:"left",width:u,rootClassName:en.schema_modal_container,onClose:m,open:t,maskClosable:!1,extra:a.jsx(tr,{children:a.jsxs("div",{children:[!c&&a.jsx(It,{className:en.position_icon,onClick:y}),c&&a.jsx($t,{className:en.position_icon,onClick:k}),a.jsx("i",{onClick:m,className:Y({iconfont:!0,"icon-guanbi":!0,[en.close_icon]:!0})})]})}),children:a.jsx("div",{style:{height:g},children:a.jsx(to,{value:o?JSON.stringify(o,null,2):"",...eu,...tu,language:"json",readOnly:!0,onChange:C=>v(C),editorDidMount:_,height:g})})})})},ou="index-module__scale_control___APSwg",ru="index-module__scale_present___7Lx5G",iu="index-module__slider___QA-Cu",su="index-module__action___lO-BX",au="index-module__huanyuan___QHc92",cu="index-module__reset___UleYC",be={scale_control:ou,scale_present:ru,slider:iu,action:su,huanyuan:au,reset:cu},lu=e=>{const t=de(),{editorUIState:n}=t,o=d.useRef(null),r=d.useMemo(()=>{var i,s;return(s=(i=n==null?void 0:n.zoom)==null?void 0:i.toFixed)==null?void 0:s.call(i,0)},[n==null?void 0:n.zoom]);return!e.show||!n.adaptiveCanvasSize?null:a.jsx(a.Fragment,{children:a.jsxs("div",{className:be.scale_control,onMouseLeave:()=>{var i;(i=o==null?void 0:o.current)==null||i.blur()},children:[a.jsxs("span",{className:be.scale_present,children:[r,"%"]}),a.jsx(De,{title:"缩小",children:a.jsxs("svg",{viewBox:"64 64 896 896","data-icon":"minus-square",width:"32",height:"32",fill:"currentColor","aria-hidden":"true",focusable:"false",className:Y(be.action,be.huanyuan),onClick:()=>{(n==null?void 0:n.zoom)>5?n==null||n.setZoom(n.zoom-5):n==null||n.setZoom(5),setTimeout(()=>{Promise.resolve().then(()=>{D.rpcResetComponentPosition()})},0)},children:[a.jsx("path",{d:"M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}),a.jsx("path",{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"})]})}),a.jsx("div",{className:be.slider,children:a.jsx(Bi,{value:n.zoom,ref:o,onChange:n.setZoom})}),a.jsx(De,{title:"放大",children:a.jsxs("svg",{className:Y(be.action,be.huanyuan),viewBox:"64 64 896 896","data-icon":"plus-square",width:"32",height:"32",fill:"currentColor","aria-hidden":"true",focusable:"false",onClick:()=>{n.zoom>=400?n.setZoom(400):n.setZoom(n.zoom+5),setTimeout(()=>{Promise.resolve().then(()=>{D.rpcResetComponentPosition()})},0)},children:[a.jsx("path",{d:"M328 544h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}),a.jsx("path",{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"})]})}),a.jsx(De,{title:"自适应画布",children:a.jsxs("svg",{className:Y(be.action,be.reset),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8083",width:"32",height:"32",onClick:()=>{var i,s;(s=(i=D)==null?void 0:i.canvasSDK)==null||s.reset(),setTimeout(()=>{Promise.resolve().then(()=>{D.rpcResetComponentPosition()})},0)},children:[a.jsx("path",{d:"M801.4 696.1V327.7c0-9-5.6-16.5-13.6-20.6-0.9-0.3-1.7-0.9-2.5-1.5-3.1-1.2-6.5-1.9-10-1.9H247.4c-3.5 0-6.9 0.7-10 1.9-0.8 0.6-1.6 1.2-2.5 1.5-8 4.1-13.6 11.6-13.6 20.6v368.4c0 13.2 11.7 23.9 26.1 23.9h527.9c2.8 0 5.4-0.7 7.9-1.5 1.4-1.4 3.3-2 5.3-2.3 7.5-4.1 12.9-11.4 12.9-20.1z m-52.2-23.9H273.5V351.6h475.7v320.6z","p-id":"8084"}),a.jsx("path",{d:"M783.2 718.6c1.9-0.6 3.6-1.4 5.3-2.3-2 0.2-3.9 0.9-5.3 2.3zM785.3 305.7c0.8 0.6 1.6 1.2 2.5 1.5-0.9-0.5-1.6-1.2-2.5-1.5zM234.9 307.1c0.9-0.3 1.7-0.9 2.5-1.5-0.9 0.4-1.6 1.1-2.5 1.5zM330.9 413.6h360.8v196.7H330.9z","p-id":"8085"}),a.jsx("path",{d:"M226.7 137.2c-1.8-6.9-10.4-9.2-15.5-4.1l-52.5 52.5L58 84.6l-14-14c-6.2-6.2-16.5-6.2-22.7 0L4.7 87.2c-6.2 6.2-6.2 16.5 0 22.7l14 14 100.7 101-52.5 52.5c-5 5-2.7 13.6 4.1 15.5l158.7 14.4c1.8 0.5 3.5 0.4 5.1-0.1 0.9-0.4 1.6-1.1 2.5-1.5 2.9-2.1 4.8-5.7 3.7-9.7l-14.3-158.8zM796.4 137.2c1.8-6.9 10.4-9.2 15.5-4.1l52.5 52.5 100.7-101 14-14c6.2-6.2 16.5-6.2 22.7 0l16.6 16.6c6.2 6.2 6.2 16.5 0 22.7l-14 14-100.7 101 52.5 52.5c5 5 2.7 13.6-4.1 15.5l-158.7 14.4c-1.8 0.5-3.5 0.4-5.1-0.1-0.9-0.4-1.6-1.1-2.5-1.5-2.9-2.1-4.8-5.7-3.7-9.7l14.3-158.8zM226.7 886.8c-1.8 6.9-10.4 9.2-15.5 4.1l-52.5-52.5L58 939.4l-14 14c-6.2 6.2-16.5 6.2-22.7 0L4.7 936.8c-6.2-6.2-6.2-16.5 0-22.7l14-14 100.7-101-52.5-52.5c-5-5-2.7-13.6 4.1-15.5l158.7-14.4c1.8-0.5 3.5-0.4 5.1 0.1 0.9 0.4 1.6 1.1 2.5 1.5 2.9 2.1 4.8 5.7 3.7 9.7l-14.3 158.8zM796.4 886.8c1.8 6.9 10.4 9.2 15.5 4.1l52.5-52.5 100.7 101 14 14c6.2 6.2 16.5 6.2 22.7 0l16.6-16.6c6.2-6.2 6.2-16.5 0-22.7l-14-14-100.7-101 52.5-52.5c5-5 2.7-13.6-4.1-15.5l-158.7-14.4c-1.8-0.5-3.5-0.4-5.1 0.1-0.9 0.4-1.6 1.1-2.5 1.5-2.9 2.1-4.8 5.7-3.7 9.7l14.3 158.8z",fill:"#040000","p-id":"8086"})]})}),a.jsx(De,{title:"显示/隐藏参考线",children:a.jsxs("svg",{className:Y(be.action,be.reset),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1486",width:"32",height:"32",onClick:()=>{var i;(i=n==null?void 0:n.toggleShowGuides)==null||i.call(n)},children:[a.jsx("path",{d:"M320.256 57.856 132.864 57.856c-39.424 0-71.68 38.016-71.68 84.352l0 727.168c0 46.464 32.256 84.352 71.68 84.352l752.64 0c39.424 0 71.68-38.016 71.68-84.352L957.184 142.208c0-46.464-32.256-84.352-71.68-84.352l0 0L697.984 57.856M885.504 90.752c24.064 0 43.648 23.04 43.648 51.456l0 727.168 0 0c0 28.416-19.584 51.456-43.648 51.456l-752.64 0c-24.064 0-43.648-23.04-43.648-51.456L89.216 142.208c0-28.416 19.584-51.456 43.648-51.456L885.504 90.752zM929.152 869.376",fill:"#272636","p-id":"1487"}),a.jsx("path",{d:"M806.912 432l0-50.688L642.944 381.312 642.944 196.096l-50.688 0 0 185.216L426.112 381.312 426.112 196.096l-50.688 0 0 185.216L211.328 381.312l0 50.688 163.968 0 0 166.144L211.328 598.144l0 50.688 163.968 0 0 166.656 50.688 0L425.984 648.832l166.144 0 0 166.656 50.688 0L642.816 648.832l163.968 0 0-50.688L642.944 598.144 642.944 432 806.912 432zM592.256 598.144 426.112 598.144 426.112 432l166.144 0L592.256 598.144z",fill:"#272636","p-id":"1488"})]})}),a.jsx(De,{title:"显示/隐藏刻度线",children:a.jsx("svg",{className:Y(be.action,be.reset),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2515",width:"32",height:"32",onClick:()=>{var i;(i=n==null?void 0:n.toggleShowRule)==null||i.call(n)},children:a.jsx("path",{d:"M896 96v64H160v128H320v64H160v128H512v64H160v128H320v64H160v128H896v64H96v-832H896z",fill:"#595959","p-id":"2516"})})}),a.jsx(De,{title:"清空参考线",children:a.jsxs("svg",{className:Y(be.action,be.reset),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4608",width:"32",height:"32",onClick:()=>{var i,s;(s=(i=D)==null?void 0:i.canvasSDK)==null||s.clearGuidesLine()},children:[a.jsx("path",{d:"M704 678.4c19.2 6.4 38.4 12.8 51.2 0 51.2-51.2 96-115.2 128-179.2 32-64 44.8-134.4 44.8-198.4 0-6.4 0-12.8-6.4-19.2-6.4-6.4-6.4-12.8-12.8-12.8l-89.6-44.8 57.6-121.6c19.2-32-51.2-70.4-70.4-38.4l-57.6 121.6-96-51.2S640 128 627.2 128c-6.4 0-19.2 12.8-19.2 19.2-25.6 32-38.4 64-64 89.6-19.2 19.2-32 32-51.2 44.8-44.8 44.8-102.4 76.8-160 96-32 12.8-32 51.2-6.4 70.4l377.6 230.4z m-57.6-467.2L857.6 320c0 19.2-6.4 38.4-6.4 57.6l-224-128 19.2-38.4z m-108.8 128l38.4-38.4L825.6 448c0 6.4-6.4 12.8-6.4 19.2-25.6 51.2-57.6 96-96 140.8l-57.6-38.4 38.4-38.4c32-32-19.2-83.2-51.2-51.2l-51.2 51.2-76.8-44.8 44.8-32c38.4-25.6-6.4-83.2-38.4-57.6L460.8 448l-44.8-32c44.8-19.2 83.2-44.8 121.6-76.8z",fill:"#8a8a8a","p-id":"4609"}),a.jsx("path",{d:"M928 780.8H256V96c0-19.2-12.8-32-32-32h-19.2c-12.8 0-25.6 12.8-25.6 32v691.2H96c-19.2 0-32 12.8-32 32v12.8c0 19.2 12.8 32 32 32h76.8v64c6.4 19.2 19.2 32 32 32h12.8c25.6 0 38.4-12.8 38.4-32v-64h672c19.2 0 32-12.8 32-32v-12.8c0-19.2-12.8-38.4-32-38.4z",fill:"#8a8a8a","p-id":"4610"})]})})]})})},uu=ut(lu),du="index-module__component_filter_panel___J1bWQ",fu="index-module__title_content___U--kc",hu="index-module__input_container___x5Mv7",mu="index-module__tabs___jMtpS",vu="index-module__position_icon___j17Ao",_u="index-module__close_icon___OYrKb",gu="index-module__node_list_container___0Imrr",pu="index-module__margin_top32___wo3Rh",yu="index-module__margin_center___U260K",xu="index-module__component_card_list___2ZfM1",Cu="index-module__component_card___TOJyo",bu="index-module__component_name___7WHoI",wu="index-module__is_fixed_position___kNfMy",Su="index-module__collapse___UiIVq",xe={component_filter_panel:du,title_content:fu,input_container:hu,"ant-tabs-nav":"index-module__ant-tabs-nav___IEvuJ",tabs:mu,position_icon:vu,close_icon:_u,node_list_container:gu,margin_top32:pu,margin_center:yu,component_card_list:xu,component_card:Cu,component_name:bu,is_fixed_position:wu,collapse:Su},{Search:Eu}=tt,ju=e=>a.jsxs("div",{className:xe.title_content,children:[a.jsx("span",{children:"组件库"}),a.jsxs("span",{children:[a.jsx("i",{onClick:e.positionComponent,className:Y({iconfont:!0,"icon-guding":!0,[xe.position_icon]:!0})}),a.jsx("i",{onClick:e.closeComponent,className:Y({iconfont:!0,"icon-guanbi":!0,[xe.close_icon]:!0})})]})]}),Pu=e=>a.jsx("div",{className:xe.input_container,children:a.jsx(Eu,{allowClear:!0,placeholder:"搜索组件",onSearch:e.onSearch,style:{width:"100%"}})}),ku=({item:e,clickComponentCard:t})=>{const[n,o]=d.useState(!1),[r,i]=d.useState(!1);return a.jsxs("div",{className:xe.component_card,children:[n&&a.jsx("div",{className:xe.error_card,children:a.jsxs("svg",{className:"icon",viewBox:"0 0 1156 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"12011",width:"16",height:"16",children:[a.jsx("path",{d:"M1012.514758 0H144.472255A145.378985 145.378985 0 0 0 0 145.378985v725.383707a145.378985 145.378985 0 0 0 144.774498 145.076741H1012.514758a145.378985 145.378985 0 0 0 144.472255-145.076741v-725.383707A145.378985 145.378985 0 0 0 1012.514758 0z m72.236127 788.250295l-173.789846-222.14876a57.42621 57.42621 0 0 0-94.904368-7.253837l-126.942149 127.546635-24.4817 24.4817-50.77686 51.079103-36.269185-46.545455-172.580874-222.14876a54.101535 54.101535 0 0 0-86.743801 0l-246.025974 297.709563V145.378985a68.306966 68.306966 0 0 1 63.773317-72.538371h876.505313a77.978749 77.978749 0 0 1 72.236127 72.538371zM836.004723 249.652893a109.109799 109.109799 0 1 0 0 154.446281 109.109799 109.109799 0 0 0 0-154.446281z",fill:"#A9A9A9","p-id":"12012"}),a.jsx("path",{d:"M687.603306 668.864227l75.560803 84.930342-147.192444 270.205431h-187.088548l211.570248-207.943329-25.690673-54.101535 72.840614-93.090909z",fill:"#FFFFFF","p-id":"12013"})]})}),!n&&a.jsx(or,{style:{display:"block"},src:e.thumb,preview:{visible:r,src:e.thumb,onVisibleChange:s=>{i(s)}}}),a.jsx("div",{className:xe.component_name,onClick:()=>{t(e)},children:a.jsx(De,{placement:"top",title:()=>a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["别名：",e.alias||"--"]}),a.jsxs("p",{children:["名称：",e.name||"--"]}),a.jsxs("p",{children:["版本：",e.version||"--"]}),a.jsxs("p",{children:["提交者：",e.committer||"--"]})]}),children:e.alias})})]})},Nu=e=>{const{params:t,list:n}=e,o=d.useMemo(()=>ir(n,"category"),[n]);return a.jsx(a.Fragment,{children:a.jsxs("div",{className:Y({[xe.node_list_container]:!0,[xe.component_card_list]:n.length,component_list_container:!0}),children:[t.loading&&a.jsx("div",{className:Y({[xe.margin_top32]:!0,[xe.margin_center]:!0}),children:a.jsx(an,{})}),!n.length&&!t.loading&&a.jsx("div",{className:xe.margin_top32,children:a.jsx(We,{})}),Object.keys(o).map(r=>a.jsx(nr,{size:"small",className:xe.collapse,defaultActiveKey:["1"],onChange:i=>{},items:[{key:"1",label:r,children:a.jsx(a.Fragment,{children:o[r].map((i,s)=>a.jsx(ku,{item:i,...t,clickComponentCard:t.clickComponentCard},s))})}]},r))]})})},Tu=e=>{var s;const{dataStore:t,tabStore:n}=e,[o,r]=d.useState("100%"),i=d.useRef(null);return d.useEffect(()=>{var l;((l=i==null?void 0:i.current)==null?void 0:l.getBoundingClientRect()).top&&r("calc(100% - 104px)")},[]),a.jsx("div",{ref:i,style:{height:o},children:a.jsx(os,{style:{height:"100%"},className:Y({[xe.tabs]:!0,component_list_tabs:!0}),onChange:c=>{e.queryChange("bizCode",c)},size:"small",defaultActiveKey:e.searchMap.bizCode,tabPosition:"top",items:(s=n||[])==null?void 0:s.map(c=>({label:c.name,key:c.key,disabled:!1,children:a.jsx(Nu,{_item:c,params:e,list:(t==null?void 0:t[c.key])||[]})}))})})},Du=ze(e=>{const t=de(),{materialState:n}=t,{materialList:o,materialConfig:r}=n,{localFilter:i,isReady:s}=r,[c,l]=d.useState({name:"",page:1,pageSize:200,code:"",bizCode:""}),[u,f]=d.useState({}),[m,h]=d.useState([{key:"DEFAULT_BIZ",name:"业务域1",code:"DEFAULT_BIZ"},{key:"DEFAULT_BIZ_TEST",name:"业务域2",code:"DEFAULT_BIZ_TEST"}]),[v,_]=d.useState(!1),x=async()=>{_(!0);const b=(await bs.getBizListV2()||[]).map(E=>({code:(E==null?void 0:E.value)||"",key:(E==null?void 0:E.value)||"",name:(E==null?void 0:E.label)||""}));h(b);const S={...c,bizCode:b[0].code};l(S)},g=async(p,b=!1)=>{if(!p.bizCode)return;if(i)return y(p);_(!0);const S=await Ko.getComponentList({page:p.page,pageSize:p.pageSize,isAll:!0,name:p.name,alias:p.name,bizCode:p.bizCode==="ALL"?"":p.bizCode});let E=u[p.bizCode]||[];b&&(E=[]),f({...u,[p.bizCode]:E.concat(S)}),_(!1)},y=async(p,b=!1)=>{if(!p.bizCode)return;_(!0);const S=o.filter(E=>{var H,M;return(((H=E.alias)==null?void 0:H.includes(p.name))||((M=E.name)==null?void 0:M.includes(p.name)))&&E.bizCode===p.bizCode});u[p.bizCode],f({...u,[p.bizCode]:S}),_(!1)},k=async(p,b)=>{l({...c,[p]:b})},C=p=>{_(!0),setTimeout(()=>{_(!1)},2e3)};Rt(async()=>{await x()},[]),Rt(async()=>{await g({...c},!0)},[c,o,s]);const N=()=>{var p;(p=e.positionComponent)==null||p.call(e)},j=()=>{var p;(p=e.closeComponent)==null||p.call(e)},P=async p=>{var b;try{await((b=D)==null?void 0:b.pushComponent({id:p.id,version:p.version,name:p.name}))}catch(S){U.error(S.message),console.log(S)}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:Y({[xe.is_fixed_position]:e.isFixed,[xe.component_filter_panel]:!0}),children:[a.jsx(ju,{positionComponent:N,closeComponent:j}),a.jsx(Pu,{onSearch:p=>{k("name",p).then(b=>{})}}),a.jsx(Tu,{...e,searchMap:c,loading:v,dataStore:u,tabStore:m,onSearch:C,queryChange:k,clickComponentCard:P})]})})}),zu="index-module__component_filter_panel___RdrfB",Mu="index-module__title_content___ILunu",Ou="index-module__input_container___xGPRA",Lu="index-module__position_icon___f-VNI",Ru="index-module__close_icon___CUeTt",Fu="index-module__tree_node_list___RHBwb",Iu="index-module__tree___v8rH4",$u="index-module__treeNode___2W3VD",Au="index-module__label___D4xmc",Bu="index-module__updateIcon___O3FQ9",Vu="index-module__icon___jguqF",Gu="index-module__labelName___JVZFh",Yu="index-module__moreTools___mv2oQ",Hu="index-module__margin_top32___Ab6aN",Xu="index-module__margin_center___xvYJi",Wu="index-module__is_fixed_position___yrnWI",Uu="index-module__flex___gK0qH",qu="index-module__grow___bV0ez",Zu="index-module__contents___q5kSl",Ju="index-module__dragging___dIAJJ",Ku="index-module__row___zwkRW",Qu="index-module__overflowScrollContainer___xMBoW",ed="index-module__custom_table___wVmj3",q={component_filter_panel:zu,title_content:Mu,input_container:Ou,position_icon:Lu,close_icon:Ru,tree_node_list:Fu,tree:Iu,treeNode:$u,label:Au,updateIcon:Bu,icon:Vu,labelName:Gu,moreTools:Yu,margin_top32:Hu,margin_center:Xu,is_fixed_position:Wu,flex:Uu,"flex-column":"index-module__flex-column___zHp-8","shrink-0":"index-module__shrink-0___8Sx0y",grow:qu,"h-screen":"index-module__h-screen___AoOkb","font-mono":"index-module__font-mono___iRUFG","overflow-hidden":"index-module__overflow-hidden___F0PyI",contents:Zu,dragging:Ju,row:Ku,overflowScrollContainer:Qu,custom_table:ed};function sn(){return sn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},sn.apply(this,arguments)}var oi=["ArrowRight","Right"],ri=["ArrowDown","Down"],td=[].concat(["ArrowLeft","Left"],oi),nd=[].concat(["ArrowUp","Up"],ri),od=[].concat(oi,ri),rd=function(e){var t=e.axis,n=e.disabled,o=n!==void 0&&n,r=e.initial,i=r===void 0?0:r,s=e.min,c=s===void 0?0:s,l=e.max,u=l===void 0?1/0:l,f=e.reverse,m=e.step,h=m===void 0?10:m,v=e.shiftStep,_=v===void 0?50:v,x=e.onResizeStart,g=e.onResizeEnd,y=e.containerRef,k=Math.min(Math.max(i,c),u),C=d.useRef(!1),N=d.useState(!1),j=N[0],P=N[1],p=d.useState(k),b=p[0],S=p[1],E=d.useRef(k),H=d.useState(k),M=H[0],W=H[1],ee=d.useMemo(function(){return{role:"separator","aria-valuenow":b,"aria-valuemin":c,"aria-valuemax":u,"aria-orientation":t==="x"?"vertical":"horizontal","aria-disabled":o}},[t,o,u,c,b]),te=d.useCallback(function(T){if(C.current&&!o){T.stopPropagation(),T.preventDefault();var V=function(){if(t==="x"){if(y!=null&&y.current){var A=y.current.getBoundingClientRect(),J=A.left;return f?J+A.width-T.clientX:T.clientX-J}return f?document.body.offsetWidth-T.clientX:T.clientX}if(y!=null&&y.current){var Q=y.current.getBoundingClientRect(),re=Q.top;return f?re+Q.height-T.clientY:T.clientY-re}return f?document.body.offsetHeight-T.clientY:T.clientY}();V=Math.min(Math.max(V,c),u),S(V),E.current=V}},[t,o,u,c,f,y]),F=d.useCallback(function(T){o||(T.stopPropagation(),C.current=!1,P(!1),W(E.current),document.removeEventListener("pointermove",te),document.removeEventListener("pointerup",F),g&&g({position:E.current}))},[o,te,g]),$=d.useCallback(function(T){o||(T.stopPropagation(),C.current=!0,P(!0),document.addEventListener("pointermove",te),document.addEventListener("pointerup",F),x&&x({position:E.current}))},[o,te,F,x]),L=d.useCallback(function(T){if(!o){if(T.key==="Enter")return S(i),void(E.current=i);if((t!=="x"||td.includes(T.key))&&(t!=="y"||nd.includes(T.key))){x&&x({position:E.current});var V=T.shiftKey?_:h,A=f?-1:1,J=od.includes(T.key)?A:-1*A,Q=b+V*J;Q<c?(S(c),E.current=c):Q>u?(S(u),E.current=u):(S(Q),E.current=Q),g&&g({position:E.current})}}},[o,t,x,_,h,f,b,c,u,g,i]),X=d.useCallback(function(){o||(S(i),E.current=i)},[o,i]);return{position:b,endPosition:M,isDragging:j,separatorProps:sn({},ee,{onPointerDown:$,onKeyDown:L,onDoubleClick:X}),setPosition:S,splitterProps:sn({},ee,{onPointerDown:$,onKeyDown:L,onDoubleClick:X})}};const Tn={"sample-drag-bar":"index-module__sample-drag-bar___SOCjj","sample-drag-bar--dragging":"index-module__sample-drag-bar--dragging___5N-nQ","sample-drag-bar--horizontal":"index-module__sample-drag-bar--horizontal___jfZEe"},id=({id:e="drag-bar",dir:t,isDragging:n,...o})=>{const[r,i]=d.useState(!1);return a.jsx("div",{id:e,"data-testid":e,tabIndex:0,className:Y(Tn["sample-drag-bar"],t==="horizontal"&&Tn["sample-drag-bar--horizontal"],(n||r)&&Tn["sample-drag-bar--dragging"]),onFocus:()=>i(!0),onBlur:()=>i(!1),...o})},ii=new Zi({level:"warn",bizName:"tree"}),sd=(e,t)=>{const n=d.useRef(!1),o=de(),{editorSchemaState:r}=o,i=d.useRef(),s=d.useRef();return{isDrop:n,onComponentNodeDragEnter:v=>{},onNodeComponentDrop:v=>{if(t)return U.warning("拖拽排序前请先清除过滤条件"),!1;n.current=!0;const _=v.node.key,x=v.dragNode.key,g=v.node.pos.split("-"),y=v.dropPosition-Number(g[g.length-1]);let k="";switch(y){case 1:k=`移动到和dropKey   ${_} 的平级,并在其下面`;break;case-1:k=`是移动到和dropKey  ${_} 的平级, 并在其上面`;break;case 0:k=`移动到dropKey ${_}下面作为他的子级`;break}ii.log("dropPosition",y,k);const C=Ni(e,x+"",_+"",y),N={...r.schema,componentsTree:C};D.updateSchema(N).then(j=>{U.success("操作成功"),console.log(j)})},onNodeComponentDragStart:v=>{s.current=v,n.current=!0},onNodeComponentDragEnd:v=>{n.current=!1},onNodeComponentDragLeave:v=>{},onNodeComponentDragOver:v=>{n.current&&(i.current=v)}}},ad=(e,t)=>{const n=d.useRef(!1),o=de(),{editorSchemaState:r}=o,i=d.useRef(),s=d.useRef();return{isDrop:n,onNodeLibDragEnter:v=>{},onNodeLibDrop:v=>{if(t)return U.warning("拖拽排序前请先清除过滤条件"),!1;n.current=!0;const _=v.node.key,x=v.dragNode.key,g=v.node.pos.split("-"),y=v.dropPosition-Number(g[g.length-1]);let k="";switch(y){case 1:k=`移动到和dropKey   ${_} 的平级,并在其下面`;break;case-1:k=`是移动到和dropKey  ${_} 的平级, 并在其上面`;break;case 0:k=`移动到dropKey ${_}下面作为他的子级`;break}ii.log("dropPosition",y,k);const C=[{label:"依赖",value:"root",package:"root",children:e}],N=wo(C,x,"package"),j=wo(C,_,"package");if(x==="root")return U.warning("依赖虚拟节点不支持拖拽排序"),!1;if(y===0&&(N==null?void 0:N.package)!==_)return U.warning("依赖只能同级间拖拽排序"),!1;if((y===1||y===-1)&&(N==null?void 0:N.package)!==(j==null?void 0:j.package))return U.warning("依赖只能同级间拖拽排序"),!1;const P=Ti(C,x+"",_+"",y),p={...r.schema,packagesMap:P[0].children};D.updateSchema(p).then(b=>{U.success("操作成功"),console.log(b,p)})},onNodeLibDragStart:v=>{s.current=v,n.current=!0},onNodeLibDragEnd:v=>{n.current=!1},onNodeLibDragLeave:v=>{},onNodeLibDragOver:v=>{n.current&&(i.current=v)}}},cd="index-module__input_container___NB2aN",ld={input_container:cd},{Search:ud}=tt,si=e=>{const t=(e==null?void 0:e.placeholder)||"搜索组件或者依赖";return a.jsx("div",{className:e.className||ld.input_container,children:a.jsx(ud,{defaultValue:e.searchValue,allowClear:!0,placeholder:t,onSearch:e.onSearch,style:{width:"100%"},addonAfter:e.addonAfter})})},dd=e=>{const[t,n]=d.useState(!1),o=d.useMemo(()=>e!=null&&e.isUpdate?[{label:"重命名",key:"RENAME"},{label:"升级",key:"UPDATE_VERSION"},{label:"删除",key:"DELETE",danger:!0}]:[{label:"重命名",key:"RENAME"},{label:"删除",key:"DELETE",danger:!0}],[e==null?void 0:e.isUpdate]);return a.jsx(a.Fragment,{children:a.jsxs("div",{className:q.treeNode,onMouseOver:()=>{n(!0)},onMouseLeave:()=>{n(!1)},children:[a.jsx("div",{className:q.label,children:a.jsx("span",{className:q.labelName,children:e==null?void 0:e.node.alias})}),e.isUpdate&&a.jsx(Dr,{className:q.updateIcon,onClick:r=>{var i;(i=e==null?void 0:e.update)==null||i.call(e,e==null?void 0:e.node,r.domEvent)}}),t&&a.jsx("span",{className:q.moreTools,children:a.jsx(no,{placement:"bottom",menu:{items:o,onClick:async r=>{var s,c,l,u;(c=(s=r.domEvent)==null?void 0:s.stopPropagation)==null||c.call(s);const{key:i}=r;if(i==="UPDATE_VERSION"){await((l=e==null?void 0:e.update)==null?void 0:l.call(e,e==null?void 0:e.node,r.domEvent));return}await((u=e==null?void 0:e.onCompClick)==null?void 0:u.call(e,i,e.node))}},trigger:["hover"],overlayClassName:q.libContentMenus,children:a.jsx(io,{})})})]})})},fd=e=>{const[t,n]=d.useState(!1),o=d.useMemo(()=>e!=null&&e.isUpdate?[{label:"升级",key:"UPDATE_VERSION"},{label:"删除",key:"DELETE",danger:!0}]:[{label:"删除",key:"DELETE",danger:!0}],[e==null?void 0:e.isUpdate]);return a.jsx(a.Fragment,{children:a.jsxs("div",{className:q.treeNode,onMouseOver:()=>{n(!0)},onMouseLeave:()=>{n(!1)},children:[a.jsx("div",{className:q.label,children:a.jsx("span",{className:q.labelName,children:e==null?void 0:e.node.label})}),e.isUpdate&&a.jsx(Dr,{className:q.updateIcon,onClick:r=>{var i;(i=e==null?void 0:e.update)==null||i.call(e,e==null?void 0:e.node,r.domEvent)}}),t&&a.jsx("span",{className:q.moreTools,children:a.jsx(no,{placement:"bottom",menu:{items:o,onClick:async r=>{var s,c,l,u;(c=(s=r.domEvent)==null?void 0:s.stopPropagation)==null||c.call(s);const{key:i}=r;if(i==="UPDATE_VERSION"){await((l=e==null?void 0:e.update)==null?void 0:l.call(e,e==null?void 0:e.node,r.domEvent));return}await((u=e==null?void 0:e.onCompClick)==null?void 0:u.call(e,i,e.node))}},trigger:["hover"],overlayClassName:q.libContentMenus,children:a.jsx(io,{})})})]})})};function qo(e){const t=new Map;return e.forEach(n=>{const o=n.name+n.version;t.has(o)||t.set(o,n)}),Array.from(t.values())}const hd=e=>a.jsxs("div",{className:q.title_content,children:[a.jsx("span",{children:"页面大纲"}),a.jsxs("span",{children:[a.jsx("i",{onClick:e.positionComponent,className:Y({iconfont:!0,"icon-guding":!0,[q.position_icon]:!0})}),a.jsx("i",{onClick:e.closeComponent,className:Y({iconfont:!0,"icon-guanbi":!0,[q.close_icon]:!0})})]})]}),md=ut(e=>{var St,ft;const t=de(),[n,o]=d.useState(!1),{editorSchemaState:r,materialState:i}=t,{selectNodeCode:s=""}=r||{},[c,l]=d.useState([]),u=d.useRef([]),[f,m]=d.useState(""),[h,v]=d.useState(!0),[_,x]=d.useState("100%"),g=d.useRef(null),[y,k]=d.useState(!1),[C,N]=d.useState(!1),j=d.useRef(null),[P,p]=d.useState(null),[b,S]=d.useState(),{isDragging:E,position:H,splitterProps:M}=rd({axis:"y",initial:200,min:100,reverse:!0}),[W,ee]=d.useState([]),te=d.useRef([]),F=r.schema.componentsTree||[],$=d.useMemo(()=>{var z;return[{label:"依赖",value:"root",children:Ke(((z=r==null?void 0:r.schema)==null?void 0:z.packagesMap)||[]).map(O=>({children:[],value:O.package,label:O.componentName,version:O.version,exportName:O.exportName,componentName:O.componentName,subName:O.subName,package:O.package,destructuring:O.destructuring,main:O.main}))}]},[(St=r==null?void 0:r.schema)==null?void 0:St.packagesMap]);d.useEffect(()=>{var z;const w=(z=g==null?void 0:g.current)==null?void 0:z.getBoundingClientRect();w.top&&x(`calc(100vh - ${w.top}px)`)},[]);const L=()=>{var w;(w=e.positionComponent)==null||w.call(e,"TREE")},X=()=>{var w;(w=e.closeComponent)==null||w.call(e)},T=w=>{l(w),u.current=w,v(!1)},V=w=>{ee(w),te.current=w},A=w=>{if(w){const z=(O,ce)=>O.filter(Z=>Z.alias.includes(ce)?(Z.children&&(Z.children=z(Z.children,ce)),!0):Z.children?(Z.children=z(Z.children,ce),Z.children.length>0):!1);return z(Ke(F),w)}else return Ke(F)},J=w=>{if(w){const z=(O,ce)=>O.filter(Z=>Z.label.includes(ce)?(Z.children&&(Z.children=z(Z.children,ce)),!0):Z.children?(Z.children=z(Z.children,ce),Z.children.length>0):!1);return z(Ke($),w)}else return Ke($)},Q=d.useMemo(()=>A(f),[f,F]),re=d.useMemo(()=>J(f),[f,$]);d.useEffect(()=>{const w=Q.map(O=>O.id),z=[...new Set([...w,...u.current])];l(z),u.current=z},[Q]),d.useEffect(()=>{const w=re.map(O=>O.value),z=[...new Set([...w,...te.current])];ee(z),te.current=z},[re]);const le=w=>{m(w),v(!0)},bt=(w,z)=>{D.rpcSelectNode(z.node.id)},{run:I}=Ct(async w=>{var z;(z=D)==null||z.rpcOverFlowComponentCode(w.id)},{wait:100}),{run:ve}=Ct(async w=>{var z;(z=D)==null||z.rpcOverFlowComponentCode("")},{wait:100}),G=async(w,z)=>{var ce;const O=(ce=i==null?void 0:i.materialMap)==null?void 0:ce[w==null?void 0:w.name];console.log(O),Ie.confirm({title:"温馨提示",content:`是否将 ${w.name} 从 ${w.version} 升级到 ${O.version}？`,okText:"确认",cancelText:"取消",onOk:async()=>{try{S(O);const Z=(O==null?void 0:O.destructuring)||!1;(await D.updateNodeVersion({componentName:w.componentName,newVersionInfo:O,name:w.name,nodeCode:w.id,targetVersion:O.version,latest:O.latest,updateAllVersion:!1,destructuring:Z,package:O==null?void 0:O.package,condition:ue=>{var Ce;if(Z){const Ne=(O==null?void 0:O.package)||"",je=(Ce=i==null?void 0:i.materialMap)==null?void 0:Ce[ue==null?void 0:ue.name];return(je==null?void 0:je.package)===Ne}return ue.componentName===w.componentName}}))().then(ue=>{console.log("res",ue);const{callbackFun:Ce,...Ne}=ue;j.current=ue,p({...Ne}),k(!0)})}catch(Z){U.error(Z.message)}},onCancel:()=>{}}),z.stopPropagation()},R=()=>{var w,z;try{(z=(w=j==null?void 0:j.current)==null?void 0:w.callbackFun)==null||z.call(w,!0).then(O=>{U.success("升级成功"),S(null),k(!1)})}catch{U.error("升级失败")}},K=()=>{var w,z;try{(z=(w=j==null?void 0:j.current)==null?void 0:w.callbackFun)==null||z.call(w,!0).then(O=>{U.success("升级成功"),S(null),N(!1)})}catch{U.error("升级失败")}},ie=()=>{var w,z;k(!1);try{(z=(w=j==null?void 0:j.current)==null?void 0:w.callbackFun)==null||z.call(w,!1).then(O=>{U.warning("取消升级"),S(null),p(null),j.current=null})}catch{U.error("取消升级失败"),S(null),p(null),j.current=null}},ne=()=>{var w,z;N(!1);try{(z=(w=j==null?void 0:j.current)==null?void 0:w.callbackFun)==null||z.call(w,!1).then(O=>{U.warning("取消升级"),S(null),p(null),j.current=null})}catch{U.error("取消升级失败"),S(null),p(null),j.current=null}},oe=async(w,z)=>{var ce;const O=(ce=i==null?void 0:i.packageMap)==null?void 0:ce[w==null?void 0:w.package];Ie.confirm({title:"温馨提示",content:`是否将 ${w.exportName} 从 ${w.version} 升级到 ${O.version}？`,okText:"确认",cancelText:"取消",onOk:async()=>{try{(await D.updateLibVersion({componentName:w.componentName,newVersionInfo:O,name:w.package,nodeCode:w.exportName,targetVersion:O.version,latest:O.latest,updateAllVersion:!1,destructuring:O.destructuring,package:O==null?void 0:O.package,condition:he=>he.componentName===w.componentName}))().then(he=>{console.log(he);const{callbackFun:ue,...Ce}=he;j.current=he,p({...Ce}),N(!0)})}catch(Z){U.error(Z.message)}},onCancel:()=>{}}),z.stopPropagation()},se=w=>{var z,O;if(w.name&&((z=i==null?void 0:i.materialMap)!=null&&z[w==null?void 0:w.name])){const ce=(O=i==null?void 0:i.materialMap)==null?void 0:O[w==null?void 0:w.name];if((ce==null?void 0:ce.version)!==w.version)return!0}return!1},_e=w=>{var z,O;if(w.package&&((z=i==null?void 0:i.packageMap)!=null&&z[w==null?void 0:w.package])){const ce=(O=i==null?void 0:i.packageMap)==null?void 0:O[w==null?void 0:w.package];if((ce==null?void 0:ce.version)!==w.version)return!0}return!1},ae=[{title:"组件",dataIndex:"name"},{title:"当前版本",dataIndex:"version"},{title:"目标版本",dataIndex:"targetVersion"}],Pe=[{title:"组件",dataIndex:"name"},{title:"当前版本",dataIndex:"version"},{title:"目标版本",dataIndex:"targetVersion"}],Be=d.useMemo(()=>{const w=((P==null?void 0:P.nodes)||[]).map(z=>({name:z.name,version:z.version,targetVersion:P.targetVersion}));return qo(w)},[P]),Ve=d.useMemo(()=>{const w=((P==null?void 0:P.packages)||[]).map(z=>({name:z.package,version:z.version,targetVersion:P.targetVersion}));return qo(w)},[P]),nt=()=>{const{destructuring:w}=b||{};if(w){const z=`目标升级组件属于组件库 ${(b==null?void 0:b.package)||""}，此次升级 ${(b==null?void 0:b.name)||""} 将会升级关联的所有的组件，请谨慎操作！`;return a.jsx(Tr,{message:z,type:"warning",style:{minHeight:"32px",border:"none",margin:"8px 0 8px 0"}})}return null},{onComponentNodeDragEnter:Vt,onNodeComponentDrop:Gt,onNodeComponentDragStart:Le,onNodeComponentDragEnd:ot,onNodeComponentDragLeave:Ge,onNodeComponentDragOver:Ue}=sd(F,f),{onNodeLibDragEnter:wt,onNodeLibDrop:fn,onNodeLibDragStart:Yt,onNodeLibDragEnd:Ht,onNodeLibDragLeave:Xt,onNodeLibDragOver:hn}=ad(((ft=r==null?void 0:r.schema)==null?void 0:ft.packagesMap)||[],f),qe=async(w,z)=>{if(console.log(w,z),w==="DELETE")try{await D.deleteLib(z.package,z.version),U.success("删除成功")}catch{U.error("删除失败")}},[ke]=pe.useForm(),Wt=async(w,z)=>{if(console.log(w,z),w==="DELETE")try{await D.deleteNode(z.id),U.success("删除成功")}catch{U.error("删除失败")}if(w==="RENAME")try{console.log("重命名"),o(!0),ke==null||ke.setFieldsValue({name:z.alias,code:z.id}),console.log(ke)}catch{U.error("操作失败")}},dt=async()=>{o(!1)},rt=async()=>{try{const w=await(ke==null?void 0:ke.validateFields());w.code&&w.name?(await D.updateNodeValueByKey(w.code,"alias",w.name),o(!1)):U.warning("系统异常")}catch(w){console.log(w)}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:Y({[q.is_fixed_position]:e.isFixed,[q.component_filter_panel]:!0}),children:[a.jsx(hd,{positionComponent:L,closeComponent:X}),a.jsx(si,{searchValue:f,onSearch:w=>{le(w)}}),a.jsx("div",{className:q.tree_node_list,ref:g,style:{height:_},children:a.jsxs("div",{className:Y({[q.flex]:!0,[q["flex-column"]]:!0,[q["h-screen"]]:!0,[q["bg-dark"]]:!0,[q["font-mono"]]:!0,[q["color-white"]]:!0,[q["overflow-hidden"]]:!0}),children:[a.jsxs("div",{className:Y({[q.flex]:!0,[q.grow]:!0,[q.row]:!0,[q.componentContent]:!0,[q.overflowScrollContainer]:!0}),children:[a.jsx(Ie,{okText:"确认",cancelText:"取消",destroyOnClose:!0,title:"重命名",open:n,onOk:rt,onCancel:dt,children:a.jsxs(pe,{style:{maxWidth:600},form:ke,autoComplete:"off",children:[a.jsx(pe.Item,{label:"别名",name:"name",rules:[{required:!0,message:"别名不能为空"}],children:a.jsx(tt,{maxLength:20})}),a.jsx(pe.Item,{label:"别名",name:"code",hidden:!0,rules:[{required:!0,message:"别名不能为空"}],children:a.jsx(tt,{maxLength:20})})]})}),Q.length?a.jsx(Dn,{onDragStart:Le,onDragEnd:ot,onDragEnter:Vt,onDragLeave:Ge,onDragOver:Ue,onDrop:Gt,draggable:!0,className:q.tree,onExpand:T,defaultExpandAll:!0,selectedKeys:s?[s]:[],virtual:!0,autoExpandParent:h,treeData:Q,blockNode:!0,onSelect:bt,onMouseEnter:({node:w})=>{I(w)},onMouseLeave:({node:w})=>{ve(w)},fieldNames:{title:"alias",key:"id",children:"children"},titleRender:w=>a.jsx(a.Fragment,{children:a.jsx(dd,{node:w,isUpdate:se(w),onCompClick:Wt,update:G})})}):a.jsx("div",{className:q.margin_top32,children:a.jsx(We,{})})]}),a.jsx(id,{dir:"horizontal",isDragging:E,...M}),a.jsx("div",{className:Y({[q["shrink-0"]]:!0,[q["bg-darker"]]:!0,[q.contents]:!0,[q.row]:!0,[q.libContent]:!0,[q.overflowScrollContainer]:!0,[q.dragging]:E}),style:{height:H},children:re.length?a.jsx(Dn,{onDragStart:Yt,onDragEnd:Ht,onDragEnter:wt,onDragLeave:Xt,onDragOver:hn,onDrop:fn,draggable:!0,onExpand:V,defaultExpandAll:!0,expandedKeys:W,treeData:re||[],blockNode:!0,fieldNames:{title:"label",key:"value"},titleRender:w=>a.jsx(a.Fragment,{children:a.jsx(fd,{isUpdate:_e(w),onCompClick:qe,update:oe,node:w})})}):a.jsx("div",{className:q.margin_top32,children:a.jsx(We,{})})})]})})]}),a.jsxs(Ie,{title:"升级提示",okText:"确认",cancelText:"取消",open:y,onOk:R,onCancel:ie,children:[nt(),a.jsx(On,{bordered:!0,className:q.custom_table,pagination:!1,columns:ae,dataSource:Be,scroll:{y:200}})]}),a.jsxs(Ie,{title:"升级提示",okText:"确认",cancelText:"取消",open:C,onOk:K,onCancel:ne,children:[nt(),a.jsx(On,{bordered:!0,className:q.custom_table,pagination:!1,columns:Pe,dataSource:Ve,scroll:{y:200}})]})]})}),vd="index-module__editorCanvasContent___ncyAj",_d={editorCanvasContent:vd},gd=ze(e=>a.jsxs("div",{className:_d.editorCanvasContent,children:[a.jsx(gl,{onInitSuccess:e.onInitSuccess}),a.jsx(uu,{show:!0})]})),pd="index-module__editor_page_main_container___pGHxr",yd="index-module__device_list___hDhjn",xd="index-module__device_item___bMi1n",Cd="index-module__select_icon___uyP4b",bd="index-module__selectPageVersion___qqq-x",wd="index-module__device_container___L0PDN",Sd="index-module__device_container_input___bmSrj",Ed="index-module__page_handler_buttons___XO-H-",jd="index-module__button___aZNgq",Pd="index-module__redo___izZzn",kd="index-module__undo___aVZIF",Nd="index-module__divider___bejLx",Td="index-module__top_divider___dJmzo",we={editor_page_main_container:pd,device_list:yd,device_item:xd,select_icon:Cd,selectPageVersion:bd,device_container:wd,device_container_input:Sd,page_handler_buttons:Ed,button:jd,redo:Pd,undo:kd,divider:Nd,top_divider:Td},vt=e=>{const{viewAuth:t,code:n}=e;return t&&t[n]?e.children:null},Dd={phone:375,pad:768,pc:1280},zd=ze(e=>{const{configs:t={}}=e,{viewAuth:n}=t,o=de(),{editorSchemaState:r,editorUIState:i}=o,{isLocalMode:s}=r,{stageContainerRect:c,deviceType:l,setDeviceType:u,adaptiveCanvasSize:f}=i,m=Xc(),{histories:h,historyIndex:v,isPointerAtTop:_}=m,[x,g]=d.useState(!1),[y,k]=d.useState(!1),[C,N]=d.useState(!1),[j,P]=d.useState(!1),p=[{key:"pc",icon:"icon-pc"},{key:"phone",icon:"icon-mobile-phone"}],b=F=>{try{const $=Dd[F.key];D.setCanvasLayoutSize(Number($),c.height,F.key),u(F.key)}catch($){console.log($)}},S=async F=>{F&&D.setCanvasLayoutSize(F,c.height,l)},E=async(F=!0)=>new Promise(async $=>{g(!0);const L=await D.commitSavePage();L.success?(F&&U.open({type:"success",content:"保存成功"}),$(!0)):(U.open({type:"error",content:L.message}),$(!1)),g(!1)}),H=async()=>new Promise(async F=>{var L;k(!0);const $=await((L=D)==null?void 0:L.publishPage());$.success?(U.open({type:"success",content:"发布成功"}),F(!0)):(U.open({type:"error",content:$.message}),F(!1)),k(!1)}),M=async()=>{N(!0),g(!0);const F=await E(!1);Promise.resolve().then(async()=>{var $;if(F){const L=await(($=D)==null?void 0:$.previewPage());(!(L!=null&&L.success)||!L)&&U.open({type:"error",content:L.message})}N(!1),g(!1)})},W=async()=>{N(!0),g(!0),k(!0),await H(),N(!1),g(!1),k(!1)},ee=d.useMemo(()=>v<0,[h,v]),te=d.useMemo(()=>_,[_,v]);return a.jsxs(a.Fragment,{children:[a.jsx(zn,{className:we.editor_page_main_container,children:a.jsxs(Mn,{span:24,className:we.device_list,children:[a.jsx("div",{className:we.selectPageVersion}),a.jsxs("div",{className:we.device_container,children:[a.jsx(vt,{code:"deviceTypeButton",viewAuth:n,children:p.map(F=>a.jsx("div",{className:we.device_item,onClick:()=>b(F),children:a.jsx("i",{className:Y({[F.icon]:!0,iconfont:!0,[we.select_icon]:l===F.key})})},F.key))}),a.jsx(vt,{code:"canvasSizeControl",viewAuth:n,children:f&&a.jsx(Vi,{onChange:S,value:xt(c).width,addonAfter:"px",size:"small",className:we.device_container_input})})]}),a.jsxs("div",{className:we.page_handler_buttons,children:[a.jsx(a.Fragment,{children:a.jsx(vt,{code:"logRecordControl",viewAuth:n,children:a.jsxs(a.Fragment,{children:[a.jsx(Oe,{color:"default",variant:"link",disabled:ee,className:we.undo,onClick:()=>{var F,$,L,X,T,V,A;(L=($=(F=D)==null?void 0:F.stackHistory)==null?void 0:$.back)==null||L.call($),(A=(V=(T=(X=D)==null?void 0:X.previewer)==null?void 0:T.documentEvent)==null?void 0:V.rpcResetComponentPosition)==null||A.call(V)},children:a.jsx("svg",{d:"1725200856126",className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3774",width:"24",height:"24",children:a.jsx("path",{fill:ee?"#bfbfbf":"#2c2c2c",d:"M363.27619 224.597333l-191.414857 191.390477 191.390477 191.414857 41.49638-41.472-123.245714-123.270096h369.176381a143.993905 143.993905 0 0 1 0 288.012191h-160.01219v58.660571h160.01219a202.678857 202.678857 0 0 0 0-405.333333H286.817524l117.930666-117.930667L363.27619 224.597333z","p-id":"3775"})})}),a.jsx(Oe,{color:"default",variant:"link",disabled:te,className:we.redo,onClick:()=>{var F,$,L,X,T,V,A;(L=($=(F=D)==null?void 0:F.stackHistory)==null?void 0:$.go)==null||L.call($),(A=(V=(T=(X=D)==null?void 0:X.previewer)==null?void 0:T.documentEvent)==null?void 0:V.rpcResetComponentPosition)==null||A.call(V)},children:a.jsx("svg",{d:"1725201000633",className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3933",width:"24",height:"24",children:a.jsx("path",{fill:te?"#bfbfbf":"#2c2c2c",d:"M660.72381 213.918476l191.439238 191.414857-191.414858 191.390477-41.49638-41.44762 112.591238-112.615619H373.345524a143.993905 143.993905 0 0 0 0 288.012191h159.987809v58.660571h-160.01219a202.678857 202.678857 0 0 1 0-405.333333h374.54019l-128.609523-128.585143 41.49638-41.496381z","p-id":"3934"})})})]})})}),a.jsx(vt,{code:"savePageButton",viewAuth:n,children:s?a.jsx("div",{className:we.button,onClick:()=>E(),children:a.jsx(Oe,{loading:x,type:"primary",children:"保存到本地"})}):a.jsx("div",{className:we.button,onClick:()=>E(),children:a.jsx(Oe,{loading:x,type:"primary",children:"保存"})})}),a.jsx(vt,{code:"previewPageButton",viewAuth:n,children:s?a.jsx("div",{className:we.button,children:a.jsx(Oe,{loading:C,onClick:M,children:"预览"})}):a.jsx("div",{className:we.button,children:a.jsx(Oe,{loading:C,onClick:M,children:"预览"})})}),a.jsx(vt,{code:"publishPageButton",viewAuth:n,children:!s&&a.jsx("div",{className:we.button,children:a.jsx(Oe,{loading:y,danger:!0,onClick:W,children:"发布"})})})]})]})}),a.jsx(an,{spinning:j,fullscreen:!0})]})}),Md="index-module__editor_page_left_nav___OS8MU",Od="index-module__top_menus_container___lYhw9",Ld="index-module__setting_container___WbzLy",Rd="index-module__menu___dmO-h",Fd="index-module__menu_select___wNIF-",st={editor_page_left_nav:Md,top_menus_container:Od,setting_container:Ld,menu:Rd,menu_select:Fd},Id=e=>{const{configs:t={}}=e,{menus:n=[],topMenus:o=[]}=t,[r,i]=d.useState({async:!1,instance:void 0,icon:"",tiptop:"",key:""}),[s,c]=d.useState({async:!1,instance:void 0,icon:"",tiptop:"",key:""}),l=h=>{i(h)},u=()=>{i({async:!1,instance:void 0,icon:"",tiptop:"",key:""})},f=h=>{c(h)},m=()=>{c({async:!1,instance:void 0,icon:"",tiptop:"",key:""})};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:st.editor_page_left_nav,children:[a.jsxs("div",{className:st.top_menus_container,children:[o.map(h=>a.jsx(De,{placement:"right",title:h.tiptop,children:a.jsx("div",{onClick:()=>l(h),className:Y({[st.menu]:!0,[st.menu_select]:h.key===r.key}),children:a.jsx("i",{className:Y({iconfont:!0,[h.icon]:!0})})},h.key)},h.key)),o.map(h=>{const{instance:v,key:_,tiptop:x,icon:g,async:y}=h;return v&&(r==null?void 0:r.key)===_?y?a.jsx(d.Suspense,{fallback:a.jsx(tn,{}),children:a.jsx(v,{onClose:u,configs:{tiptop:x,icon:g,async:y}})},_):a.jsx(v,{onClose:u,configs:{tiptop:x,icon:g,async:y}}):null})]}),a.jsxs("div",{className:st.setting_container,children:[n.map(h=>{const{key:v}=h;return a.jsx(De,{placement:"right",title:h.tiptop,children:a.jsx("div",{onClick:()=>f(h),className:Y({[st.menu]:!0,[st.menu_select]:h.key===s.key}),children:a.jsx("i",{className:Y({iconfont:!0,[h.icon]:!0})})},h.key)},v)}),n.map(h=>{const{instance:v,key:_,tiptop:x,icon:g,async:y}=h;return v&&(s==null?void 0:s.key)===_?y?a.jsx(d.Suspense,{fallback:a.jsx(tn,{}),children:a.jsx(v,{onClose:m,open:(s==null?void 0:s.key)===_,configs:{tiptop:x,icon:g,async:y}})},_):a.jsx(v,{onClose:m,open:(s==null?void 0:s.key)===_,configs:{tiptop:x,icon:g,async:y}}):null})]})]})})},$d="index-module__editor_page_meta_left_nav___PAA7M",Ad="index-module__top_menus_container___U8fOx",Bd="index-module__setting_container___Tbr-G",Vd="index-module__menu___Ufv7L",Gd="index-module__menu_select___1oD6I",Pt={editor_page_meta_left_nav:$d,top_menus_container:Ad,setting_container:Bd,menu:Vd,menu_select:Gd},Yd=e=>{const t=n=>{var o;(o=e.selectNode)==null||o.call(e,n)};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:Pt.editor_page_meta_left_nav,children:[a.jsx("div",{className:Pt.top_menus_container,children:(e.menus||[]).map(n=>a.jsx(De,{placement:"right",title:n.tiptop,children:a.jsx("div",{onClick:()=>t(n),className:Y({[Pt.menu]:!0,[Pt.menu_select]:n.key===e.selectKey}),children:a.jsx("i",{className:Y({iconfont:!0,[n.icon]:!0})})},n.key)},n.key))}),a.jsx("div",{className:Pt.setting_container})]})})},Hd="index-module__editor_body_main___cibBI",Xd="index-module__row___TPU6c",Wd="index-module__editor_body_main_content___Sh8zh",Ud="index-module__editor_body_main_workspace___htg5Z",qd="index-module__edit_main_workspace___iBXX3",Zd="index-module__editor_body_main_loading___d7UMj",Jd="index-module__editorCanvasContent___Uc1xI",kt={editor_body_main:Hd,row:Xd,editor_body_main_content:Wd,editor_body_main_workspace:Ud,edit_main_workspace:qd,editor_body_main_loading:Zd,editorCanvasContent:Jd};cn({level:"info",bizName:"base-editor:useEditor"});const _t=e=>{const{configRegistered:t}=d.useContext(Qo);return d.useMemo(()=>{if(!e.areaType||!t)return null;const n=D.pluginService.getPlugin(e.areaType)||[];return a.jsx(a.Fragment,{children:n.map(o=>{const{instance:r,configs:i,key:s}=o;if(r)return e.async?a.jsx(d.Suspense,{fallback:a.jsx(tn,{}),children:a.jsx(r,{configs:i,...e.extend||{}})},s):a.jsx(r,{configs:i,...e.extend||{}},s)})})},[e.areaType,t])},Kd=()=>{const[e,t]=d.useState(!1),[n,o]=d.useState(!1),[r,i]=d.useState(!1),s=d.useRef(),[c]=Ei(),l=async()=>{const m=new URL(window.location.href),h=m.searchParams.get("pageVersionId")||c.get("pageVersionId"),v=m.searchParams.get("pageId")||c.get("pageId"),_=m.searchParams.get("pageName")||c.get("pageName");await D.createPageVersion({pageId:v?Number(v):null,pageVersionId:h?Number(h):null,pageName:_}),u(!1)},u=m=>{t(!m)},f=m=>{o(m)};return d.useEffect(()=>(window.editorService=()=>D,()=>{window.editorService=()=>null}),[]),d.useEffect(()=>{var h;const m=document.createElement("style");m.id="commonBodyStyle",m.textContent=`

    body {
      overflow: hidden;
    }`,s.current=m,(h=document.querySelector("head"))==null||h.appendChild(m)},[]),{editorService:D,isMounted:e,changeLoadingState:u,editorInitSuccess:l,isLoadData:n,changeLoadDataState:f,configRegistered:r,setConfigRegistered:i}};function Qd(e){const t=de(),{isMounted:n,changeLoadingState:o,editorInitSuccess:r,configRegistered:i,setConfigRegistered:s}=Kd();d.useEffect(()=>{D.initEditorConfig(e.config),s(!0)},[e.config]);const c=d.useMemo(()=>{let u=0;const f=D.pluginService.getPlugin("toolbarArea");return f&&f.length&&(u+=49),`calc(100% - ${u}px)`},[i]),l=d.useMemo(()=>{let u=0;const f=D.pluginService.getPlugin("topArea");return f&&f.length&&(u+=49),`calc(100% - ${u}px)`},[i]);return a.jsxs(Qo.Provider,{value:{isMounted:n,changeLoadingState:o,editorRootStore:t,configRegistered:i},children:[a.jsx(_t,{areaType:"topArea"}),a.jsxs("div",{className:kt.editor_body_main,style:{height:l},children:[a.jsx(_t,{areaType:"leftArea"}),a.jsx(zn,{className:kt.row,children:a.jsxs(Mn,{span:24,style:{height:"100%",overflow:"hidden"},children:[a.jsx(_t,{areaType:"toolbarArea",async:!0}),a.jsx(zn,{className:kt.editor_body_main_content,style:{height:c},children:a.jsx(Mn,{span:24,className:kt.editor_body_main_workspace,children:a.jsxs("div",{className:kt.edit_main_workspace,children:[a.jsx(_t,{areaType:"resourceArea"}),a.jsx(_t,{areaType:"previewerArea",extend:{onInitSuccess:r}}),a.jsx(_t,{areaType:"configArea",async:!0})]})})})]})})]})]})}const ef=ze(Qd),tf="index-module__component_filter_panel___ahTfw",nf="index-module__title_content___0vHdm",of="index-module__input_container___fkQnr",rf="index-module__tabs___BHeez",sf="index-module__position_icon___jkVHq",af="index-module__close_icon___0Aa6b",cf="index-module__is_fixed_position___878wH",at={component_filter_panel:tf,title_content:nf,input_container:of,"ant-tabs-nav":"index-module__ant-tabs-nav___8k1XD",tabs:rf,position_icon:sf,close_icon:af,is_fixed_position:cf},lf="index-module__component_filter_panel___d5DBV",uf="index-module__title_content___KQkuM",df="index-module__input_container___acuFe",ff="index-module__tabs___bT8pS",hf="index-module__position_icon___zaUC-",mf="index-module__close_icon___ng2en",vf="index-module__content___AlcrK",_f="index-module__table___G0S0Z",gf="index-module__is_fixed_position___N2yQd",pf="index-module__tableAction___BRNHg",yf="index-module__renderFlowName___0KCK7",xf="index-module__bottom___jASJh",Cf="index-module__flowNameStr___fxO90",Se={component_filter_panel:lf,title_content:uf,input_container:df,"ant-tabs-nav":"index-module__ant-tabs-nav___A2oso",tabs:ff,position_icon:hf,close_icon:mf,content:vf,table:_f,is_fixed_position:gf,tableAction:pf,"delete-button-icon":"index-module__delete-button-icon___hs2zi","preview-button-icon":"index-module__preview-button-icon___ostkY","meta-button-icon":"index-module__meta-button-icon___2SAvj",renderFlowName:yf,bottom:xf,flowNameStr:Cf},bf=e=>{const{isMaximize:t}=e;return a.jsxs("div",{className:Se.title_content,children:[a.jsx("span",{children:"流程编排"}),a.jsxs("span",{children:[!t&&a.jsx(It,{className:Se.position_icon,onClick:e.maximizeContainer}),t&&a.jsx($t,{className:Se.position_icon,onClick:e.minimizeContainer}),a.jsx("i",{onClick:e.positionPanel,className:Y({iconfont:!0,"icon-guding":!0,[Se.position_icon]:!0})}),a.jsx("i",{onClick:e.closePanel,className:Y({iconfont:!0,"icon-guanbi":!0,[Se.close_icon]:!0})})]})]})},go=e=>{const{container:t}=e,[n,o]=d.useState(!1),r=d.useRef();return{maximizeContainer:()=>{requestAnimationFrame(()=>{var l;let c=document.getElementById("useSizeContainerStyleId");c||(c=document.createElement("style"),c.textContent=".dom-container-full-screen { width: 100vw; height: 100vh; position: fixed; top: 0; right: 0;z-index: 9999}",c.setAttribute("id","useSizeContainerStyleId"),document.body.appendChild(c)),r.current=c,(l=t.current)==null||l.classList.add("dom-container-full-screen"),o(!0)})},minimizeContainer:()=>{requestAnimationFrame(()=>{var c;(c=t.current)==null||c.classList.remove("dom-container-full-screen"),r.current&&document.body.removeChild(r.current),o(!1)})},isMaximize:n}},wf=({name:e,code:t,updateName:n})=>{const[o,r]=d.useState(e),[i,s]=d.useState(!1);return d.useEffect(()=>{r(e)},[e]),a.jsx(Gi,{rootClassName:t,placement:"bottom",title:"流程元信息",open:i,onOpenChange:c=>{s(c)},trigger:"click",content:a.jsx(a.Fragment,{children:a.jsxs("div",{className:Se.renderFlowName,children:[a.jsx(tt,{size:"small",value:o,onChange:c=>{const l=c.target.value;r(l)}}),a.jsx("div",{className:Se.bottom,children:a.jsx(Oe,{size:"small",style:{outline:"none",boxShadow:"none"},type:"primary",onClick:()=>{n(o),s(!1)},children:"保存"})})]})}),children:a.jsx("div",{className:Y("ant-table-cell-ellipsis",Se.flowNameStr),onClick:()=>{s(!0)},children:e})})},Sf=ut(e=>{const{editorUIState:t,editorSchemaState:n}=de(),[o,r]=Ie.useModal(),i=d.useRef(),[s,c]=d.useState(),[l,u]=d.useState(!1),[f,m]=d.useState(!0),{previewerState:h}=t,{schema:v}=n,_=()=>{var E;(E=e.positionComponent)==null||E.call(e)},x=()=>{var E;(E=e.closeComponent)==null||E.call(e)},g=d.useRef(),{maximizeContainer:y,minimizeContainer:k,isMaximize:C}=go({container:g});d.useEffect(()=>{h!=null&&h.rendered},[h==null?void 0:h.rendered]);const N=d.useMemo(()=>v.flows||[],[v]),j=[{title:"流程",dataIndex:"name",key:"name",ellipsis:!0,render:(E,H)=>a.jsx(wf,{name:E,code:H.code,updateName:async M=>{await D.flowService.createFlow({code:H.code,name:M,data:H.data}),U.success("操作成功"),console.log(M)}})},{title:"操作",key:"action",render:(E,H)=>a.jsxs("div",{className:Se.tableAction,children:[a.jsx(rs,{title:"温馨提示",description:"确认要删除，删除后页面中所有关联将会被取消?",onConfirm:async()=>{console.log("确认删除"),await b(H),U.success("操作成功")},onCancel:()=>{console.log("取消")},okText:"确认",cancelText:"取消",children:a.jsx("span",{className:Se["delete-button-icon"],children:"删除"})}),a.jsx("span",{className:Se["preview-button-icon"],onClick:()=>p(H),children:"预览"})]})}],P=()=>{console.log("新增"),u(!0),m(!0)},p=E=>{console.log("预览",E),c(E),u(!0),m(!1)},b=async E=>{console.log("删除",E),await D.flowService.deleteFlow(E.code)},S=async()=>{var H,M,W,ee;const E=(H=i==null?void 0:i.current)==null?void 0:H.getData();if(!f&&s&&E&&JSON.stringify(E)===JSON.stringify(s.data)){m(!1),c(null),u(!1);return}if(E&&((M=E==null?void 0:E.nodes)!=null&&M.length)){if(await o.confirm({title:"温馨提示",okText:"确认",cancelText:"取消",content:a.jsx(a.Fragment,{children:"是否保存此次编排的流程？"})}))if(f){const F=oo(),$=((ee=(W=E==null?void 0:E.nodes[0])==null?void 0:W.properties)==null?void 0:ee.label)||"流程";await D.flowService.createFlow({code:F,name:$,data:E}),U.success("操作成功")}else{const F=s==null?void 0:s.code,$=s==null?void 0:s.name;await D.flowService.createFlow({code:F,name:$,data:E}),U.success("操作成功")}u(!1)}else u(!1);m(!1),c(null)};return a.jsx(a.Fragment,{children:a.jsxs("div",{ref:g,className:Y({[Se.is_fixed_position]:e.isFixed,[Se.component_filter_panel]:!0}),children:[a.jsx(bf,{positionPanel:_,closePanel:x,maximizeContainer:y,minimizeContainer:k,isMaximize:C}),a.jsx("div",{className:Se.content,children:a.jsx(On,{className:Se.table,pagination:!1,showHeader:!1,size:"small",rowKey:"code",columns:j,footer:()=>a.jsx(a.Fragment,{children:a.jsx(Oe,{style:{outline:"none",boxShadow:"none"},block:!0,type:"dashed",size:"small",onClick:P,children:"新增编排"})}),dataSource:N})}),r,a.jsx(ni,{ref:i,isNewCreate:f,graphData:s==null?void 0:s.data,showFlowConfig:l,closeDrawer:S})]})})}),Ef={theme:"vs-dark"},jf={readOnly:!0,folding:!0,wordWrap:"off",formatOnPaste:!0,fontSize:13,tabSize:2,scrollBeyondLastLine:!1,fixedOverflowWidgets:!1,snippetSuggestions:"top",minimap:{enabled:!1},options:{lineNumbers:"off",fixedOverflowWidgets:!0,automaticLayout:!0,glyphMargin:!1,folding:!1,lineDecorationsWidth:0,lineNumbersMinChars:0,hover:{enabled:!1}},scrollbar:{horizontal:"auto"}},Pf=e=>{const{isMaximize:t}=e;return a.jsxs("div",{className:at.title_content,children:[a.jsx("span",{children:"源代码"}),a.jsxs("span",{children:[!t&&a.jsx(It,{className:at.position_icon,onClick:e.maximizeContainer}),t&&a.jsx($t,{className:at.position_icon,onClick:e.minimizeContainer}),a.jsx("i",{onClick:e.positionPanel,className:Y({iconfont:!0,"icon-guding":!0,[at.position_icon]:!0})}),a.jsx("i",{onClick:e.closePanel,className:Y({iconfont:!0,"icon-guanbi":!0,[at.close_icon]:!0})})]})]})},kf=ut(e=>{var y,k,C,N;const t=d.useRef(),n=de(),o=((N=(C=(k=(y=n==null?void 0:n.editorSchemaState)==null?void 0:y.schema)==null?void 0:k.componentsTree)==null?void 0:C[0])==null?void 0:N.sourceCode)||(n==null?void 0:n.editorSchemaState.defaultSourceCode),[r,i]=d.useState(o),s=d.useRef(!1),c=()=>{var j;(j=e.positionComponent)==null||j.call(e)},l=()=>{var j;(j=e.closeComponent)==null||j.call(e)},u=d.useMemo(()=>"100%",[]),f=()=>{var P,p,b;const j=(b=(p=(P=t==null?void 0:t.current)==null?void 0:P.getMonacoRef)==null?void 0:p.call(P))==null?void 0:b.current;j&&j.languages.typescript.typescriptDefaults.addExtraLib(`
declare interface ReactComponent {
    componentWillMount?: () => void;
    componentDidMount?: () => void;
    componentDidUpdate?: (prevProps: any, prevState: any) => void;
    componentWillUnmount?: () => void;
    setState: (state: any) => void;
    componentWillUpdate?: (nextProps: any, nextState: any) => void;
    componentWillReceiveProps?: (nextProps: any) => void;
}
declare const Component: any;
`,"Component.d.ts")},m=Mc(r,{wait:4e3}),h=d.useRef(),{maximizeContainer:v,minimizeContainer:_,isMaximize:x}=go({container:h});d.useEffect(()=>{if(m)try{D.updateSchemaSourceCode(m)}catch(j){console.log(j)}},[m]);const g=j=>{i(j)};return Rt(async()=>{s.current=!0},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{ref:h,className:Y({[at.is_fixed_position]:e.isFixed,[at.component_filter_panel]:!0}),children:[a.jsx(Pf,{positionPanel:c,closePanel:l,maximizeContainer:v,minimizeContainer:_,isMaximize:x}),a.jsx(to,{value:o,ref:t,...Ef,...jf,language:"typescript",onChange:j=>g(j),editorDidMount:f,height:u})]})})}),Nf="index-module__component_filter_panel___w1rMi",Tf="index-module__title_content___HFVcp",Df="index-module__input_container___RHIwq",zf="index-module__tabs___MjooM",Mf="index-module__position_icon___0D8lp",Of="index-module__close_icon___fCGvJ",Lf="index-module__is_fixed_position___FAw-7",Ot={component_filter_panel:Nf,title_content:Tf,input_container:Df,"ant-tabs-nav":"index-module__ant-tabs-nav___eE-Qi",tabs:zf,position_icon:Mf,close_icon:Of,is_fixed_position:Lf},Rf=e=>a.jsxs("div",{className:Ot.title_content,children:[a.jsx("span",{children:"数据源"}),a.jsxs("span",{children:[a.jsx("i",{onClick:e.positionPanel,className:Y({iconfont:!0,"icon-guding":!0,[Ot.position_icon]:!0})}),a.jsx("i",{onClick:e.closePanel,className:Y({iconfont:!0,"icon-guanbi":!0,[Ot.close_icon]:!0})})]})]});ut(e=>{const t=()=>{var o;(o=e.positionPanel)==null||o.call(e)},n=()=>{var o;console.log("sssssssssssssssssssssss"),(o=e.closePanel)==null||o.call(e)};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:Y({[Ot.is_fixed_position]:e.isFixed,[Ot.component_filter_panel]:!0}),children:[a.jsx(Rf,{positionPanel:t,closePanel:n}),"divdfgfgf"]})})});const Ff="index-module__component_filter_panel___-peRw",If="index-module__title_content___Emp-g",$f="index-module__input_container___FrNUM",Af="index-module__tabs___bEQVI",Bf="index-module__position_icon___-cAAr",Vf="index-module__close_icon___ZFxXh",Gf="index-module__node_list_container___WCY-0",Yf="index-module__margin_top32___-oF0T",Hf="index-module__margin_center___-Wr3d",Xf="index-module__component_card_list___XVeDg",Wf="index-module__component_card___uXHlR",Uf="index-module__component_name___MF9dt",qf="index-module__is_fixed_position___s0-6-",Zf="index-module__collapse___F-Yqx",Ee={component_filter_panel:Ff,title_content:If,input_container:$f,"ant-tabs-nav":"index-module__ant-tabs-nav___3D6Lw",tabs:Af,position_icon:Bf,close_icon:Vf,node_list_container:Gf,margin_top32:Yf,margin_center:Hf,component_card_list:Xf,component_card:Wf,component_name:Uf,is_fixed_position:qf,collapse:Zf},{Search:Jf}=tt,Kf=e=>a.jsxs("div",{className:Ee.title_content,children:[a.jsx("span",{children:"依赖包"}),a.jsxs("span",{children:[a.jsx("i",{onClick:e.positionComponent,className:Y({iconfont:!0,"icon-guding":!0,[Ee.position_icon]:!0})}),a.jsx("i",{onClick:e.closeComponent,className:Y({iconfont:!0,"icon-guanbi":!0,[Ee.close_icon]:!0})})]})]}),Qf=e=>a.jsx("div",{className:Ee.input_container,children:a.jsx(Jf,{allowClear:!0,placeholder:"搜索依赖包",onSearch:e.onSearch,style:{width:"100%"}})}),eh=({item:e,clickComponentCard:t})=>{const[n,o]=d.useState(!1),[r,i]=d.useState(!1);return a.jsxs("div",{className:Ee.component_card,children:[n&&a.jsx("div",{className:Ee.error_card,children:a.jsxs("svg",{className:"icon",viewBox:"0 0 1156 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"12011",width:"16",height:"16",children:[a.jsx("path",{d:"M1012.514758 0H144.472255A145.378985 145.378985 0 0 0 0 145.378985v725.383707a145.378985 145.378985 0 0 0 144.774498 145.076741H1012.514758a145.378985 145.378985 0 0 0 144.472255-145.076741v-725.383707A145.378985 145.378985 0 0 0 1012.514758 0z m72.236127 788.250295l-173.789846-222.14876a57.42621 57.42621 0 0 0-94.904368-7.253837l-126.942149 127.546635-24.4817 24.4817-50.77686 51.079103-36.269185-46.545455-172.580874-222.14876a54.101535 54.101535 0 0 0-86.743801 0l-246.025974 297.709563V145.378985a68.306966 68.306966 0 0 1 63.773317-72.538371h876.505313a77.978749 77.978749 0 0 1 72.236127 72.538371zM836.004723 249.652893a109.109799 109.109799 0 1 0 0 154.446281 109.109799 109.109799 0 0 0 0-154.446281z",fill:"#A9A9A9","p-id":"12012"}),a.jsx("path",{d:"M687.603306 668.864227l75.560803 84.930342-147.192444 270.205431h-187.088548l211.570248-207.943329-25.690673-54.101535 72.840614-93.090909z",fill:"#FFFFFF","p-id":"12013"})]})}),!n&&a.jsx(or,{style:{display:"block"},src:e.thumb,preview:{visible:r,src:e.thumb,onVisibleChange:s=>{i(s)}}}),a.jsx("div",{className:Ee.component_name,onClick:()=>{t(e)},children:a.jsx(De,{placement:"top",title:()=>a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["别名：",e.alias||"--"]}),a.jsxs("p",{children:["名称：",e.name||"--"]}),a.jsxs("p",{children:["版本：",e.version||"--"]}),a.jsxs("p",{children:["提交者：",e.committer||"--"]})]}),children:e.alias})})]})},th=e=>{const{loading:t,list:n,clickComponentCard:o}=e,r=d.useMemo(()=>ir(n,"category"),[n]);return a.jsx(a.Fragment,{children:a.jsxs("div",{className:Y({[Ee.node_list_container]:!0,[Ee.component_card_list]:n.length,component_list_container:!0}),children:[t&&a.jsx("div",{className:Y({[Ee.margin_top32]:!0,[Ee.margin_center]:!0}),children:a.jsx(an,{})}),!n.length&&!t&&a.jsx("div",{className:Ee.margin_top32,children:a.jsx(We,{})}),Object.keys(r).map(i=>a.jsx(nr,{size:"small",className:Ee.collapse,defaultActiveKey:["1"],onChange:s=>{},items:[{key:"1",label:i,children:a.jsx(a.Fragment,{children:r[i].map((s,c)=>a.jsx(eh,{item:s,clickComponentCard:o},c))})}]},i))]})})},nh=e=>{const[t,n]=d.useState("100%"),o=d.useRef(null);return d.useEffect(()=>{var i;((i=o==null?void 0:o.current)==null?void 0:i.getBoundingClientRect()).top&&n("calc(100% - 104px)")},[]),a.jsx("div",{ref:o,style:{height:t},children:a.jsx(th,{list:e.components||[],loading:e.loading,clickComponentCard:e.clickComponentCard})})},oh=ze(e=>{const t=de(),{materialState:n}=t,{packageList:o,materialConfig:r}=n,{localFilter:i,isReady:s}=r,[c,l]=d.useState([]),[u,f]=d.useState({name:"",page:1,pageSize:100}),[m,h]=d.useState(!0);Rt(async()=>{if(h(!0),s){let g=[];i?g=o.filter(y=>{var k,C;return((k=y.alias)==null?void 0:k.includes(u.name))||((C=y.name)==null?void 0:C.includes(u.name))}):g=await Ko.getLibList({page:u.page,pageSize:u.pageSize,isAll:!0,name:u.name,alias:u.name,bizCode:""}),l(g),h(!1)}},[u,i,s]);const v=()=>{var g;(g=e.positionComponent)==null||g.call(e)},_=()=>{var g;(g=e.closeComponent)==null||g.call(e)},x=g=>{D.pushPackage(g).then(y=>{U.success(`${g.name}@${g.version}添加成功`)})};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:Y({[Ee.is_fixed_position]:e.isFixed,[Ee.component_filter_panel]:!0}),children:[a.jsx(Kf,{positionComponent:v,closeComponent:_}),a.jsx(Qf,{onSearch:g=>{f({...u,name:g})}}),a.jsx(nh,{loading:m,components:c,closeComponent:v,isFixed:!0,positionComponent:v,clickComponentCard:x})]})})}),rh="index-module__component_filter_panel___naKpl",ih="index-module__title_content___Xyu30",sh="index-module__input_container___ffr5w",ah="index-module__tabs___sHwWG",ch="index-module__position_icon___c-e3K",lh="index-module__close_icon___90qoo",uh="index-module__content___kXlFq",dh="index-module__is_fixed_position___5ZZtF",et={component_filter_panel:rh,title_content:ih,input_container:sh,"ant-tabs-nav":"index-module__ant-tabs-nav___HUuGR",tabs:ah,position_icon:ch,close_icon:lh,content:uh,is_fixed_position:dh},fh=e=>{const{isMaximize:t}=e;return a.jsxs("div",{className:et.title_content,children:[a.jsx("span",{children:"流程编排"}),a.jsxs("span",{children:[!t&&a.jsx(It,{className:et.position_icon,onClick:e.maximizeContainer}),t&&a.jsx($t,{className:et.position_icon,onClick:e.minimizeContainer}),a.jsx("i",{onClick:e.positionPanel,className:Y({iconfont:!0,"icon-guding":!0,[et.position_icon]:!0})}),a.jsx("i",{onClick:e.closePanel,className:Y({iconfont:!0,"icon-guanbi":!0,[et.close_icon]:!0})})]})]})},hh=e=>{const{container:t}=e,[n,o]=d.useState(!1),r=d.useRef();return{maximizeContainer:()=>{requestAnimationFrame(()=>{var l;let c=document.getElementById("useSizeContainerStyleId");c||(c=document.createElement("style"),c.textContent=".dom-container-full-screen { width: 100vw; height: 100vh; position: fixed; top: 0; right: 0;z-index: 9999}",c.setAttribute("id","useSizeContainerStyleId"),document.body.appendChild(c)),r.current=c,(l=t.current)==null||l.classList.add("dom-container-full-screen"),o(!0)})},minimizeContainer:()=>{requestAnimationFrame(()=>{var c;(c=t.current)==null||c.classList.remove("dom-container-full-screen"),r.current&&document.body.removeChild(r.current),o(!1)})},isMaximize:n}},mh={nodes:[{id:"logic_1ouvj1s5e6f4000",type:"StartNode",x:580,y:140,properties:{label:"页面加载",value:"PageInit",logo:"https://s3-gzpu.didistatic.com/tiyan-base-store/suda/organizer/icons/page_init.png",__config__:{type:"StartNode",aliasType:"PageInitNode",isAllowAsTargetNode:!1,correlationId:"componentDidMount"},name:"页面加载",status:"normal"}},{id:"logic_bqqt9p7jyzs0000",type:"CommonNode",x:740,y:140,properties:{label:"请求数据",value:"DataSource",logo:"请求数据",__config__:{type:"CommonNode",aliasType:"DataSource",correlationId:"",isAllowAsTargetNode:!0},status:"normal"}},{id:"logic_bmq5nozjh6w0000",type:"CommonNode",x:900,y:140,properties:{label:"页面跳转",value:"PageJump",logo:"页面跳转",__config__:{type:"CommonNode",aliasType:"PageJump",correlationId:"",isAllowAsTargetNode:!0},status:"normal"}}],edges:[{id:"logic_9739w0df83c0000",type:"LogicLine",properties:{},sourceNodeId:"logic_1ouvj1s5e6f4000",targetNodeId:"logic_bqqt9p7jyzs0000",startPoint:{x:630,y:140},endPoint:{x:690,y:140},pointsList:[{x:630,y:140},{x:690,y:140}]},{id:"logic_1d54v94f4mio000",type:"LogicLine",properties:{},sourceNodeId:"logic_bqqt9p7jyzs0000",targetNodeId:"logic_bmq5nozjh6w0000",startPoint:{x:790,y:140},endPoint:{x:850,y:140},pointsList:[{x:790,y:140},{x:850,y:140}]}]};ut(e=>{const{editorUIState:t}=de(),{previewerState:n}=t,o=()=>{var u;(u=e.positionComponent)==null||u.call(e)},r=()=>{var u;(u=e.closeComponent)==null||u.call(e)},i=d.useRef(),{maximizeContainer:s,minimizeContainer:c,isMaximize:l}=hh({container:i});return d.useEffect(()=>{var u,f,m,h;n!=null&&n.rendered&&(console.log("runner",(f=(u=D)==null?void 0:u.previewer)==null?void 0:f.renderRef),Ki.execute(mh,{pageInstance:(h=(m=D)==null?void 0:m.previewer)==null?void 0:h.renderRef}).then(()=>{console.log("runner::success")}))},[n==null?void 0:n.rendered]),a.jsx(a.Fragment,{children:a.jsxs("div",{ref:i,className:Y({[et.is_fixed_position]:e.isFixed,[et.component_filter_panel]:!0}),children:[a.jsx(fh,{positionPanel:o,closePanel:r,maximizeContainer:s,minimizeContainer:c,isMaximize:l}),a.jsx("div",{className:et.content,children:a.jsx(rr,{graphData:{nodes:[],edges:[]},config:{pageLifeCycleNodes:[{label:"页面加载",value:"PageInit",logo:"https://s3-gzpu.didistatic.com/tiyan-base-store/suda/organizer/icons/page_init.png",__config__:{type:"StartNode",aliasType:"PageInitNode",isAllowAsTargetNode:!1,correlationId:"componentDidMount"}},{label:"页面卸载",value:"PageUnmount",logo:"https://s3-gzpu.didistatic.com/tiyan-base-store/suda/organizer/icons/page_init.png",__config__:{type:"StartNode",aliasType:"PageUnmountNode",isAllowAsTargetNode:!1,correlationId:"componentWillUnmount"}}],pageUtilsNodes:[{label:"请求数据",value:"DataSource",logo:"https://s3-gzpu.didistatic.com/tiyan-base-store/suda/organizer/icons/data_load.png",__config__:{type:"CommonNode",aliasType:"DataSource",correlationId:"",isAllowAsTargetNode:!0}},{label:"页面跳转",value:"PageJump",logo:"https://s3-gzpu.didistatic.com/tiyan-base-store/suda/organizer/icons/page_jump.png",__config__:{type:"CommonNode",aliasType:"PageJump",correlationId:"",isAllowAsTargetNode:!0}},{label:"数据转换",value:"DataConvert",logo:"https://s3-gzpu.didistatic.com/tiyan-base-store/suda/organizer/icons/data_trans.png",__config__:{type:"CommonNode",aliasType:"DataConvert",correlationId:"",isAllowAsTargetNode:!0}}],componentsTree:[{thumb:"https://qiniu.canyuegongzi.xyz/lowcode_component/static/normal-component-logo.png",id:"95",componentId:95,alias:"低代码PAGE",name:"lowcode-page",componentName:"Page",latest:"1.0.0",version:"1.0.0",props:{},dependencies:{"lowcode-page":"1.0.0"},componentType:["Component","Page","Container"],sourceCode:`
class LowcodeComponent extends Component {
  state = {
    block: false,
    title: "测试文案gfdgfhfhfhfhffh",
    title1: "测试文案gfdgfhfhfhfhffh",
    title2: "测试文案gfdewewerwfh",
    title3: "测试文案gfdgqqqqq"
  }

  componentDidMount() {}

  componentWillUnmount() {}
}`,children:[{alias:"特征文字",children:[],componentId:"93",componentName:"CharacteristicTextList",exportName:"CharacteristicTextList",css:"",dependencies:{"characteristic-text-list":"1.0.2"},desc:"特征文字",id:"UEge8qFbT80YKDKfsxu_O",latest:"1.0.2",lifeCycles:{},name:"characteristic-text-list",props:{titleConfig:{text:{type:"JSExpression",value:"this.state.title1",mock:{type:"JSExpression",value:"this.state.title1",mock:{type:"JSExpression",value:"this.state.title",mock:"标题"}}},fontSize:"40",fontColor:"#000"},subTitleConfig:{text:"标题",fontSize:"16",fontColor:"#959ba6"},list:[{backgroundImage:"https://tianshu.alicdn.com/9652b6f7-8bc9-4527-9854-06c59f2b0bc8.png",description:"标题",fontSize:"16",fontColor:"#000",width:"90"}]},thumb:"https://qiniu.canyuegongzi.xyz/lowcode_component/static/normal-component-logo.png",version:"1.0.2",componentType:["Component"]},{alias:"特征文字",children:[],componentId:"93",componentName:"CharacteristicTextList",exportName:"CharacteristicTextList",css:"",dependencies:{"characteristic-text-list":"1.0.2"},desc:"特征文字",id:"RTJ38MKlqaiJJuky1hy2l",latest:"1.0.2",lifeCycles:{},name:"characteristic-text-list",props:{titleConfig:{text:{type:"JSExpression",value:"this.state.title2",mock:{type:"JSExpression",value:"this.state.title",mock:"标题"}},fontSize:"40",fontColor:"#000"},subTitleConfig:{text:"标题",fontSize:"16",fontColor:"#959ba6"},list:[{backgroundImage:"https://tianshu.alicdn.com/9652b6f7-8bc9-4527-9854-06c59f2b0bc8.png",description:"标题",fontSize:"16",fontColor:"#000",width:"90"}]},thumb:"https://qiniu.canyuegongzi.xyz/lowcode_component/static/normal-component-logo.png",version:"1.0.2",componentType:["Component"]},{alias:"特征文字",children:[],componentId:"93",componentName:"CharacteristicTextList",exportName:"CharacteristicTextList",css:"",dependencies:{"characteristic-text-list":"1.0.2"},desc:"特征文字",id:"LgQGWJh2cckIx89PvNLCN",latest:"1.0.2",lifeCycles:{},name:"characteristic-text-list",props:{titleConfig:{text:{type:"JSExpression",value:"this.state.title3",mock:{type:"JSExpression",value:"this.state.title",mock:"标题"}},fontSize:"40",fontColor:"#000"},subTitleConfig:{text:"标题",fontSize:"16",fontColor:"#959ba6"},list:[{backgroundImage:"https://tianshu.alicdn.com/9652b6f7-8bc9-4527-9854-06c59f2b0bc8.png",description:"标题",fontSize:"16",fontColor:"#000",width:"90"}]},thumb:"https://qiniu.canyuegongzi.xyz/lowcode_component/static/normal-component-logo.png",version:"1.0.2",componentType:["Component"]}],lifeCycles:{componentDidMount:{type:"JSFunction",value:`function componentDidMount() { }
`},componentWillUnmount:{type:"JSFunction",value:`function componentWillUnmount() { }
`}},state:{block:{type:"JSExpression",value:"false"},title:{type:"JSExpression",value:'"测试文案gfdgfhfhfhfhffh"'},title1:{type:"JSExpression",value:'"测试文案gfdgfhfhfhfhffh"'},title2:{type:"JSExpression",value:'"测试文案gfdewewerwfh"'},title3:{type:"JSExpression",value:'"测试文案gfdgqqqqq"'}},methods:{}}],defaultConfig:{start:{label:"组件",value:"ComponentNode",logo:"https://s3-gzpu.didistatic.com/tiyan-base-store/suda/organizer/icons/page_init.png",__config__:{type:"StartNode",aliasType:"ComponentNode",isAllowAsTargetNode:!0}},component:{label:"组件",value:"ComponentNode",logo:"https://s3-gzpu.didistatic.com/tiyan-base-store/suda/organizer/icons/page_init.png",__config__:{type:"StartNode",aliasType:"ComponentNode",isAllowAsTargetNode:!0}}}},viewAuth:{toolsControl:!1,nodeList:!1}})})]})})});const Zn="LAYOUT_UI_CONFIG",Jn="positionFixed",vh=e=>{var o;const t=window.localStorage.getItem(Zn),n=t?JSON.parse(t):{};return((o=n==null?void 0:n[Jn])==null?void 0:o[e])||!1},_h=(e,t)=>{const n=window.localStorage.getItem(Zn),o=n?JSON.parse(n):{};o[Jn]={...o[Jn]||{},[e]:t},window.localStorage.setItem(Zn,JSON.stringify(o))},gh=e=>{const{configs:t}=e,{menus:n}=t,[o,r]=d.useState(vh("COMPONENT")),[i,s]=d.useState({icon:"",tiptop:"",key:"COMPONENT",instance:null}),c=f=>{if(i.key===f.key){s({icon:"",tiptop:"",key:"",instance:null});return}s(f)},l=(f="COMPONENT")=>{const m=!o;r(m),_h(f,m)},u=()=>{s({...i,key:""})};return a.jsxs(a.Fragment,{children:[a.jsx(Yd,{menus:n,selectKey:i.key,selectNode:c}),n.map(f=>{const{instance:m,key:h,tiptop:v,icon:_,async:x}=f;return(i==null?void 0:i.key)===h?x?a.jsx(d.Suspense,{fallback:a.jsx(tn,{}),children:a.jsx(m,{isFixed:o,positionComponent:l,closeComponent:u,configs:{tiptop:v,icon:_,async:x}})},h):a.jsx(m,{isFixed:o,positionComponent:l,closeComponent:u,configs:{tiptop:v,icon:_,async:x}},h):null})]})},ph="index-module__component_filter_panel___qzQdI",yh="index-module__title_content___-nUdu",xh="index-module__input_container___JDX8x",Ch="index-module__tabs___RHMbQ",bh="index-module__position_icon___IhOry",wh="index-module__close_icon___kCIqC",Sh="index-module__content___w-hqP",Eh="index-module__is_fixed_position___Z6sdv",jh="index-module__tree_node_list___KU99u",Ph="index-module__tree___UtRnj",kh="index-module__treeNode___OuYX-",Nh="index-module__label___hHDp0",Th="index-module__updateIcon___JDRxI",Dh="index-module__icon___javW7",zh="index-module__labelName___UIPU5",Mh="index-module__moreTools___CrkCd",Oh="index-module__headerTools___VwCk9",Lh="index-module__search___A8BAu",Rh="index-module__add___bugfS",ye={component_filter_panel:ph,title_content:yh,input_container:xh,"ant-tabs-nav":"index-module__ant-tabs-nav___TEqwl",tabs:Ch,position_icon:bh,close_icon:wh,content:Sh,is_fixed_position:Eh,tree_node_list:jh,tree:Ph,treeNode:kh,label:Nh,updateIcon:Th,icon:Dh,labelName:zh,moreTools:Mh,headerTools:Oh,search:Lh,add:Rh},Fh="index-module__drawer___mxMY0",Ih="index-module__schema_modal_container___BiKO0",$h="index-module__close_icon___s8YVc",Ah="index-module__codeEditor___24Q5X",Bh="index-module__footer___6kTHX",Vh="index-module__save___cWo8P",pt={drawer:Fh,schema_modal_container:Ih,close_icon:$h,codeEditor:Ah,footer:Bh,save:Vh},Zo=[{value:"string",label:"字符串"},{value:"boolean",label:"布尔"},{value:"number",label:"数值"},{value:"object",label:"对象"},{value:"function",label:"方法"},{value:"array",label:"集合"}],Gh={theme:"vs-dark",readOnly:!0},Yh={readOnly:!1,folding:!0,wordWrap:"off",formatOnPaste:!0,fontSize:13,tabSize:2,scrollBeyondLastLine:!1,fixedOverflowWidgets:!1,snippetSuggestions:"top",minimap:{enabled:!1},options:{readOnly:!1,folding:!0,lineNumbers:"off",fixedOverflowWidgets:!0,automaticLayout:!0,glyphMargin:!1,lineDecorationsWidth:0,lineNumbersMinChars:0,hover:{enabled:!1}},scrollbar:{horizontal:"auto"}},Hh=({value:e,onChange:t})=>{const n=d.useRef();return a.jsx("div",{className:pt.codeEditor,children:a.jsx(to,{value:e,ref:n,...Gh,...Yh,language:"typescript",onChange:o=>{t(o)},editorDidMount:()=>{},height:200})})},Xh=d.forwardRef((e,t)=>{const[n,o]=d.useState(e.open||!1),[r]=pe.useForm();d.useEffect(()=>{o(e.open)},[e==null?void 0:e.open]),d.useImperativeHandle(t,()=>({open:_=>{console.log(_),r==null||r.setFieldsValue(_)}}));const i=async()=>{var _,x,g,y,k,C,N,j,P;try{const p=await(r==null?void 0:r.validateFields());if(console.log(p),p.type==="function"){const b=await((x=(_=D.page)==null?void 0:_.compiler)==null?void 0:x.parseFunction(p.value,p.name));b&&await((k=(y=(g=D)==null?void 0:g.page)==null?void 0:y.compiler)==null?void 0:k.createProperty(p.createProperty,{name:b.name,type:p.type,comment:p.comment,value:b.body,params:b.params||[]},{override:!0}))}else await((j=(N=(C=D)==null?void 0:C.page)==null?void 0:N.compiler)==null?void 0:j.createProperty(p.createProperty,{comment:p.comment,name:p.name,params:[],type:p.type,value:p.value},{override:!0}));(P=e==null?void 0:e.onSuccess)==null||P.call(e),await s()}catch(p){console.log(p)}},s=async()=>{var _;r==null||r.resetFields(),(_=e==null?void 0:e.onClose)==null||_.call(e)},c=pe.useWatch("createProperty",r),l=pe.useWatch("name",r),u=pe.useWatch("value",r),f=d.useMemo(()=>c==="Function",[c]),m=d.useMemo(()=>c=="function"?Zo.filter(_=>_.value==="function"):Zo.filter(_=>_.value!=="function"),[c]),h={createProperty:[{required:!0,message:"不能为空!"}],name:[{required:!0,message:"不能为空!"},{pattern:/^[a-zA-Z_$][a-zA-Z0-9_$]*$/,message:"输入合法的变量!"}],type:[{required:!0,message:"不能为空!"}],value:[{validator:async(_,x)=>new Promise(async(g,y)=>{var k,C;if(c!=="Function")return g(!0);try{await((C=(k=D.page)==null?void 0:k.compiler)==null?void 0:C.parseFunction(x,l)),g(!0)}catch(N){console.log(N),y(new Error("函数不合法，请修改"))}}),validateTrigger:["onBlur"]}]},v=_=>{const x=`function ${_}() {


}`;r.setFieldValue("value",x)};return a.jsx(ro,{width:680,title:e.title,className:pt.drawer,open:n,onClose:e.onClose,closeIcon:null,rootClassName:pt.schema_modal_container,maskClosable:!1,extra:a.jsx(tr,{children:a.jsx("div",{children:a.jsx("i",{onClick:e.onClose,className:Y({iconfont:!0,"icon-guanbi":!0,[pt.close_icon]:!0})})})}),footer:a.jsx(a.Fragment,{children:a.jsxs("div",{className:pt.footer,children:[a.jsx(Oe,{onClick:s,children:"取消"}),a.jsx(Oe,{type:"primary",className:pt.save,onClick:i,children:"保存"})]})}),children:a.jsxs(pe,{form:r,labelCol:{span:4},wrapperCol:{span:14},layout:"horizontal",onValuesChange:(_,x)=>{var g;if(x.createProperty==="Function"?(r.setFieldValue("type","function"),u||v(x.name)):r.getFieldValue("type")==="function"&&r.setFieldValue("type",""),_.hasOwnProperty("type")){const y=(g=D.page)==null?void 0:g.compiler.getDefaultValue(_.type);r.setFieldValue("value",y)}},children:[a.jsx(pe.Item,{label:"代码类型",name:"createProperty",rules:h.createProperty,children:a.jsxs(Fe.Group,{children:[a.jsx(Fe,{value:"State",children:" 变量 "}),a.jsx(Fe,{value:"Function",children:" 方法 "})]})}),a.jsx(pe.Item,{label:"变量名称",name:"name",rules:h.name,children:a.jsx(tt,{onBlur:_=>{c==="Function"&&!u&&v(_.target.value)}})}),a.jsx(pe.Item,{label:"变量类型",name:"type",rules:h.type,children:a.jsx(Yi,{options:m,disabled:f})}),a.jsx(pe.Item,{label:"默认值",name:"value",rules:h.value,children:a.jsx(Hh,{})}),a.jsx(pe.Item,{label:"备注",name:"comment",children:a.jsx(tt.TextArea,{rows:2,maxLength:20,showCount:!0})})]})})}),Wh=e=>{const{isMaximize:t}=e;return a.jsxs("div",{className:ye.title_content,children:[a.jsx("span",{children:"代码区"}),a.jsxs("span",{children:[!t&&a.jsx(It,{className:ye.position_icon,onClick:e.maximizeContainer}),t&&a.jsx($t,{className:ye.position_icon,onClick:e.minimizeContainer}),a.jsx("i",{onClick:e.positionPanel,className:Y({iconfont:!0,"icon-guding":!0,[ye.position_icon]:!0})}),a.jsx("i",{onClick:e.closePanel,className:Y({iconfont:!0,"icon-guanbi":!0,[ye.close_icon]:!0})})]})]})},Uh=e=>e.type==="Function"?a.jsx("i",{className:"iconfont icon-function"}):(e.type==="State",null),qh=e=>{const[t,n]=d.useState(!1),o=[{label:"编辑",key:"EDIT"},{label:"删除",key:"DELETE",danger:!0}];return a.jsxs("div",{className:ye.treeNode,onMouseOver:()=>{n(!0)},onMouseLeave:()=>{n(!1)},children:[a.jsxs("div",{className:ye.label,children:[a.jsx("span",{className:ye.labelName,children:e.name}),a.jsx("span",{className:ye.icon,children:Uh(e)})]}),t&&a.jsx("span",{className:ye.moreTools,children:a.jsx(no,{placement:"bottom",menu:{items:o,onClick:async r=>{var i,s,c;(s=(i=r.domEvent)==null?void 0:i.stopPropagation)==null||s.call(i),console.log(r),r.key==="EDIT"&&((c=e==null?void 0:e.editItem)==null||c.call(e,e))}},trigger:["hover"],overlayClassName:ye.libContentMenus,children:a.jsx(io,{})})})]})},Zh=ut(e=>{const[t,n]=d.useState(""),[o,r]=d.useState("100%"),[i,s]=d.useState(!0),[c,l]=d.useState(!1),[u,f]=d.useState([]),[m,h]=d.useState([]),[v,_]=d.useState("新建代码"),{editorUIState:x,editorSchemaState:g}=de(),{getVariableStateList:y,getVariableMethodsList:k}=g,[C,N]=Ie.useModal(),{previewerState:j}=x,P=d.useRef(null),p=d.useRef();d.useEffect(()=>{var V;const T=(V=P==null?void 0:P.current)==null?void 0:V.getBoundingClientRect();T.top&&r(`calc(100vh - ${T.top}px)`)},[]);const b=()=>{var T;(T=e.positionComponent)==null||T.call(e)},S=()=>{var T;(T=e.closeComponent)==null||T.call(e)};Rt(async()=>{const T=await y()||[],V=await k()||[];h(V),f(T)},[g.schema]);const E=d.useMemo(()=>{const T=xt(u).map(A=>({type:"State",...A})),V=xt(m).map(A=>({type:"Function",...A}));return T.concat(V).map(A=>xt(A)).filter(A=>A.name.includes(t)||A.path.includes(t))||[]},[m,u,g.schema,t]),H=T=>{console.log(T),n(T),s(!0)},M=d.useRef(),{maximizeContainer:W,minimizeContainer:ee,isMaximize:te}=go({container:M});d.useEffect(()=>{j!=null&&j.rendered},[j==null?void 0:j.rendered]);const F=()=>{console.log("selectTreeNode")},$=()=>{var T;l(!0),_("新建代码"),(T=p==null?void 0:p.current)==null||T.open({createProperty:"State",type:"string",comment:"",name:""})},L=()=>{l(!1),_("新建代码")},X=async T=>{var V,A,J;try{const{name:Q,type:re}=T,le=await((A=(V=D.page)==null?void 0:V.compiler)==null?void 0:A.getProperty(re,Q));l(!0),_("编辑代码"),(J=p==null?void 0:p.current)==null||J.open({createProperty:re||"State",type:(le==null?void 0:le.type)||"string",comment:le==null?void 0:le.comment,name:(le==null?void 0:le.name)||"",value:le==null?void 0:le.value})}catch(Q){console.log(Q)}};return a.jsx(a.Fragment,{children:a.jsxs("div",{ref:M,className:Y({[ye.is_fixed_position]:e.isFixed,[ye.component_filter_panel]:!0}),children:[a.jsx(Wh,{positionPanel:b,closePanel:S,maximizeContainer:W,minimizeContainer:ee,isMaximize:te}),a.jsxs("div",{className:ye.headerTools,children:[a.jsx(si,{className:ye.search,placeholder:"搜索代码",searchValue:t,onSearch:T=>{H(T)}}),a.jsx(De,{placement:"top",title:"新建代码片段",children:a.jsx(Hi,{onClick:$})})]}),a.jsx("div",{className:ye.tree_node_list,ref:P,style:{height:o},children:(E==null?void 0:E.length)>0?a.jsx(Dn,{className:ye.tree,defaultExpandAll:!0,selectedKeys:[],virtual:!0,fieldNames:{key:"path"},autoExpandParent:i,treeData:E,blockNode:!0,onSelect:F,titleRender:T=>a.jsx(a.Fragment,{children:a.jsx(qh,{editItem:X,...T})})},"path"):a.jsx(We,{})}),N,a.jsx(Xh,{open:c,title:v,onClose:L,onSuccess:()=>{U.success("操作成功")},ref:p})]})})}),Je=cn({level:"info",bizName:"base-editor:useEditor"}),Jh={pluginsConfig:{topArea:[],toolbarArea:[{instance:zd,key:"Toolbar",area:"toolbarArea",name:"工具栏",selected:!1,configs:{viewAuth:{canvasSizeControl:!0,deviceTypeButton:!0,savePageButton:!0,previewPageButton:!0,publishPageButton:!0,logRecordControl:!0}}}],leftArea:[{instance:Id,key:"LeftMenu",area:"leftArea",name:"左侧菜单导航",selected:!1,configs:{viewAuth:{schemaPreviewButton:!0},menus:[{icon:"icon-schema",tiptop:"schema",key:"SCHEMA",async:!0,instance:nu}],topMenus:[{icon:"icon-file2",tiptop:"view",key:"VIEW",instance:null}]}}],previewerArea:[{instance:gd,key:"CanvasPreviewer",area:"previewerArea",name:"画布",selected:!1,configs:{viewAuth:{schemaPreviewButton:!0}}}],configArea:[{instance:ql,key:"SetterComponentView",area:"configArea",name:"设置器",selected:!1,configs:{viewAuth:{}}}],resourceArea:[{instance:gh,key:"Resource",area:"resourceArea",name:"资源区",selected:!1,configs:{viewAuth:{schemaPreviewButton:!0},menus:[{icon:"icon-zujian",tiptop:"组件库",key:"COMPONENT",instance:Du},{icon:"icon-yilai",tiptop:"依赖包",key:"PACKAGE",instance:oh},{icon:"icon-tree",tiptop:"页面大纲",key:"TREE",instance:md},{icon:"icon-yuanma",tiptop:"源码",key:"CODE",instance:kf},{icon:"icon-liuchengbianpai",tiptop:"流程编排",key:"FLOW-DATA",instance:Sf},{icon:"icon-variable1",tiptop:"代码区",key:"PAGE-CODE",instance:Zh}]}}]},hooks:{beforeCreate:()=>(Je.log("beforeCreate"),Promise.resolve(!0)),created:e=>(Je.log("created",e),Promise.resolve(!0)),onError:e=>(Je.error("onError",e),Promise.resolve(!0)),createError:(e,t)=>(Je.error("createError",e,t),Promise.resolve(!0)),beforeDestroy:e=>(Je.log("beforeDestroy",e),Promise.resolve(!0)),destroyed:e=>(Je.log("destroyed",e),Promise.resolve(!0)),insertedComponent:e=>(Je.log("insertedComponent",e),Promise.resolve(!0)),insertedComponentError:e=>(Je.error("insertedComponentError",e),Promise.resolve(!0))}},sm=()=>a.jsx(ef,{config:Jh});export{sm as default};

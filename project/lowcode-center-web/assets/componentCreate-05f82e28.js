import{d as e,f as a,a as t,r as l,q as r,i as s,t as n,C as o,o as i,D as u,F as d,j as c,n as b,w as m,m as p,G as g,H as f}from"./index-455b6c01.js";const h=e({...e({name:"accountManageList"}),setup(e){a();let{proxy:h}=f();const y=t({info:{},show:!1});l(),l(),l();const w=t({info:{name:"",nick:"",password:"",rePassword:""},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:4,max:16,message:"用户名必须要在4到16位之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],rePassword:[{required:!0,message:"请输入确认密码",trigger:"blur"},{validator:(e,a,t)=>{a!==w.info.password&&t(new Error("重复密码错错误")),t()},trigger:"blur"}]},show:!1}),P=t({info:{nick:"",code:""},rules:{},show:!1}),q=t({info:{status:"",code:"",statusReason:""},statusList:[{value:0,label:"正常"},{value:1,label:"手动禁用"},{value:2,label:"自动风控"}],rules:{status:[{required:!0,message:"状态不能为空",trigger:"blur"}]},show:!1}),k=()=>{w.show=!0,g((()=>{w.info={name:"",nick:"",password:"",rePassword:""}}))},L=e=>{v.table.pageSize=e,S()},x=e=>{v.table.currentPage=e,S()},v=t({query:{name:"",roleId:"",emailL:"",nick:"",startAge:"",endAge:"",orgId:"",platform:"",code:""},table:{total:0,pageSize:10,currentPage:1,data:[],columns:[{prop:"avatarUrl",label:"头像",minWidth:120,render:(e,a)=>r(s("el-avatar"),{shape:"square",size:"100",fit:"fit",src:a.avatarUrl},null)},{prop:"name",label:"用户名",minWidth:120},{prop:"nick",label:"昵称",minWidth:120},{prop:"roleName",label:"角色",minWidth:120},{prop:"status",label:"状态",minWidth:120,render:(e,a)=>0===e?r(s("el-button"),{link:!0,type:"success"},{default:()=>[n("正常")]}):r(s("el-button"),{link:!0,type:"danger"},{default:()=>[n("异常")]})},{prop:"crateTimeLabel",label:"创建时间",minWidth:140}],operator:[{text:"编辑",fun:e=>{P.show=!0,P.info={nick:e.nick,id:e.id,code:e.code}}},{text:"状态",fun:e=>{q.show=!0,g((()=>{q.info={code:e.code,status:e.status,statusReason:e.statusReason}}))}},{text:"删除",disabled:!0,fun:e=>{}},{text:"会员权益",fun:e=>{h.$router.push({path:"/userManagement/userEquity",query:{id:e.id,code:e.code}})}},{text:"会员",fun:e=>{y.show=!0}}],operatorConfig:{fixed:"right",align:"center",width:"160",label:"操作"}},listTypeInfo:{platformList:[{dictLabel:"微信小程序",dictValue:"WX"},{dictLabel:"PC",dictValue:"PC"},{dictLabel:"APP",dictValue:"APP"}]}}),z=o((()=>({name:{label:"用户名",comp:"el-input"},nick:{label:"昵称",comp:"el-input"},platform:{label:"注册平台",comp:"el-select",changeEvent:"change",type:"select-arr",list:"platformList",listTypeInfo:v.listTypeInfo}}))),C=e=>{v.query={...v.query,...e},S("search")};i((()=>{S()}));const S=async e=>{"search"==e&&(v.table.currentPage=1);const a=await u({...v.query,page:v.table.currentPage,pageSize:v.table.pageSize,name:v.query.name});v.table.total=a.data&&a.data.count||0,v.table.data=a.data&&a.data.data?a.data.data:[],v.table.data.forEach((e=>{e.roleName=(null==e?void 0:e.role.name)||"--",e.statusLabel=0===e.status?"正常":"异常",e.crateTimeLabel=d(Number(e.crateTime)).format("YYYY-MM-DD HH:mm")}));const t=Math.ceil(v.table.total/v.table.pageSize);return t<v.table.currentPage&&0!==v.table.total?(v.table.currentPage=t,S()):0===v.table.total&&(v.table.currentPage=1),!1};return(e,a)=>{const t=s("t-query-condition"),l=s("t-layout-page-item"),o=s("el-button"),i=s("t-table"),u=s("t-layout-page");return c(),b(u,{class:"menu_mange"},{default:m((()=>[r(l,null,{default:m((()=>[r(t,{opts:p(z),onSubmit:C},null,8,["opts"])])),_:1}),r(l,null,{default:m((()=>[r(i,{title:"组件信息",table:p(v).table,columns:p(v).table.columns,onSizeChange:L,onPageChange:x},{toolbar:m((()=>[r(o,{type:"primary",onClick:k},{default:m((()=>a[0]||(a[0]=[n("新增")]))),_:1})])),_:1},8,["table","columns"])])),_:1})])),_:1})}}});export{h as default};

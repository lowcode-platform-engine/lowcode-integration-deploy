import{d as e,f as a,r as l,I as t,a as o,C as s,o as r,F as n,i as d,j as i,n as m,w as c,q as u,m as p,l as b,t as g,y as f,ax as h}from"./index-455b6c01.js";import{o as y,a as w}from"./constant-bd962a5b.js";import{u as S,f as _,h as x,i as q}from"./index-6d1bc2c2.js";const C={class:"dialog-footer"},M=e({...e({name:"CategoryList"}),setup(e){a(),l();const M=l();l(S),l({Authorization:`Bearer ${t()||""}`});const V=l({name:[{required:!0,message:"请输入名称",trigger:"blur"}],desc:[{required:!0,message:"请输入描述",trigger:"blur"}]}),P=o({isShowModal:!1,modal:{name:"",desc:""}}),z=()=>{P.isShowModal=!1,P.modal={name:"",desc:""}},T=async()=>{var e;if(await(null==(e=M.value)?void 0:e.validate())){(await x({name:P.modal.name,desc:P.modal.desc})).success?(f.success("操作成功"),P.isShowModal=!1,P.modal={name:"",desc:""},k("search")):f.error("操作失败")}},v=o({query:{name:""},roleIds:[],table:{total:0,pageSize:20,currentPage:1,data:[],columns:[{prop:"name",label:"name",minWidth:160},{prop:"code",label:"code",minWidth:120},{prop:"desc",label:"desc",minWidth:120},{prop:"crateTimeLabel",label:"创建时间",minWidth:140}],operator:[{text:"删除",fun:e=>{h.confirm("此操作将会删除该数据，是否继续?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((async()=>{await q([e.id]),f({type:"success",message:"Delete completed"}),k("search")})).catch((()=>{f({type:"info",message:"Delete canceled"}),k()}))}}],operatorConfig:{fixed:"right",align:"center",width:"120",label:"操作"}},listTypeInfo:{orderStatus:y,orderType:w}}),W=s((()=>({code:{label:"name",comp:"el-input"}}))),j=e=>{v.query={...v.query,...e},k("search")};r((()=>{k()}));const k=async e=>{"search"==e&&(v.table.currentPage=1);const a=await _({page:v.table.currentPage,pageSize:v.table.pageSize,name:v.query.name});v.table.total=a.data&&a.data.count||0,v.table.data=a.data&&a.data.data?a.data.data:[],v.table.data.forEach((e=>{e.crateTimeLabel=n(e.crateTime).format("YYYY-MM-DD HH:mm")}));const l=Math.ceil(v.table.total/v.table.pageSize);return l<v.table.currentPage&&0!==v.table.total?(v.table.currentPage=l,k()):0===v.table.total&&(v.table.currentPage=1),!1},D=e=>{v.table.pageSize=e,k()},I=e=>{v.table.currentPage=e,k()};return(e,a)=>{const l=d("t-query-condition"),t=d("t-layout-page-item"),o=d("el-button"),s=d("t-table"),r=d("el-input"),n=d("el-form-item"),f=d("el-form"),h=d("el-dialog"),y=d("t-layout-page");return i(),m(y,null,{default:c((()=>[u(t,null,{default:c((()=>[u(l,{opts:p(W),onSubmit:j},null,8,["opts"])])),_:1}),u(t,null,{default:c((()=>[u(s,{title:"业务类别",table:p(v).table,columns:p(v).table.columns,onSizeChange:D,onPageChange:I},{toolbar:c((()=>[b("div",null,[u(o,{type:"primary",onClick:a[0]||(a[0]=e=>p(P).isShowModal=!0)},{default:c((()=>a[4]||(a[4]=[g("新增")]))),_:1})])])),_:1},8,["table","columns"])])),_:1}),u(h,{"destroy-on-close":"",class:"custom-class-message-info-dialog",top:"100px",modelValue:p(P).isShowModal,"onUpdate:modelValue":a[3]||(a[3]=e=>p(P).isShowModal=e),title:"新增类别",width:"30%"},{footer:c((()=>[b("span",C,[u(o,{onClick:z},{default:c((()=>a[5]||(a[5]=[g("取消")]))),_:1}),u(o,{type:"primary",onClick:T},{default:c((()=>a[6]||(a[6]=[g(" 确认 ")]))),_:1})])])),default:c((()=>[u(f,{ref_key:"form",ref:M,inline:!0,rules:p(V),model:p(P).modal,class:"demo-form-inline"},{default:c((()=>[u(n,{"label-width":"120",required:"",label:"名称",prop:"name"},{default:c((()=>[u(r,{modelValue:p(P).modal.name,"onUpdate:modelValue":a[1]||(a[1]=e=>p(P).modal.name=e),max:"10"},null,8,["modelValue"])])),_:1}),u(n,{"label-width":"120",required:"",label:"描述",prop:"desc"},{default:c((()=>[u(r,{modelValue:p(P).modal.desc,"onUpdate:modelValue":a[2]||(a[2]=e=>p(P).modal.desc=e),max:"50"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue"])])),_:1})}}});export{M as default};
